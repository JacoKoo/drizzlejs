{"version":3,"file":"drizzle.js","sources":["../src/template/node.ts","../src/template/template.ts","../src/template/helper.ts","../src/template/if-block.ts","../src/template/each-block.ts","../src/loader.ts","../src/template/module-template.ts","../src/template/view-template.ts","../src/lifecycle.ts","../src/renderable.ts","../src/model.ts","../src/store.ts","../src/view.ts","../src/module.ts","../src/application.ts","../src/template/attributes.ts","../src/template/static-node.ts","../src/template/binding.ts","../src/template/dynamic-node.ts","../src/template/text-node.ts","../src/template/reference-node.ts","../src/template/region-node.ts","../src/drizzle.ts"],"sourcesContent":["import { Renderable, RenderOptions } from '../renderable'\nimport { Delay } from './template'\n\nexport abstract class Node {\n    root: Renderable<RenderOptions>\n    id: string\n    element: HTMLElement\n    parent: Node\n    children: Node[] = []\n    nextSibling: Node\n    rendered: boolean = false\n\n    constructor(id?: string) {\n        this.id = id\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        this.element = this.create()\n        if (this.id) root.ids[this.id] = this.element\n        this.children.forEach(it => it.init(root, delay))\n    }\n\n    render (context: object, delay: Delay) {\n    }\n\n    update (context: object, delay: Delay) {\n    }\n\n    destroy (delay: Delay) {\n        if (this.id) delete this.root.ids[this.id]\n        this.children.forEach(it => it.destroy(delay))\n    }\n\n    setChildren (children: Node[]) {\n        this.children = children\n        children.forEach((it, i) => {\n            it.nextSibling = children[i + 1]\n            it.parent = this\n        })\n    }\n\n    abstract create (): HTMLElement\n}\n\nexport class FakeNode extends Node {\n    constructor(el: HTMLElement) {\n        super()\n        this.element = el\n    }\n\n    init () {\n    }\n\n    create () {\n        return this.element\n    }\n}\n","import { Disposable } from '../drizzle'\nimport { Node, FakeNode } from './node'\nimport { Renderable } from '../renderable'\nimport { Lifecycle } from '../lifecycle'\n\ntype StaticValue = string | number | boolean\ntype DynamicValue = string\n\nexport enum ValueType { STATIC, DYNAMIC }\nexport enum ChangeType { CHANGED, NOT_CHANGED }\n\nexport type AttributeValue = [ValueType.STATIC, StaticValue] | [ValueType.DYNAMIC, DynamicValue]\nexport type Attribute = [string, AttributeValue]\n\nexport type HelperResult = [ChangeType, any]\n\nexport interface Updatable extends Disposable {\n    update (context: object): void\n}\n\nexport class Delay {\n    static also (fn: (Delay) => void) {\n        const d = new Delay()\n        fn(d)\n        return d.execute()\n    }\n\n    delays: Promise<any>[] = []\n\n    add (p: Promise<any>) {\n        this.delays.push(p)\n    }\n\n    execute () {\n        return Promise.all(this.delays)\n    }\n}\n\nexport function getValue (key: string, context: any): any {\n    const ks = key.split('.')\n    const first = ks.shift()\n    let ctx\n    if (context._computed && first in context._computed) {\n        ctx = context._computed[first](context)\n    } else {\n        ctx = context[first]\n    }\n\n    if (ks.length) {\n        ctx = ks.reduce((acc, item) => {\n            if (acc == null) return null\n            return acc[item]\n        }, ctx)\n    }\n\n    return ctx\n}\n\nexport function getAttributeValue(attr: AttributeValue, context: object): any {\n    if (attr[0] === ValueType.STATIC) return attr[1]\n    return getValue(attr[1] as string, context)\n}\n\nexport function resolveEventArgument (me: any, context: object, args: Attribute[], event: any): any[] {\n    const values = args.map(([name, v]) => {\n        if (v[0] === ValueType.STATIC) return v[1]\n        const it = v[1] as string\n        if (it === 'event') return event\n        if (it === 'this') return me\n        if (it.slice(0, 6) === 'event.') return event[it.slice(6)]\n        if (it.slice(0, 5) === 'this.') return me[it.slice(5)]\n        return getValue(it, context)\n    })\n\n    const obj = {}\n    const result = [obj]\n    let keys = 0\n\n    args.forEach(([name, v], i) => {\n        if (name) {\n            keys ++\n            obj[name] = values[i]\n            return\n        }\n        result.push(values[i])\n    })\n\n    if (keys === 0) result.shift()\n    return result\n}\n\nexport const customEvents = {\n    enter (node: HTMLElement, cb: (any) => void): Disposable {\n        const ee = function (this: HTMLElement, e) {\n            if (e.keyCode !== 13) return\n            e.preventDefault()\n            cb.call(this, e)\n        }\n        node.addEventListener('keypress', ee, false)\n        return {\n            dispose () {\n                node.removeEventListener('keypress', ee, false)\n            }\n        }\n    },\n\n    escape (node: HTMLElement, cb: (any) => void): Disposable {\n        const ee = function (this: HTMLElement, e) {\n            if (e.keyCode !== 27) return\n            cb.call(this, e)\n        }\n        node.addEventListener('keyup', ee, false)\n        return {\n            dispose () {\n                node.removeEventListener('keyup', ee, false)\n            }\n        }\n    }\n}\n\nexport abstract class Template<T extends Renderable<any>> {\n    life: Lifecycle\n    nodes: Node[]\n    root: T\n\n    init (root: T, delay: Delay) {\n        this.root = root\n        this.nodes.forEach(it => it.init(root, delay))\n    }\n\n    render (context: object, delay: Delay) {\n        const container = new FakeNode(this.root._element)\n        const next = this.root._nextSibling && new FakeNode(this.root._nextSibling)\n        this.nodes.forEach(it => {\n            it.parent = container\n            it.nextSibling = next\n            it.render(context, delay)\n        })\n    }\n\n    update (context: object, delay: Delay) {\n        this.nodes.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        this.nodes.forEach(it => {\n            it.destroy(delay)\n            it.nextSibling = null\n            it.parent = null\n        })\n    }\n}\n","import { HelperResult, ChangeType } from './template'\nimport { getValue, AttributeValue, ValueType } from './template'\nimport { View } from '../view'\n\nexport abstract class Helper {\n    name: string = ''\n    args: AttributeValue[]\n    dynamicKeys: string[]\n    currentKeys: string[]\n    currentValues: string[]\n\n    current: any\n\n    constructor (...args: AttributeValue[]) {\n        this.args = args\n        this.dynamicKeys = args.filter(it => it[0] === ValueType.DYNAMIC).map(it => it[1] as string)\n        this.check()\n    }\n\n    render (context: object): HelperResult {\n        if (!this.currentValues) return [ChangeType.CHANGED, this.renderIt(context)]\n\n        const vs = this.currentKeys.map(it => getValue(it, context))\n        if (vs.some((it, i) => it !== this.currentValues[i])) {\n            return [ChangeType.CHANGED, this.renderIt(context)]\n        }\n\n        return [ChangeType.NOT_CHANGED, this.current]\n    }\n\n    arg (idx: number, context: object): any {\n        const arg = this.args[idx]\n        if (!arg) return ''\n        if (arg[0] === ValueType.STATIC) return arg[1]\n        return this.key(arg[1] as string, context)\n    }\n\n    key (key: string, context: object): any {\n        this.currentKeys.push(key)\n        const v = getValue(key, context)\n        this.currentValues.push(v)\n        return v\n    }\n\n    check () {}\n\n    assertCount (...numbers: number[]) {\n        if (!numbers.some(it => it === this.args.length)) {\n            throw new Error(`${name} helper should have ${numbers.join(' or ')} arguments`)\n        }\n    }\n\n    assertDynamic (...numbers: number[]) {\n        numbers.forEach(it => {\n            if (this.args[it][0] !== ValueType.DYNAMIC) {\n                throw new Error(`the ${it}th argument of ${name} helper should be dynamic`)\n            }\n        })\n    }\n\n    abstract doRender (context: object): any\n\n    private renderIt (context: object): any {\n        this.currentKeys = []\n        this.currentValues = []\n        this.current = this.doRender(context)\n        return this.current\n    }\n}\n\nexport class Transfromer extends Helper {\n    fn: (...args: any[]) => any\n\n    constructor(fn: (...args: any[]) => any, ...args: AttributeValue[]) {\n        super(...args)\n        this.fn = fn\n    }\n\n    doRender (context: object): any {\n        return this.fn.apply(null, this.args.map((it, i) => this.arg(i, context)))\n    }\n}\n\nexport class DelayTransfomer extends Transfromer {\n    name: string\n\n    constructor(name: string, ...args: AttributeValue[]) {\n        super(null, ...args)\n        this.name = name\n    }\n\n    init (root: View) {\n        const {helpers} = root._options\n        if (helpers && helpers[this.name]) this.fn = helpers[this.name]\n        else throw new Error(`no helper found: ${name}`)\n    }\n}\n\nexport class EchoHelper extends Helper {\n    doRender (context) {\n        return this.arg(0, context)\n    }\n}\n\nexport class ConcatHelper extends Helper {\n    name = 'concat'\n\n    check () {\n        this.currentKeys = this.dynamicKeys\n    }\n\n    doRender (context: object): any {\n        return this.args.map((it, i) => this.arg(i, context)).join(' ')\n    }\n}\n\nexport class IfHelper extends Helper {\n    name = 'if'\n\n    check () {\n        this.assertCount(2, 3)\n        this.assertDynamic(0)\n    }\n\n    doRender (context: object): any {\n        return this.arg(this.use(context), context)\n    }\n\n    use (context: object): number {\n        return this.key(this.dynamicKeys[0], context) ? 1 : 2\n    }\n}\n\nexport class UnlessHelper extends IfHelper {\n    name = 'unless'\n\n    use (context: object): number {\n        return this.key(this.dynamicKeys[0], context) ? 2 : 1\n    }\n}\n\nexport class EqHelper extends Helper {\n    name: 'eq'\n\n    check () {\n        this.assertCount(3, 4)\n    }\n\n    doRender (context: object): any {\n        return this.arg(this.use(this.arg(0, context), this.arg(1, context)) ? 2 : 3, context)\n    }\n\n    use (v1: any, v2: any): boolean {\n        return v1 === v2\n    }\n}\n\nexport class NeHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 !== v2\n    }\n}\n\nexport class GtHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 > v2\n    }\n}\n\nexport class GteHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 >= v2\n    }\n}\n\nexport class LtHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 < v2\n    }\n}\n\nexport class LteHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 <= v2\n    }\n}\n","import { Node } from './node'\nimport { Renderable } from '../renderable'\nimport { Delay, AttributeValue, ValueType, getAttributeValue } from './template'\n\nexport class IfBlock extends Node {\n    args: AttributeValue[]\n    trueNode: Node\n    falseNode?: Node\n    current: Node\n\n    constructor (args: AttributeValue[], trueNode: Node, falseNode?: Node) {\n        super()\n        this.trueNode = trueNode\n        this.falseNode = falseNode\n        this.args = args\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        this.trueNode.init(root, delay)\n        if (this.falseNode) {\n            this.falseNode.init(root, delay)\n        }\n    }\n\n    use (context: object): boolean {\n        if (this.args[0][0] === ValueType.STATIC) {\n            // TODO throw\n            return false\n        }\n        return !!getAttributeValue(this.args[0], context)\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        this.rendered = true\n\n        this.trueNode.parent = this.parent\n        this.trueNode.nextSibling = this.nextSibling\n        if (this.falseNode) {\n            this.falseNode.parent = this.parent\n            this.falseNode.nextSibling = this.nextSibling\n        }\n\n        this.current = this.use(context) ? this.trueNode : this.falseNode\n\n        if (this.current) {\n            this.current.render(context, delay)\n        }\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n\n        const use = this.use(context) ? this.trueNode : this.falseNode\n        if (use === this.current) {\n            if (use) use.update(context, delay)\n            return\n        }\n\n        if (this.current) this.current.destroy(delay)\n        this.current = use === this.trueNode ? this.trueNode : this.falseNode\n        if (this.current) this.current.render(context, delay)\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        if (this.current) this.current.destroy(delay)\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n\nexport class UnlessBlock extends IfBlock {\n    use (context: any): boolean {\n        return !getAttributeValue(this.args[0], context)\n    }\n}\n\nexport class EqBlock extends IfBlock {\n    use (context: object): boolean {\n        return this.use2(getAttributeValue(this.args[0], context), getAttributeValue(this.args[1], context))\n    }\n\n    use2 (v1: any, v2: any): boolean {\n        return v1 === v2\n    }\n}\n\nexport class NeBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 !== v2\n    }\n}\n\nexport class GtBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 > v2\n    }\n}\n\nexport class GteBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 >= v2\n    }\n}\n\nexport class LtBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 < v2\n    }\n}\n\nexport class LteBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 <= v2\n    }\n}\n","import { Node } from './node'\nimport { Renderable } from '../renderable'\nimport { getValue, Delay } from './template'\n\nexport class EachBlock extends Node {\n    args: string[]\n    trueNode: () => Node\n    falseNode?: Node\n    currentSize = 0\n    nodes: Node[] = []\n\n    constructor (args: string[], trueNode: () => Node, falseNode?: Node) {\n        super()\n        this.args = args\n        this.trueNode = trueNode\n        this.falseNode = falseNode\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        if (this.falseNode) this.falseNode.nextSibling = this.nextSibling\n    }\n\n    isEmpty (list: any): boolean {\n        return !list || (Array.isArray(list) && !list.length) || (typeof list === 'object' && !Object.keys(list))\n    }\n\n    sub (context: {[key: string]: any}, i: number | string) {\n        const o = Object.assign({}, context)\n        if (!o._each) o._each = []\n        o._each.push({list: context[this.args[0]], index: i, key: this.args[2]})\n\n        o[this.args[2]] = context[this.args[0]][i]\n        if (this.args[3]) o[this.args[3]] = i\n        return o\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n\n        this.rendered = true\n        const list = getValue(this.args[0], context)\n        if (this.isEmpty(list)) {\n            this.renderElse(context, delay)\n            return\n        }\n\n        const kv = Array.isArray(list) ?\n            list.map((it, i) => [i, it]) as [any, any] :\n            Object.keys(list).map(it => [it, list[it]] as [any, any])\n\n        this.renderKeyValue(kv, context, delay)\n    }\n\n    renderKeyValue (arr: [any, any][], context: object, delay: Delay) {\n        this.currentSize = arr.length\n        arr.forEach((it, i) => {\n            const sub = this.sub(context, i)\n            this.nodes[i] = this.trueNode()\n            this.nodes[i].parent = this.parent\n            this.nodes[i].nextSibling = this.nextSibling\n            this.nodes[i].init(this.root, delay)\n            this.nodes[i].render(sub, delay)\n        })\n    }\n\n    renderElse (context: object, delay: Delay) {\n        if (!this.falseNode) return\n        this.falseNode.init(this.root, delay)\n        this.falseNode.render(context, delay)\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n\n        const list = getValue(this.args[0], context)\n        const empty = this.isEmpty(list)\n        if (empty && !this.currentSize) {\n            this.updateElse(context, delay)\n            return\n        }\n\n        if (empty) {\n            this.currentSize = 0\n            this.nodes.forEach(it => it.destroy(delay))\n            this.nodes = []\n\n            this.renderElse(context, delay)\n            return\n        }\n\n        const kv = Array.isArray(list) ?\n            list.map((it, i) => [i, it] as [any, any]) :\n            Object.keys(list).map(it => [it, list[it]] as [any, any])\n\n        this.updateKeyValue(kv, context, delay)\n    }\n\n    updateElse (context: object, delay: Delay) {\n        if (this.falseNode) this.falseNode.update(context, delay)\n    }\n\n    updateKeyValue (arr: [any, any][], context: object, delay: Delay) {\n        this.currentSize = arr.length\n        arr.forEach((it, i) => {\n            const sub = this.sub(context, i)\n\n            if (this.nodes[i]) this.nodes[i].update(sub, delay)\n            else {\n                this.nodes[i] = this.trueNode()\n                this.nodes[i].parent = this.parent\n                this.nodes[i].nextSibling = this.nextSibling\n                this.nodes[i].init(this.root, delay)\n                this.nodes[i].render(sub, delay)\n            }\n        })\n\n        while (this.nodes.length !== this.currentSize) {\n            const node = this.nodes.pop()\n            node.destroy(delay)\n        }\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n\n        if (!this.currentSize) {\n            if (this.falseNode) this.falseNode.destroy(delay)\n            return\n        }\n\n        this.currentSize = 0\n        this.nodes.forEach(it => it.destroy(delay))\n        this.nodes = []\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Application } from './application'\n\nexport class Loader {\n    protected _app: Application\n    protected _path: string\n    protected _args: string[]\n\n    constructor(app: Application, path: string, args: string[]) {\n        this._app = app\n        this._path = path\n        this._args = args\n    }\n\n    load (file): Promise<object> {\n        return this._app.options.getResource(`${this._app.options.scriptRoot}/${this._path}/${file}`)\n    }\n}\n","import {ItemOptions, Module} from '../module'\nimport { Delay, Template } from './template'\n\nexport class ModuleTemplate extends Template<Module> {\n    options: {\n        exportedModels: string[]\n        items: ItemOptions\n    }\n\n    constructor(exportedModels: string[]) {\n        super()\n        this.options = {exportedModels, items: {}}\n        const me = this\n        this.life = {\n            stage: 'template',\n            init (this: Module) { Delay.also(d => me.init(this, d)) },\n            beforeRender (this: Module) { Delay.also(d => me.render(this.get(), d)) },\n            updated (this: Module) { Delay.also(d => me.update(this.get(), d)) },\n            beforeDestroy () { Delay.also(d => me.destroy(d)) }\n        }\n    }\n\n    views (...views: string[]) {\n        views.forEach(it => this.options.items[it] = {view: it})\n    }\n\n    modules (name: string, path: string, loader?: string, args?: string[]) {\n        this.options.items[name] = loader ? {path, loader: {name: loader, args}} : {path}\n    }\n}\n","import { Lifecycle } from '../lifecycle'\nimport { Delay, Template } from './template'\nimport { View } from '../view'\n\nexport class ViewTemplate extends Template<View> {\n    constructor () {\n        super()\n        const me = this\n        this.life = {\n            stage: 'template',\n            init (this: View) { Delay.also(d => me.init(this, d)) },\n            beforeRender (this: View) { Delay.also(d => me.render(me.getContext(this), d)) },\n            updated (this: View) { Delay.also(d => me.update(me.getContext(this), d)) },\n            beforeDestroy () { Delay.also(d => me.destroy(d)) }\n        }\n    }\n\n    getContext (view: View): any {\n        const c: any = view._state\n        if (view._options.computed) {\n            c._computed = view._options.computed\n        }\n        return c\n    }\n}\n","import {Application} from './application'\n\nexport interface Lifecycle {\n    stage?: string\n    init? (): any\n\n    beforeRender? (): any\n    rendered? (): any\n\n    beforeUpdate? (): any\n    updated? (): any\n\n    beforeDestroy? (): any\n    destroyed? (): any\n}\n\nconst callIt = (ctx: LifecycleContainer, cycles: Lifecycle[], method: string, reverse = false): Promise<any> => {\n    return cycles.filter(it => it[method])[reverse ? 'reduceRight' : 'reduce']((acc, it) => {\n        return acc.then(() => it[method].apply(ctx))\n    }, Promise.resolve())\n}\n\nexport class LifecycleContainer {\n    app: Application\n    private _cycles: Lifecycle[] = []\n\n    constructor (app: Application, options: {cycles?: Lifecycle[]} & Lifecycle, ...args: Lifecycle[]) {\n        this.app = app\n\n        const cs = options.cycles || []\n        cs.push(options)\n        args.forEach(it => it && cs.push(it))\n        cs.forEach(it => !it.stage && (it.stage = 'default'))\n\n        app.options.stages.forEach(s => cs.forEach(c => {\n            if (c.stage === s) this._cycles.push(c)\n        }))\n    }\n\n    protected _doInit () {\n        return callIt(this, this._cycles, 'init')\n    }\n\n    protected _doBeforeRender () {\n        return callIt(this, this._cycles, 'beforeRender')\n    }\n\n    protected _doRendered () {\n        return callIt(this, this._cycles, 'rendered')\n    }\n\n    protected _doBeforeUpdate () {\n        return callIt(this, this._cycles, 'beforeUpdate')\n    }\n\n    protected _doUpdated () {\n        return callIt(this, this._cycles, 'updated')\n    }\n\n    protected _doBeforeDestroy () {\n        return callIt(this, this._cycles, 'beforeDestroy', true)\n    }\n\n    protected _doDestroyed () {\n        return callIt(this, this._cycles, 'destroyed', true)\n    }\n}\n","import { Lifecycle, LifecycleContainer } from './lifecycle'\nimport { Application } from './application'\nimport { Disposable } from './drizzle'\nimport { Node } from './template/node'\nimport { ModuleTemplate } from './template/module-template'\n\nexport interface RenderOptions extends Lifecycle {\n    cycles?: Lifecycle[]\n    customEvents?: {[name: string]: (HTMLElement, callback: (any) => void) => Disposable}\n    events?: {[name: string]: (...args) => void}\n    template?: ModuleTemplate\n}\n\nexport enum ComponentState {\n    CREATED, INITED, RENDERED\n}\n\ninterface Region {\n    show (item: Renderable<any>): Promise<any>\n    _showNode (nodes: Node[], context: object): Promise<any>\n    close (): Promise<any>\n}\n\nexport class Renderable<T extends RenderOptions> extends LifecycleContainer {\n    _element: HTMLElement\n    _nextSibling: HTMLElement\n    _options: T\n    ids: {[key: string]: HTMLElement | Renderable<T>} = {}\n    regions: {[key: string]: Region}\n\n    protected _busy: Promise<any> = Promise.resolve()\n    protected _status = ComponentState.CREATED\n\n    constructor(app: Application, options: T, ...args: Lifecycle[]) {\n        super(app, options, ...args)\n        this._options = options\n    }\n\n    _render (el: HTMLElement, nextSibling?: HTMLElement) {\n        if (this._status !== ComponentState.INITED) return Promise.resolve()\n        this._status = ComponentState.RENDERED\n\n        this._element = el\n        this._nextSibling = nextSibling\n        this._busy = this._busy\n            .then(() => this._doBeforeRender())\n            .then(() => this._doRendered())\n\n        return this._busy\n    }\n\n    destroy () {\n        if (this._status !== ComponentState.RENDERED) return Promise.resolve()\n\n        this._busy = this._busy\n            .then(() => this._doBeforeDestroy())\n            .then(() => this._doDestroyed())\n            .then(() => this._status = ComponentState.INITED)\n\n        return this._busy\n    }\n\n    _init () {\n        return this._busy = this._busy\n            .then(() => this._doInit())\n            .then(() => this._status = ComponentState.INITED)\n    }\n\n    _event (name, ...args: any[]) {\n        const {events} = this._options\n        if (events && events[name]) events[name].apply(this, args)\n    }\n\n}\n","export interface ModelOptions {\n    url?: string\n    root?: string\n    data: () => any\n    parser?: (data: any) => any\n}\n\nexport class Model {\n    private _options: ModelOptions\n    private _data: any\n\n    constructor(options: ModelOptions) {\n        this._options = options\n        this.set(options.data())\n    }\n\n    set (data: any) {\n        let d = data\n        const {parser, root} = this._options\n        if (parser) d = parser(d)\n        if (root && d) d = d[root]\n\n        this._data = d\n    }\n\n    get () {\n        // clone it or make it readonly in dev mode\n        return this._data\n    }\n}\n","import { ModelOptions, Model } from './model'\n\nexport interface StoreOptions {\n    models?: {[key: string]: ModelOptions}\n    actions?: {[key: string]: (payload: any) => void}\n}\n\nexport class Store {\n    private _options: StoreOptions\n    private _models: {[key: string]: Model} = {}\n    private _names: string[] = []\n\n    constructor(options: StoreOptions, updateKey: string) {\n        this._options = options\n        const {models} = options\n        if (models) {\n            this._names = Object.keys(models)\n            this._names.forEach(k => this._models[k] = new Model(models[k]))\n        }\n\n        if (!options.actions) options.actions = {}\n        options.actions[updateKey] = data => {\n            this.set(data)\n        }\n    }\n\n    get models () {\n        return this._models\n    }\n\n    get (name?: string) {\n        if (name) return this._models[name].get()\n\n        return this._names.reduce((acc: {[key: string]: any}, item) => {\n            acc[item] = this._models[item].get()\n            return acc\n        }, {})\n    }\n\n    set (data: object) {\n        this._names.forEach(k => data[k] && this._models[k].set(data[k]))\n    }\n\n    dispatch (name: string, payload: any): Promise<void> {\n        const {actions} = this._options\n        if (!actions || !actions[name]) return Promise.reject()\n        return Promise.resolve(actions[name].call(this, payload))\n    }\n}\n","import { RenderOptions, Renderable } from './renderable'\nimport { Module } from './module'\nimport { DynamicNode } from './template/dynamic-node'\n\nexport interface ViewOptions extends RenderOptions {\n    actions?: {[name: string]: (cb: (data: any) => Promise<any>, data: object) => void}\n    helpers?: {[name: string]: (...any) => any},\n    computed?: {[name: string]: (any) => any}\n}\n\nexport interface BindingGroup {\n    type: 'checkbox' | 'radio'\n    busy: boolean\n    items: DynamicNode[]\n}\n\nexport class View extends Renderable<ViewOptions> {\n    _module: Module\n    _groups: {[name: string]: BindingGroup} = {}\n    _state: object = {}\n\n    constructor(mod: Module, options: ViewOptions) {\n        super(mod.app, options, options.template && options.template.life)\n        this._module = mod\n    }\n\n    set (data: object, silent: boolean = false) {\n        if (silent) {\n            Object.assign(this._state, data)\n            return Promise.resolve()\n        }\n\n        this._busy = this._busy\n            .then(() => this._doBeforeUpdate())\n            .then(() => Object.assign(this._state, data))\n            .then(() => this._doUpdated())\n\n        return this._busy\n    }\n\n    _action (name: string, ...data: any[]) {\n        const {actions} = this._options\n        if (actions && actions[name]) {\n            actions[name].call(this, (d: any) => {\n                return this._module.dispatch(name, d)\n            }, ...data)\n            return\n        }\n\n        this._module.dispatch(name, data[0])\n    }\n}\n","import { RenderOptions, Renderable, ComponentState } from './renderable'\nimport { StoreOptions, Store } from './store'\nimport { Application } from './application'\nimport { Loader } from './loader'\nimport { View, ViewOptions } from './view'\nimport { Disposable} from './drizzle'\n\nexport interface ItemOptions {\n    view?: string\n    module?: {\n        path: string,\n        loader?: {name: string, args?: string[]}\n    }\n}\n\ninterface ModuleOptions extends RenderOptions {\n    store?: StoreOptions\n    exportedModels?: string[]\n    state?: object,\n}\n\nconst UPDATE_ACTION = `update${+new Date()}`\n\nconst clone = (target: any) => {\n    if (Array.isArray(target)) {\n        return target.map(it => clone(it))\n    }\n    if (typeof target === 'object') {\n        return Object.keys(target).reduce((acc: any, it) => {\n            acc[it] = clone(target[it])\n            return acc\n        }, {})\n    }\n    return target\n}\n\nexport class Module extends Renderable<ModuleOptions> {\n    items: {[key: string]: {\n        type: 'view' | 'module'\n        options: ModuleOptions | ViewOptions\n        loader: Loader\n    }} = {}\n\n    private _store: Store\n    private _handlers: {[name: string]: ((data: any) => void)[]} = {}\n    private _loader: Loader\n\n    constructor(app: Application, loader: Loader, options: ModuleOptions) {\n        super(app, options, options.template && options.template.life)\n        this._loader = loader\n    }\n\n    set (data: object) {\n        const {exportedModels} = this._options\n        if (!exportedModels || !exportedModels.length) return\n\n        const d = exportedModels.reduce((acc, item) => {\n            if (data[item]) acc[item] = data[item]\n            return acc\n        }, {})\n\n        return (this._status === ComponentState.CREATED ? this._store : this).dispatch(UPDATE_ACTION, d)\n    }\n\n    get (name?: string) {\n        const obj = this._store.get(name)\n\n        // TODO only works in dev mode\n        return clone(obj)\n    }\n\n    dispatch (name: string, payload?: any) {\n        this._busy = this._busy\n            .then(() => this._doBeforeUpdate())\n            .then(() => this._store.dispatch(name, payload))\n            .then(() => this._doUpdated())\n\n        return this._busy\n    }\n\n    on (name: string, handler: (data: any) => void): Disposable {\n        if (!this._handlers[name]) this._handlers[name] = []\n        const hs = this._handlers[name]\n\n        if (hs.indexOf(handler) !== -1) return {dispose: () => {}}\n        hs.push(handler)\n\n        return {\n            dispose: () => {\n                const idx = hs.indexOf(handler)\n                if (idx !== -1) hs.splice(idx, 1)\n            }\n        }\n    }\n\n    fire (name: string, data: any) {\n        if (!this._handlers[name]) return\n        const hs = this._handlers[name].slice()\n        hs.forEach(it => it.call(this, data))\n    }\n\n    createItem (name: string) {\n        const opt = this.items[name]\n        const item = opt.type === 'view' ? new View(this, opt.options) : new Module(this.app, opt.loader, opt.options)\n        return item._init().then(() => item)\n    }\n\n    _render (el: HTMLElement, nextSibling?: HTMLElement) {\n        const busy = super._render(el, nextSibling)\n\n        if (busy === this._busy) {\n            this._busy = this._busy.then(() => {\n                const {store} = this._options\n                if (store && store.actions && store.actions.init) {\n                    return this.dispatch('init')\n                }\n            })\n            return this._busy\n        }\n\n        return busy\n    }\n\n    _init () {\n        this._store = new Store(this._options.store || {}, UPDATE_ACTION)\n        this.set(this._options.state || {})\n        return this._loadItems().then(() => super._init())\n    }\n\n    private _loadItems (): Promise<any> {\n        const {template} = this._options\n        if (!template || !template.options) return Promise.resolve()\n        const {items} = template.options\n        if (!items) return Promise.resolve()\n\n        const ks = Object.keys(items)\n        const loaders = ks.map(k => {\n            return items[k].view ? this._loader : this.app.createLoader(items[k].module.path, items[k].module.loader)\n        })\n        return Promise.all(ks.map((k, i) => loaders[i].load(items[k].view ? items[k].view : 'index')))\n            .then(data => Promise.all(ks.map((k, i) => {\n                this.items[k] = {\n                    type: items[k].view ? 'view' : 'module',\n                    options: data[i],\n                    loader: loaders[i]\n                }\n            })))\n    }\n}\n","import { Loader } from './loader'\nimport { Disposable } from './drizzle'\nimport { Module } from './module'\n\ninterface ApplicationOptions {\n    stages?: string[],\n    scriptRoot?: string\n    container: HTMLElement,\n    entry: string | {path: string, loader?: {name: string, args?: string[]}},\n    customEvents?: {[name: string]: (HTMLElement, callback: (any) => void) => Disposable}\n    getResource? (path): Promise<object>\n}\n\nexport class Application {\n    options: ApplicationOptions\n\n    constructor(options: ApplicationOptions) {\n        this.options = Object.assign({\n            stages: ['init', 'template', 'default'],\n            scriptRoot: 'app',\n            entry: 'viewport'\n        }, options)\n    }\n\n    createLoader (path: string, loader?: {name: string, args?: string[]}): Loader {\n        return new Loader(this, path, [])\n    }\n\n    start (): Promise<any> {\n        let loader: Loader\n        const {entry, container} = this.options\n        if (typeof entry === 'string') {\n            loader = this.createLoader(entry)\n        } else {\n            loader = this.createLoader(entry.path, entry.loader)\n        }\n\n        return loader.load('index').then(opt => {\n            const v = new Module(this, loader, opt)\n            return v._init().then(() => v._render(container))\n        })\n    }\n}\n","const ps: [string, number | string, string[] | number][] = [\n    ['accept', 0, ['form', 'input']],\n    ['accept-charset', 'acceptCharset', ['form']],\n    ['accesskey', 'accessKey', 0],\n    ['action', 0, ['form']],\n    ['align', 0, [\n        'applet', 'caption', 'col', 'colgroup', 'hr', 'iframe',\n        'img', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr']\n    ],\n    ['allowfullscreen', 'allowFullscreen', ['iframe']],\n    ['alt', 0, ['applet', 'area', 'img', 'input']],\n    ['async', 0, ['script']],\n    ['autocomplete', 0, ['form', 'input']],\n    ['autofocus', 0, ['button', 'input', 'keygen', 'select', 'textarea']],\n    ['autoplay', 0, ['audio', 'video']],\n    ['autosave', 0, ['input']],\n    ['bgcolor', 'bgColor', ['body', 'col', 'colgroup', 'marquee', 'table', 'tbody', 'tfoot', 'td', 'th', 'tr']],\n    ['border', 0, ['img', 'object', 'table']],\n    ['buffered', 0, ['audio', 'video']],\n    ['challenge', 0, ['keygen']],\n    ['charset', 0, ['meta', 'script']],\n    ['checked', 0, ['command', 'input']],\n    ['cite', 0, ['blockquote', 'del', 'ins', 'q']],\n    ['class', 'className', 0],\n    ['code', 0, ['applet']],\n    ['codebase', 'codeBase', ['applet']],\n    ['color', 0, ['basefont', 'font', 'hr']],\n    ['cols', 0, ['textarea']],\n    ['colspan', 'colSpan', ['td', 'th']],\n    ['content', 0, ['meta']],\n    ['contenteditable', 'contentEditable', 0],\n    ['contextmenu', 0, 0],\n    ['controls', 0, ['audio', 'video']],\n    ['coords', 0, ['area']],\n    ['data', 0, ['object']],\n    ['datetime', 'dateTime', ['del', 'ins', 'time']],\n    ['default', 0, ['track']],\n    ['defer', 0, ['script']],\n    ['dir', 0, 0],\n    ['dirname', 'dirName', ['input', 'textarea']],\n    ['disabled', 0, ['button', 'command', 'fieldset', 'input', 'keygen', 'optgroup', 'option', 'select', 'textarea']],\n    ['download', 0, ['a', 'area']],\n    ['draggable', 0, 0],\n    ['dropzone', 0, 0],\n    ['enctype', 0, ['form']],\n    ['for', 'htmlFor', ['label', 'output']],\n    ['form', 0, [\n        'button', 'fieldset', 'input', 'keygen', 'label',\n        'meter', 'object', 'output', 'progress', 'select', 'textarea']\n    ],\n    ['formaction', 0, ['input', 'button']],\n    ['headers', 0, ['td', 'th']],\n    ['height', 0, ['canvas', 'embed', 'iframe', 'img', 'input', 'object', 'video']],\n    ['hidden', 0, 0],\n    ['high', 0, ['meter']],\n    ['href', 0, ['a', 'area', 'base', 'link']],\n    ['hreflang', 0, ['a', 'area', 'link']],\n    ['http-equiv', 'httpEquiv', ['meta']],\n    ['icon', 0, ['command']],\n    ['id', 0, 0],\n    ['indeterminate', 0, ['input']],\n    ['ismap', 'isMap', ['img']],\n    ['itemprop', 0, 0],\n    ['keytype', 0, ['keygen']],\n    ['kind', 0, ['track']],\n    ['label', 0, ['track']],\n    ['lang', 0, 0],\n    ['language', 0, ['script']],\n    ['loop', 0, ['audio', 'bgsound', 'marquee', 'video']],\n    ['low', 0, ['meter']],\n    ['manifest', 0, ['html']],\n    ['max', 0, ['input', 'meter', 'progress']],\n    ['maxlength', 'maxLength', ['input', 'textarea']],\n    ['media', 0, ['a', 'area', 'link', 'source', 'style']],\n    ['method', 0, ['form']],\n    ['min', 0, ['input', 'meter']],\n    ['multiple', 0, ['input', 'select']],\n    ['muted', 0, ['audio', 'video']],\n    ['name', 0, [\n        'button', 'form', 'fieldset', 'iframe', 'input', 'keygen',\n        'object', 'output', 'select', 'textarea', 'map', 'meta', 'param']\n    ],\n    ['novalidate', 'noValidate', ['form']],\n    ['open', 0, ['details']],\n    ['optimum', 0, ['meter']],\n    ['pattern', 0, ['input']],\n    ['ping', 0, ['a', 'area']],\n    ['placeholder', 0, ['input', 'textarea']],\n    ['poster', 0, ['video']],\n    ['preload', 0, ['audio', 'video']],\n    ['radiogroup', 0, ['command']],\n    ['readonly', 'readOnly', ['input', 'textarea']],\n    ['rel', 0, ['a', 'area', 'link']],\n    ['required', 0, ['input', 'select', 'textarea']],\n    ['reversed', 0, ['ol']],\n    ['rows', 0, ['textarea']],\n    ['rowspan', 'rowSpan', ['td', 'th']],\n    ['sandbox', 0, ['iframe']],\n    ['scope', 0, ['th']],\n    ['scoped', 0, ['style']],\n    ['seamless', 0, ['iframe']],\n    ['selected', 0, ['option']],\n    ['shape', 0, ['a', 'area']],\n    ['size', 0, ['input', 'select']],\n    ['sizes', 0, ['link', 'img', 'source']],\n    ['span', 0, ['col', 'colgroup']],\n    ['spellcheck', 0, 0],\n    ['src', 0, ['audio', 'embed', 'iframe', 'img', 'input', 'script', 'source', 'track', 'video']],\n    ['srcdoc', 0, ['iframe']],\n    ['srclang', 0, ['track']],\n    ['srcset', 0, ['img']],\n    ['start', 0, ['ol']],\n    ['step', 0, ['input']],\n    ['summary', 0, ['table']],\n    ['tabindex', 'tabIndex', 0],\n    ['target', 0, ['a', 'area', 'base', 'form']],\n    ['title', 0, 0],\n    ['type', 0, ['button', 'command', 'embed', 'object', 'script', 'source', 'style', 'menu']],\n    ['usemap', 'useMap', ['img', 'input', 'object']],\n    ['value', 0, ['button', 'option', 'input', 'li', 'meter', 'progress', 'param', 'select', 'textarea']],\n    ['volume', 0, ['audio', 'video']],\n    ['width', 0, ['canvas', 'embed', 'iframe', 'img', 'input', 'object', 'video']],\n    ['wrap', 0, ['textarea']]\n]\n\ninterface Attr {\n    [key: string]: {name: any, tags: {[key: string]: boolean}}\n}\n\nconst attributes: Attr = ps.reduce((acc: Attr, item) => {\n    acc[item[0]] = {\n        name: item[1],\n        tags: item[2] && (item[2] as string[]).reduce((ac, i) => {\n            ac[i] = true\n            return ac\n        }, {})\n    }\n    return acc\n}, {})\n\n// TODO set style, data set\nexport function setAttribute(el: HTMLElement, name: string, value: any) {\n    const n = name.toLowerCase()\n    const t = el.tagName.toLowerCase()\n    if (attributes[n] && attributes[name].tags[t]) {\n        el[attributes[n].name || n] = value\n    } else {\n        el.setAttribute(name, value)\n    }\n}\n","import { Node } from './node'\nimport { Delay } from './template'\nimport { setAttribute } from './attributes'\n\nexport class StaticNode extends Node {\n    name: string\n    attributes: [string, string][]\n\n    constructor(name: string, attributes: [string, string][] = [], id?: string) {\n        super(id)\n        this.name = name\n        this.attributes = attributes\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        this.rendered = true\n        /* FIXME\n        if (this.nextSibling && this.nextSibling.element) {\n            this.parent.element.insertBefore(this.element, this.nextSibling.element)\n        } else {\n            this.parent.element.appendChild(this.element)\n        }*/\n        this.parent.element.appendChild(this.element)\n        this.children.forEach(it => it.render(context, delay))\n    }\n\n    update (context: object, delay: Delay) {\n        this.children.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        super.destroy(delay)\n\n        this.parent.element.removeChild(this.element)\n        this.rendered = false\n    }\n\n    create () {\n        const element = document.createElement(this.name)\n        this.attributes.forEach(it =>  setAttribute(element, it[0], it[1]))\n        return element\n    }\n}\n","import { View, BindingGroup } from '../view'\nimport { getValue, Updatable } from './template'\nimport { DynamicNode } from './dynamic-node'\n\nconst distruct = (obj: object, key: string) => {\n    const ks = key.split('.')\n    const name = ks.pop()\n\n    const target = ks.reduce((acc, it) => acc[it], obj)\n    return {name, target}\n}\n\nconst bindIt = <T extends HTMLElement>(\n    context: {[name: string]: any}, view: View, to: string, element: T,\n    event: string, get: (T) => any, set: (T, any) => void\n): Updatable => {\n    let current\n    const obj = {context}\n    const cb = function(this: T) {\n        const {name, target} = distruct(obj.context, to)\n        current = get(element)\n\n        // bind each key\n        if (name === to && context._each && context._each.some(it => it.key === name)) {\n            const each = context._each.find(it => it.key === name)\n            each.list[each.index] = current\n        } else {\n            target[name] = current\n        }\n        view.set({})\n    }\n\n    element.addEventListener(event, cb, false)\n\n    const r = {\n        dispose () {\n            element.removeEventListener(event, cb, false)\n        },\n        update (ctx: object) {\n            obj.context = ctx\n            const v = getValue(to, ctx)\n            if (v !== current) {\n                set(element, v)\n                current = v\n            }\n        }\n    }\n\n    r.update(context)\n    return r\n}\n\nconst getSelectValue = (el: HTMLSelectElement) => {\n    const opt = el.options[el.selectedIndex || 0]\n    return opt && opt.value\n}\n\nconst setSelectOption = (el: HTMLSelectElement, value) => {\n    // tslint:disable-next-line:prefer-for-of\n    for (let i = 0; i < el.options.length; i ++) {\n        const opt = el.options[i]\n        if (opt.value === (value + '')) {\n            opt.selected = true\n            return\n        }\n    }\n}\n\nconst bindGroup = (\n    context: {[name: string]: any}, view: View, group: BindingGroup, to: string,\n    element: HTMLInputElement\n): Updatable => {\n    const obj = {context}\n    let current\n    const cb = function(this: HTMLInputElement) {\n        if (group.busy) return\n        const {name, target} = distruct(obj.context, to)\n        current = (group.type === 'radio' ? element.value : group.items\n            .filter(it => (it.element as HTMLInputElement).checked)\n            .map(it => (it.element as HTMLInputElement).value))\n\n        if (name === to && context._each && context._each.some(it => it.key === name)) {\n            const each = context._each.find(it => it.key === name)\n            each.list[each.index] = current\n        } else {\n            target[name] = current\n        }\n        group.busy = true\n        view.set({})\n        group.busy = false\n    }\n\n    element.addEventListener('change', cb, false)\n\n    const r = {\n        dispose () {\n            element.removeEventListener('change', cb, false)\n        },\n        update (ctx: object) {\n            obj.context = ctx\n            if (group.busy) return\n            const v = getValue(to, ctx)\n            const its = group.items.map(it => (it.element as HTMLInputElement))\n\n            let changed = false\n            if (group.type === 'radio' && v !== current) changed = true\n            if (!changed && group.type === 'checkbox' && (v as any[]).some((it, i) => current[i] !== it)) changed = true\n            if (!changed) return\n\n            if (group.type === 'radio') {\n                its.forEach(it => it.checked = it.value === v + '')\n                return\n            }\n\n            its.forEach(it => it.checked = (v as any[]).some(vv => vv + '' === it.value))\n        }\n    }\n\n    r.update(context)\n    return r\n}\n\nexport const bind = (node: DynamicNode, context: object, from: string, to: string): Updatable => {\n    const tag = node.name.toLowerCase()\n    const element = node.element\n    const view = node.root as View\n    if ((tag === 'input' || tag === 'textarea') && from === 'value') {\n        return bindIt(context, view, to, element, 'input', el => el.value, (el, value) => el.value = value)\n    }\n\n    if (tag === 'input' && from === 'checked') {\n        return bindIt(context, view, to, element, 'change', el => el.checked, (el, value) => el.checked = value)\n    }\n\n    if (tag === 'select' && from === 'value') {\n        return bindIt(context, view, to, element, 'change', getSelectValue, setSelectOption)\n    }\n\n    if (tag === 'input' && from === 'group') {\n        const type = (element as HTMLInputElement).type\n        if (type !== 'checkbox' && type !== 'radio') return null\n        return bindGroup(context, view, view._groups[to], to, (element as HTMLInputElement))\n    }\n\n    return null\n}\n","import { StaticNode } from './static-node'\nimport { Helper, DelayTransfomer } from './helper'\nimport { Disposable } from '../drizzle'\nimport { View } from '../view'\nimport { bind } from './binding'\nimport { Delay, Attribute, ChangeType, resolveEventArgument, Updatable, customEvents } from './template'\nimport { Renderable } from '../renderable'\nimport { setAttribute } from './attributes'\n\nexport class DynamicNode extends StaticNode {\n    dynamicAttributes: {[name: string]: Helper[]} = {}\n    events: {[event: string]: {method: string, args: Attribute[]}} = {}\n    actions: {[event: string]: {method: string, args: Attribute[]}} = {}\n    bindings: [string, string][] = []\n\n    eventHooks: Disposable[]\n    actionHooks: Disposable[]\n    bindingHooks: Updatable[]\n\n    context: object\n\n    attribute (name: string, ...helpers: Helper[]) {\n        this.dynamicAttributes[name] = helpers\n    }\n\n    on (event: string, method: string, args: Attribute[] = []) {\n        this.events[event] = {method, args}\n    }\n\n    action (event: string, method: string, args: Attribute[] = []) {\n        this.actions[event] = {method, args}\n    }\n\n    bind (from: string, to: string) {\n        this.bindings.push([from, to])\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        super.init(root, delay)\n        if (!(this.root instanceof View)) return\n\n        const view = this.root\n\n        this.bindings.forEach(([from, to]) => {\n            if (from !== 'group' || this.name.toLowerCase() !== 'input') return\n            const attr = this.attributes.find(it => it[0].toLowerCase() === 'type')\n            if (!attr) return\n            const type = attr[1].toLowerCase()\n            if (type !== 'checkbox' && type !== 'radio') return\n\n            const groups = view._groups\n            if (!groups[to]) groups[to] = {type, items: [], busy: false}\n            else if (groups[to].type !== type) {\n                throw Error('binding group can not mix up checkbox and radio')\n            }\n            groups[to].items.push(this) // TODO if this item is hidden by if, should it works?\n        })\n\n        Object.keys(this.dynamicAttributes).forEach(k => {\n            this.dynamicAttributes[k].forEach(it => {\n                if (it instanceof DelayTransfomer) {\n                    (it as DelayTransfomer).init(view)\n                }\n            })\n        })\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        super.render(context, delay)\n        this.updateAttributes(context)\n\n        this.context = context\n        this.eventHooks = Object.keys(this.events).map(it =>\n            this.initEvent(it, this.events[it].method, this.events[it].args)\n        )\n        this.actionHooks = Object.keys(this.actions).map(it =>\n            this.initAction(it, this.actions[it].method, this.actions[it].args)\n        )\n        this.bindingHooks = this.bindings.map(it => bind(this, context, it[0], it[1])).filter(it => !!it)\n    }\n\n    initEvent (name: string, method: string, args: Attribute[]): Disposable {\n        const me = this\n        const cb = function(this: HTMLElement, event) {\n            const as = resolveEventArgument(this, me.context, args, event)\n            me.root._event(method, ...as)\n        }\n\n        return this.bindEvent(name, cb)\n    }\n\n    initAction (name: string, action: string, args: Attribute[]): Disposable {\n        if (!(this.root instanceof View)) return\n        const me = this\n\n        const cb = function(this: HTMLElement, event) {\n            const data = resolveEventArgument(this, me.context, args, event)\n            const root = (me.root as View)\n            root._action(action, ...data)\n        }\n\n        return this.bindEvent(name, cb)\n    }\n\n    bindEvent (name: string, cb: (event: any) => void): Disposable {\n        let ce = this.root._options.customEvents\n        if (!ce || !ce[name]) ce = this.root.app.options.customEvents\n        if (!ce || !ce[name]) ce = customEvents\n        if (ce && ce[name]) {\n            return ce[name](this.element, cb)\n        }\n\n        this.element.addEventListener(name, cb, false)\n        return {\n            dispose: () => {\n                this.element.removeEventListener(name, cb, false)\n            }\n        }\n    }\n\n    updateAttributes (context: object) {\n        Object.keys(this.dynamicAttributes).forEach(it => {\n            const vs = this.dynamicAttributes[it].map(i => i.render(context))\n            if (vs.some(i => i[0] === ChangeType.CHANGED)) {\n                const vvs = vs.map(i => i[1])\n                if (vvs.length === 1) {\n                    setAttribute(this.element, it, vvs[0])\n                } else {\n                    const v = it === 'class' ? vvs.join(' ') : vvs.join('')\n                    setAttribute(this.element, it, v)\n                }\n            }\n        })\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n\n        this.updateAttributes(context)\n        this.context = context\n        this.bindingHooks.forEach(it => it.update(context))\n        this.children.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        super.destroy(delay)\n\n        this.bindingHooks.forEach(it => it.dispose())\n        this.actionHooks.forEach(it => it.dispose())\n        this.eventHooks.forEach(it => it.dispose())\n\n        this.bindingHooks = []\n        this.actionHooks = []\n        this.eventHooks = []\n    }\n}\n","import { Node } from './node'\nimport { Delay, ChangeType } from './template'\nimport { Helper, DelayTransfomer } from './helper'\nimport { Renderable } from '../renderable'\nimport { View } from '../view'\n\nexport class TextNode extends Node {\n    helpers: Helper[]\n    node: Text\n\n    constructor(text: Helper[] = []) {\n        super()\n        this.helpers = text\n    }\n\n    init (root: Renderable<any>) {\n        this.node = document.createTextNode('')\n        if (root instanceof View) {\n            this.helpers.forEach(it => {\n                if (it instanceof DelayTransfomer) {\n                    it.init(root)\n                }\n            })\n        }\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        this.rendered = true\n        if (this.nextSibling && this.nextSibling.element) {\n            this.parent.element.insertBefore(this.node, this.nextSibling.element)\n        } else {\n            this.parent.element.appendChild(this.node)\n        }\n\n        this.update(context, delay)\n    }\n\n    update (context: object, delay: Delay) {\n        const r = this.helpers.map(h => h.render(context))\n        if (r.some(rr => rr[0] === ChangeType.CHANGED)) {\n            this.node.data = r.map(rr => rr[1]).join(' ')\n        }\n    }\n\n    destroy () {\n        if (!this.rendered) return\n        this.parent.element.removeChild(this.node)\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Node } from './node'\nimport { Renderable } from '../renderable'\nimport { Delay, Attribute, resolveEventArgument } from './template'\nimport { Module } from '../module'\nimport { View } from '../view'\nimport { StaticNode } from './static-node'\nimport { Disposable } from '../drizzle'\n\ninterface BindResult {\n    fn: (any) => void\n    event: string\n}\n\nexport class ReferenceNode extends Node {\n    name: string\n    item: Module | View\n    events: {[event: string]: {method: string, args: Attribute[]}} = {}\n    actions: {[event: string]: {method: string, args: Attribute[]}} = {}\n    bindings: [string, string][] = []\n    grouped: {[name: string]: Node[]} = {}\n\n    hooks: Disposable[] = []\n    context: object\n\n    constructor(name: string, id?: string) {\n        super(id)\n        this.name = name\n    }\n\n    bind (from: string, to?: string) {\n        this.bindings.push([from, to || from])\n    }\n\n    on (event: string, method: string, args: Attribute[]) {\n        this.events[event] = {method, args}\n    }\n\n    action (event: string, method: string, args: Attribute[]) {\n        this.actions[event] = {method, args}\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        const fn = (i: Module | View) => {\n            this.item = i\n            if (this.id) root.ids[this.id] = i\n        }\n        if (root instanceof View) {\n            delay.add(root._module.createItem(this.name).then(fn))\n        } else {\n            delay.add((root as Module).createItem(this.name).then(fn))\n        }\n\n        this.children.forEach(it => {\n            let name = 'default'\n            if (it instanceof StaticNode) {\n                const attr = (it.attributes as [string, string][]).find(n => n[0] === 'region')\n                if (attr) name = attr[1]\n            }\n\n            if (!this.grouped[name]) this.grouped[name] = []\n            this.grouped[name].push(it)\n        })\n    }\n\n    render (context: object, delay: Delay) {\n        delay.add(this.item.set(this.bindings.reduce((acc, item) => {\n            acc[item[1]] = context[item[0]]\n            return acc\n        }, {})))\n        delay.add(this.item._render(this.parent.element, this.nextSibling && this.nextSibling.element).then(() => {\n            return Promise.all(Object.keys(this.grouped).map(k => {\n                return this.item.regions[k]._showNode(this.grouped[k], context)\n            }))\n        }))\n\n        this.context = context\n        let cbs = []\n        if (this.item instanceof Module) {\n            const m = this.item\n            cbs = cbs.concat(this.bindEvents(this.root, m, context))\n\n            if (this.root instanceof View) {\n                cbs = cbs.concat(this.bindActions(this.root, m, context))\n            }\n\n            this.hooks = cbs.map(it => m.on(it.event, it.fn))\n        }\n    }\n\n    bindEvents (root: Renderable<any>, target: Module, context: object): BindResult[] {\n        const me = this\n        const obj = {context}\n\n        return Object.keys(this.events).map(it => {\n            const cb = function (this: Module, event: any) {\n                const data = resolveEventArgument(this, obj.context, me.events[it].args, event)\n                root._event(me.events[it].method, ...data)\n            }\n            return {fn: cb, event: it, update: (ctx) => obj.context = ctx}\n        })\n    }\n\n    bindActions (root: View, target: Module, context: object): BindResult[] {\n        const me = this\n\n        return Object.keys(this.actions).map(it => {\n            const cb = function(this: Module, event: any) {\n                const data = resolveEventArgument(this, me.context, me.actions[it].args, event)\n                root._action(me.actions[it].method, ...data)\n            }\n            return {fn: cb, event: it}\n        })\n    }\n\n    update (context: object, delay: Delay) {\n        delay.add(this.item.set(this.bindings.reduce((acc, item) => {\n            acc[item[1]] = context[item[0]]\n            return acc\n        }, {})))\n\n        this.context = context\n        this.children.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        delay.add(this.item.destroy())\n        this.hooks.forEach(it => it.dispose())\n        this.hooks = []\n        delay.add(Promise.all(Object.keys(this.grouped).map(it => {\n            return this.item.regions[it].close()\n        })))\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Node } from './node'\nimport { Delay } from './template'\nimport { Renderable } from '../renderable'\n\nexport class RegionNode extends Node {\n    nodes: Node[]\n    item: Renderable<any>\n    context: object\n\n    constructor(id: string = 'default') {\n        super()\n        this.id = id\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        this.children.forEach(it => {\n            it.parent = this.parent\n            it.nextSibling = this.nextSibling\n            it.init(root, delay)\n        })\n\n        const me = this\n        root.regions[this.id] = {\n            show (item: Renderable<any>): Promise<any> {\n                return me.show(item)\n            },\n            _showNode (nodes: Node[], context: object): Promise<any> {\n                return me.showNode(nodes, context)\n            },\n            close () {\n                return me.close()\n            }\n        }\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n\n        this.rendered = true\n        this.context = context\n        this.children.forEach(it => it.render(context, delay))\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n        this.context = context\n        this.children.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        if (this.nodes) this.nodes.forEach(it => it.destroy(delay))\n        if (this.item) delay.add(this.item.destroy())\n        this.children.forEach(it => it.destroy(delay))\n        this.rendered = false\n    }\n\n    showNode (nodes: Node[], context: object): Promise<any> {\n        if (!this.rendered) return\n        this.nodes = nodes\n        return this.close().then(() => {\n            return Delay.also(d => this.nodes.forEach(it => it.render(context, d)))\n        })\n    }\n\n    show (item: Renderable<any>) {\n        if (!this.rendered) return\n        this.item = item\n        return this.close().then(() => {\n            return item._render(this.parent.element, this.nextSibling && this.nextSibling.element) // TODO\n        })\n    }\n\n    close (): Promise<any> {\n        if (!this.nodes && !this.item) return Promise.resolve()\n        return Promise.resolve().then(() => {\n            if (this.nodes) return Delay.also(d => this.nodes.forEach(it => it.destroy(d)))\n        }).then(() => {\n            if (this.item) return this.item.destroy()\n        }).then(() => {\n            this.nodes = null\n            this.item = null\n            return Delay.also(d => this.children.forEach(it => it.render(this.context, d)))\n        })\n    }\n\n    create () {\n        return null\n    }\n}\n","import {\n    IfHelper, EqHelper, UnlessHelper, GtHelper, LtHelper,\n    GteHelper, LteHelper, Helper, DelayTransfomer, ConcatHelper, EchoHelper, NeHelper\n} from './template/helper'\nimport { IfBlock, UnlessBlock, GtBlock, LtBlock, GteBlock, LteBlock, EqBlock, NeBlock } from './template/if-block'\nimport { EachBlock } from './template/each-block'\nimport { Loader } from './loader'\nimport { ModuleTemplate } from './template/module-template'\nimport { ViewTemplate } from './template/view-template'\nimport { customEvents, Attribute, AttributeValue } from './template/template'\nimport { Application } from './application'\nimport { StaticNode } from './template/static-node'\nimport { DynamicNode } from './template/dynamic-node'\nimport { TextNode } from './template/text-node'\nimport { ReferenceNode } from './template/reference-node'\nimport { RegionNode } from './template/region-node'\nimport { Node } from './template/node'\n\nexport interface Disposable {\n    dispose (): void\n}\n\nconst helpers = {\n    echo: EchoHelper, if: IfHelper, unless: UnlessHelper, eq: EqHelper, gt: GtHelper,\n    lt: LtHelper, gte: GteHelper, lte: LteHelper, concat: ConcatHelper, ne: NeHelper\n}\n\nconst blocks = {\n    if: IfBlock, unless: UnlessBlock, each: EachBlock, gt: GtBlock,\n    lt: LtBlock, gte: GteBlock, lte: LteBlock, eq: EqBlock, ne: NeBlock\n}\n\nconst loaders = {\n    default: Loader\n}\n\nconst SN = (name: string, id: string, ...attributes: [string, string][]) => {\n    return new StaticNode(name, attributes || [], id)\n}\nconst DN = (\n    name: string, id: string, attributes: [string, string][] = [],\n    dynamics: [string, Helper[]][],\n    binds: [string, string][],\n    events: [string, string, Attribute[]][],\n    actions: [string, string, Attribute[]][]\n) => {\n    const d = new DynamicNode(name, attributes, id)\n    if (dynamics) dynamics.forEach(da => d.attribute(da[0], ...da[1]))\n    if (binds) binds.forEach(b => d.bind(b[0], b[1]))\n    if (events) events.forEach(e => d.on(e[0], e[1], e[2]))\n    if (actions) actions.forEach(a => d.action(a[0], a[1], a[2]))\n    return d\n}\nconst TN = (...text: Helper[]) => new TextNode(text)\nconst TX = (...ss: string[]) => new TextNode([new ConcatHelper(...ss.map(it => SV(it)))])\nconst RG = (id: string = 'default') => new RegionNode(id)\nconst REF = (\n    name: string, id: string,\n    binds: [string, string][],\n    events: [string, string, Attribute[]][],\n    actions: [string, string, Attribute[]][]\n) => {\n    const d = new ReferenceNode(name, id)\n    if (binds) binds.forEach(b => d.bind(b[0], b[1]))\n    if (events) events.forEach(e => d.on(e[0], e[1], e[2]))\n    if (actions) actions.forEach(a => d.action(a[0], a[1], a[2]))\n    return d\n}\n\nconst E = (event: string, method: string, ...attrs: Attribute[]) => [event, method, attrs]\nconst NDA = (v: string) => [null, [1, v]] as Attribute\nconst NSA = (v: string) => [null, [0, v]] as Attribute\nconst DA = (name: string, ...hs: Helper[]) => [name, hs]\n\nconst SV = (v: string) => [0, v] as AttributeValue\nconst DV = (v: string) => [1, v] as AttributeValue\nconst AT = (n: string, v: AttributeValue) => [n, v] as Attribute\nconst KV = (k: string, v?: string) => [k, v || k]\n\nconst H = (n: string) => new EchoHelper(DV(n))\nconst TR = (n: string, ...args: AttributeValue[]) => new DelayTransfomer(n, ...args)\nconst HIF = (n: string, t: AttributeValue, f: AttributeValue) => f ? new IfHelper(DV(n), t, f) : new IfHelper(DV(n), t)\nconst HEQ = (...args: AttributeValue[]) => new EqHelper(...args)\nconst HGT = (...args: AttributeValue[]) => new GtHelper(...args)\nconst HLT = (...args: AttributeValue[]) => new LtHelper(...args)\nconst HGTE = (...args: AttributeValue[]) => new GteHelper(...args)\nconst HLTE = (...args: AttributeValue[]) => new LteHelper(...args)\nconst HNE = (...args: AttributeValue[]) => new NeHelper(...args)\n\nconst EACH = (args: string[], trueNode: () => Node, falseNode?: Node) => new EachBlock(args, trueNode, falseNode)\nconst IF = (n: string, trueNode: Node, falseNode?: Node) => new IfBlock([DV(n)], trueNode, falseNode)\nconst EQ = (\n    l: AttributeValue, r: AttributeValue, trueNode: Node, falseNode?: Node\n) => new EqBlock([l, r], trueNode, falseNode)\n\nconst GT = (\n    l: AttributeValue, r: AttributeValue, trueNode: Node, falseNode?: Node\n) => new GtBlock([l, r], trueNode, falseNode)\n\nconst LT = (\n    l: AttributeValue, r: AttributeValue, trueNode: Node, falseNode?: Node\n) => new LtBlock([l, r], trueNode, falseNode)\n\nconst GTE = (\n    l: AttributeValue, r: AttributeValue, trueNode: Node, falseNode?: Node\n) => new GteBlock([l, r], trueNode, falseNode)\n\nconst LTE = (\n    l: AttributeValue, r: AttributeValue, trueNode: Node, falseNode?: Node\n) => new LteBlock([l, r], trueNode, falseNode)\n\nconst NE = (\n    l: AttributeValue, r: AttributeValue, trueNode: Node, falseNode?: Node\n) => new NeBlock([l, r], trueNode, falseNode)\n\nconst C = (parent: Node, ...children: Node[]) => parent.setChildren(children)\n\nexport default {\n    helpers, blocks, loaders, customEvents,\n    lifecycles: {module: [], view: []},\n    ModuleTemplate, ViewTemplate, Application,\n    factory: {\n        SN, DN, TN, TX, RG, REF, E, NDA, NSA, SV, DV, AT, KV, H, TR, HIF, HEQ, HGT, HLT, HGTE, HLTE, HNE,\n        EACH, IF, EQ, GT, LT, GTE, LTE, NE, C, DA, A: E, B: KV\n    }\n}\n"],"names":["Node","id","root","delay","element","create","ids","children","forEach","it","init","context","destroy","i","nextSibling","parent","FakeNode","el","ValueType","ChangeType","Delay","p","delays","push","Promise","all","fn","d","execute","getValue","key","ks","split","first","shift","ctx","_computed","length","reduce","acc","item","getAttributeValue","attr","STATIC","resolveEventArgument","me","args","event","values","map","name","v","slice","obj","result","keys","customEvents","enter","node","cb","ee","e","keyCode","preventDefault","call","addEventListener","dispose","removeEventListener","escape","Template","nodes","container","_element","next","_nextSibling","render","update","Helper","dynamicKeys","filter","DYNAMIC","check","currentValues","CHANGED","renderIt","vs","currentKeys","some","NOT_CHANGED","current","idx","arg","numbers","Error","join","doRender","Transfromer","apply","DelayTransfomer","helpers","_options","EchoHelper","ConcatHelper","IfHelper","assertCount","assertDynamic","use","UnlessHelper","EqHelper","v1","v2","NeHelper","GtHelper","GteHelper","LtHelper","LteHelper","IfBlock","trueNode","falseNode","rendered","UnlessBlock","EqBlock","use2","NeBlock","GtBlock","GteBlock","LtBlock","LteBlock","EachBlock","list","Array","isArray","Object","o","assign","_each","index","isEmpty","renderElse","kv","renderKeyValue","arr","currentSize","sub","empty","updateElse","updateKeyValue","pop","Loader","app","path","_app","_path","_args","file","options","getResource","scriptRoot","ModuleTemplate","exportedModels","items","life","stage","also","beforeRender","get","updated","beforeDestroy","views","view","loader","ViewTemplate","getContext","c","_state","computed","callIt","cycles","method","reverse","then","resolve","LifecycleContainer","cs","stages","s","_cycles","ComponentState","Renderable","CREATED","_status","INITED","RENDERED","_busy","_doBeforeRender","_doRendered","_doBeforeDestroy","_doDestroyed","_doInit","events","Model","set","data","parser","_data","Store","updateKey","models","_names","_models","k","actions","payload","reject","View","mod","template","_module","silent","_doBeforeUpdate","_doUpdated","dispatch","UPDATE_ACTION","Date","clone","target","Module","_loader","_store","handler","_handlers","hs","indexOf","splice","opt","type","_init","busy","store","state","_loadItems","loaders","createLoader","module","load","Application","entry","_render","ps","attributes","tags","ac","setAttribute","value","n","toLowerCase","t","tagName","StaticNode","appendChild","removeChild","document","createElement","distruct","bindIt","to","each","find","r","getSelectValue","selectedIndex","setSelectOption","selected","bindGroup","group","checked","its","changed","vv","bind","from","tag","_groups","DynamicNode","dynamicAttributes","bindings","groups","updateAttributes","eventHooks","initEvent","actionHooks","initAction","bindingHooks","as","_event","bindEvent","action","_action","ce","vvs","TextNode","text","createTextNode","insertBefore","h","rr","ReferenceNode","add","createItem","grouped","regions","_showNode","cbs","m","concat","bindEvents","bindActions","hooks","on","close","RegionNode","show","showNode","echo","if","unless","eq","gt","lt","gte","lte","ne","blocks","default","SN","DN","dynamics","binds","attribute","da","b","a","TN","TX","ss","SV","RG","REF","E","attrs","NDA","NSA","DA","DV","AT","KV","H","TR","HIF","f","HEQ","HGT","HLT","HGTE","HLTE","HNE","EACH","IF","EQ","l","GT","LT","GTE","LTE","NE","C","setChildren","lifecycles","factory","A","B"],"mappings":"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"}