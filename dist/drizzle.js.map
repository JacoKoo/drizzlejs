{"version":3,"file":"drizzle.js","sources":["../src/template/template.ts","../src/template/context.ts","../src/template/util.ts","../src/renderable.ts","../src/template/node.ts","../src/template/anchor-node.ts","../src/template/if-block.ts","../src/template/helper.ts","../src/template/each-block.ts","../src/loader.ts","../src/lifecycle.ts","../src/model.ts","../src/store.ts","../src/view.ts","../src/event.ts","../src/module.ts","../src/application.ts","../src/template/attributes.ts","../src/template/static-node.ts","../src/template/binding.ts","../src/template/dynamic-node.ts","../src/template/text-node.ts","../src/template/reference-node.ts","../src/template/region-node.ts","../src/template/transformer.ts","../src/route.ts","../src/template/special-nodes.ts","../src/drizzle.ts"],"sourcesContent":["import { Disposable } from '../drizzle'\nimport { Node as MNode } from './node'\nimport { Renderable } from '../renderable'\nimport { Transformer } from './transformer'\nimport { DataContext, ViewDataContext, ModuleDataContext, BindingGroup } from './context'\nimport { Module } from '../module'\nimport { View } from '../view'\n\ntype StaticValue = string | number | boolean\ntype DynamicValue = string\n\nexport enum ValueType { STATIC, DYNAMIC, TRANSFORMER }\nexport enum ChangeType { CHANGED, NOT_CHANGED }\n\nexport type NormalValue = [ValueType.STATIC, StaticValue] | [ValueType.DYNAMIC, DynamicValue]\nexport type AttributeValue = NormalValue | [ValueType.TRANSFORMER, Transformer]\nexport type Attribute = [string, AttributeValue]\n\nexport type HelperResult = [ChangeType, any]\n\nexport interface Updatable extends Disposable {\n    update (context: DataContext): void\n}\n\nexport interface Appendable {\n    append (el: Node)\n    remove (el: Node)\n    before (anchor: Node): Appendable\n}\n\nlet i = 0\nexport abstract class Template {\n    creator: () => MNode[]\n\n    createLife () {\n        const me = this\n        const o = {\n            id: i ++,\n            stage: 'template',\n            nodes: [] as MNode[],\n            groups: {} as {[name: string]: BindingGroup},\n\n            init (this: Renderable<any>) {\n                o.nodes = me.creator()\n                const context = me.create(this, o.groups)\n                o.nodes.forEach((it, idx) => {\n                    it.nextSibling = o.nodes[idx + 1]\n                    it.init(context)\n                })\n                return context.end()\n            },\n\n            rendered (this: Renderable<any>, data: object) {\n                const context = me.create(this, o.groups, data)\n                o.nodes.forEach(it => {\n                    it.parent = this._target\n                    it.render(context)\n                })\n                return context.end()\n            },\n\n            updated (this: Renderable<any>, data: object) {\n                const context = me.create(this, o.groups, data)\n                o.nodes.forEach(it => it.update(context))\n                return context.end()\n            },\n\n            destroyed (this: Renderable<any>) {\n                const context = me.create(this, o.groups)\n                o.nodes.forEach(it => it.destroy(context))\n                return context.end()\n            }\n        }\n\n        return o\n    }\n\n    abstract create (root: Renderable<any>, groups: {[name: string]: BindingGroup}, data?: object): DataContext\n}\n\nexport class ViewTemplate extends Template {\n    create (root: View, groups: {[name: string]: BindingGroup}, data: object = {}): DataContext {\n        return new ViewDataContext(root, data, groups)\n    }\n}\n\nexport class ModuleTemplate extends Template {\n    exportedModels: string[] = []\n\n    constructor(exportedModels: string[]) {\n        super()\n        this.exportedModels = exportedModels\n    }\n\n    create (root: Module, groups: {[name: string]: BindingGroup}, data: object = {}): DataContext {\n        return new ModuleDataContext(root, data)\n    }\n}\n","import { Disposable } from '../drizzle'\nimport { DynamicNode } from './dynamic-node'\nimport { Module } from '../module'\nimport { View } from '../view'\nimport { Region, Renderable } from '../renderable'\n\nexport interface ComponentHook extends Disposable {\n    update (...args: any[]): void\n}\nexport type Component = (node: Node, ...args: any[]) => ComponentHook\nexport type CustomHelper = (...args: any[]) => any\nexport type CustomEvent = (name: EventTarget, cb: (event: any) => void) => Disposable\n\nexport interface BindingGroup {\n    type: 'checkbox' | 'radio'\n    items: DynamicNode[]\n    busy: boolean\n}\n\nexport interface Context {\n    groups: {[name: string]: BindingGroup}\n\n    name (): string\n    create (name: string, state?: object): Promise<Module | View>\n\n    helper (name: string): CustomHelper | undefined\n    component (name: string): Component | undefined\n    event (name: string): CustomEvent | undefined\n    computed (name: string): (any) => any | undefined\n\n    ref (id: string, node?: HTMLElement | Renderable<any>): void\n    region (id: string, region: Region): void\n\n    delay (p: Promise<any>): void\n    end (): Promise<any>\n}\n\nexport interface DataContext extends Context {\n    data: {[name: string]: any}\n    update (data: object): void\n\n    trigger (name: string, ...args: any[]): void\n    dispatch (name: string, ...args: any[]): void\n\n    sub (data: {[name: string]: any}): DataContext\n}\n\nexport abstract class AbstractDataContext implements DataContext {\n    groups = {}\n    data = {}\n    busy: Promise<any>[]\n    root: Module | View\n\n    constructor (\n        root: Module | View, data?: {[name: string]: any},\n        groups?: {[name: string]: BindingGroup}, busy?: Promise<any>[]\n    ) {\n        this.root = root\n        this.data = data || {}\n        this.groups = groups || {}\n        this.busy = busy || []\n    }\n\n    name () {\n        return this.root._options._file\n    }\n\n    update (data: object): void {\n        this.root.set(data)\n    }\n\n    trigger (name: string, ...args: any[]): void {\n        this.root._event(name, ...args)\n    }\n\n    dispatch (name: string, ...args: any[]): void {\n        this.root._action(name, ...args)\n    }\n\n    ref (id: string, node?: HTMLElement | Renderable<any>): void {\n        if (node) this.root.ids[id] = node\n        else delete this.root.ids[id]\n    }\n\n    region (id: string, region: Region): void {\n        this.root.regions[id] = region\n    }\n\n    delay (p: Promise<any>): void {\n        this.busy.push(p)\n    }\n\n    end (): Promise<any> {\n        const p = this.busy.slice(0)\n        this.busy = []\n        return Promise.all(p)\n    }\n\n    event (name: string): CustomEvent | undefined {\n        const ce = this.root._options.customEvents\n        return (ce && ce[name]) || this.root.app.options.customEvents[name]\n    }\n\n    computed (name: string): (any) => any | undefined {\n        const c = this.root._options.computed\n        return c && c[name]\n    }\n\n    abstract sub (data: {[name: string]: any}): DataContext\n    abstract create (name: string, state?: object): Promise<Module | View>\n    abstract helper (name: string): CustomHelper | undefined\n    abstract component (name: string): Component | undefined\n}\n\nexport class ViewDataContext extends AbstractDataContext {\n    sub (data: {[name: string]: any}): DataContext {\n        return new ViewDataContext(this.root, data, this.groups, this.busy)\n    }\n\n    create (name: string, state?: object): Promise<Module | View> {\n        const p = (this.root as View)._module._createItem(name, state)\n        this.delay(p)\n        return p\n    }\n\n    helper (name: string): CustomHelper | undefined {\n        const h = (this.root as View)._options.helpers\n        return (h && h[name]) || this.root.app.options.helpers[name]\n    }\n\n    component (name: string): Component | undefined {\n        const c = (this.root as View)._options.components\n        return (c && c[name]) || this.root.app.options.components[name]\n    }\n}\n\nexport class ModuleDataContext extends AbstractDataContext {\n    sub (data: {[name: string]: any}): DataContext {\n        return new ModuleDataContext(this.root, data, this.groups, this.busy)\n    }\n\n    create (name: string, state?: object): Promise<Module | View> {\n        const p = (this.root as Module)._createItem(name, state)\n        this.delay(p)\n        return p\n    }\n\n    helper (name: string): CustomHelper | undefined {\n        return\n    }\n\n    component (name: string): Component | undefined {\n        return\n    }\n}\n","import { AttributeValue, ValueType, Attribute, Appendable } from './template'\nimport { DataContext } from './context'\nimport { Transformer } from './transformer'\n\nexport function tokenize(input: string): string[] {\n    let token = ''\n    const result = [] as string[]\n    let inString = false\n\n    const push = () => {\n        if (token) result.push(token)\n        token = ''\n    }\n\n    for (let i = 0; i < input.length; i++) {\n        const t = input[i]\n        if (inString) {\n            if (t === '\\\\' && input[i + 1] === ']') {\n                token += ']'\n                i++\n                continue\n            }\n            if (t === ']') {\n                push()\n                inString = false\n                continue\n            }\n            token += t\n            continue\n        }\n\n        if (t === '[') {\n            push()\n            inString = true\n            continue\n        }\n\n        if (t === '.') {\n            push()\n            continue\n        }\n        token += t\n    }\n\n    if (token) result.push(token)\n\n    return result\n}\n\nexport function getValue (key: string, context: DataContext): any {\n    const ks = tokenize(key)\n    const first = ks.shift()\n    let ctx\n    const data = context.data\n    const computed = context.computed(first)\n    if (computed) {\n        ctx = computed(data)\n    } else {\n        ctx = data[first]\n    }\n\n    if (ks.length) {\n        ctx = ks.reduce((acc, item) => {\n            if (acc == null) return null\n            return acc[item]\n        }, ctx)\n    }\n\n    return ctx\n}\n\nexport function getAttributeValue(attr: AttributeValue, context: DataContext): any {\n    if (attr[0] === ValueType.STATIC) return attr[1]\n    if (attr[0] === ValueType.DYNAMIC) return getValue(attr[1] as string, context)\n    return (attr[1] as Transformer).render(context)\n}\n\nexport function resolveEventArgument (me: any, context: DataContext, args: Attribute[], event: any): any[] {\n    const o = Object.assign({}, context.data, {event, this: me})\n    const sub = context.sub(o)\n\n    const obj = {}\n    const result = [obj]\n    let keys = 0\n\n    args.forEach(([name, v]) => {\n        const value = getAttributeValue(v, sub)\n        if (name) {\n            keys ++\n            obj[name] = value\n            return\n        }\n        result.push(value)\n    })\n\n    if (keys === 0) result.shift()\n    return result\n}\n\nexport function createAppendable (target: Node): Appendable {\n    if (!target) return null\n    const remove = (el: Node) => target.removeChild(el)\n    const append = (el: Node) => target.appendChild(el)\n    const before = (anchor: Node) => {\n        return {remove, before, append: (el: Node) => target.insertBefore(el, anchor)}\n    }\n    return {append, remove, before}\n}\n","import { Lifecycle, LifecycleContainer } from './lifecycle'\nimport { Application } from './application'\nimport { Disposable } from './drizzle'\nimport { Node } from './template/node'\nimport { Appendable, ModuleTemplate } from './template/template'\n\nexport interface RenderOptions extends Lifecycle {\n    cycles?: Lifecycle[]\n    customEvents?: {[name: string]: (HTMLElement, callback: (any) => void) => Disposable}\n    events?: {[name: string]: (...args) => void}\n    template?: ModuleTemplate\n    computed?: {[name: string]: (any) => any}\n    actions?: {[name: string]: (cb: (data: any) => Promise<any>, data: object) => void}\n    _file?: string\n}\n\nexport enum ComponentState {\n    CREATED, INITED, RENDERED\n}\n\nexport interface Region {\n    item: Renderable<any>\n    show (name: string, state: object): Promise<Renderable<any>>\n    close (): Promise<any>\n\n    _showNode (nodes: Node[], context: object): Promise<any>\n    _showChildren ()\n}\n\nexport abstract class Renderable<T extends RenderOptions> extends LifecycleContainer {\n    _target: Appendable\n    _options: T\n    ids: {[key: string]: HTMLElement | Renderable<T>} = {}\n    regions: {[key: string]: Region}\n\n    protected _busy: Promise<any> = Promise.resolve()\n    protected _status = ComponentState.CREATED\n\n    constructor(app: Application, options: T, ...args: Lifecycle[]) {\n        super(app, options, ...args)\n        this._options = options\n    }\n\n    _render (target: Appendable) {\n        if (this._status !== ComponentState.INITED) return Promise.resolve()\n\n        this._target = target\n        this._busy = this._busy\n            .then(() => this._doBeforeRender())\n            .then(() => this._doCollect(this.get()))\n            .then(data => this._doRendered(data))\n            .then(() => this._status = ComponentState.RENDERED)\n\n        return this._busy\n    }\n\n    destroy () {\n        if (this._status !== ComponentState.RENDERED) return Promise.resolve()\n\n        this._busy = this._busy\n            .then(() => this._doBeforeDestroy())\n            .then(() => this._doDestroyed())\n            .then(() => this._status = ComponentState.INITED)\n\n        return this._busy\n    }\n\n    _init () {\n        return this._busy = this._busy\n            .then(() => this._doInit())\n            .then(() => this._status = ComponentState.INITED)\n    }\n\n    _event (name, ...args: any[]) {\n        const {events} = this._options\n        if (events && events[name]) events[name].apply(this, args)\n    }\n\n    _action (name: string, ...data: any[]) {\n        const {actions} = this._options\n        if (actions && actions[name]) {\n            actions[name].call(this, (d: any) => {\n                return this._dispatch(name, d)\n            }, ...data)\n            return\n        }\n\n        this._dispatch(name, data[0])\n    }\n\n    abstract get (name?: string): object\n    abstract _dispatch (name: string, data: any): Promise<any>\n}\n","import { createAppendable } from './util'\nimport { Appendable } from './template'\nimport { Context, DataContext } from './context'\n\nexport abstract class Node {\n    id: string\n    element: HTMLElement\n    parent: Appendable\n    children: Node[] = []\n    nextSibling: Node\n    rendered: boolean = false\n    inSvg: boolean = false\n\n    constructor(id?: string) {\n        this.id = id\n    }\n\n    init (context: Context) {\n        this.element = this.create()\n        const a = createAppendable(this.element)\n        this.children.forEach(it => {\n            it.parent = a\n            it.init(context)\n        })\n    }\n\n    render (context: DataContext) {\n        if (this.id && this.element) context.ref(this.id, this.element)\n    }\n\n    update (context: DataContext) {\n    }\n\n    destroy (context: Context) {\n        this.children.forEach(it => it.destroy(context))\n        if (this.id) context.ref(this.id)\n    }\n\n    setChildren (children: Node[]) {\n        this.children = children\n        children.forEach((it, i) => {\n            if (this.inSvg) it.setToSvg()\n            it.nextSibling = children[i + 1]\n        })\n    }\n\n    setToSvg () {\n        this.inSvg = true\n        this.children.forEach(it => it.inSvg = true)\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Node as MNode } from './node'\nimport { Appendable } from './template'\nimport { DataContext, Context } from './context'\n\nexport abstract class AnchorNode extends MNode {\n    newParent: Appendable\n    anchor: Node\n\n    constructor (id?: string) {\n        super(id)\n    }\n\n    render (context: DataContext) {\n        super.render(context)\n        if (this.newParent) return\n\n        if (this.nextSibling) {\n            this.anchor = document.createComment(Object.getPrototypeOf(this).constructor.name)\n            this.parent.append(this.anchor)\n            this.newParent = this.parent.before(this.anchor)\n        } else {\n            this.newParent = this.parent\n        }\n    }\n\n    destroy (context: Context) {\n        super.destroy(context)\n\n        if (this.anchor) this.parent.remove(this.anchor)\n        this.newParent = null\n    }\n}\n","import { Node } from './node'\nimport { AttributeValue, ValueType } from './template'\nimport { AnchorNode } from './anchor-node'\nimport { getAttributeValue } from './util'\nimport { Context, DataContext } from './context'\n\nexport const Compare: {[key: string]: (v1: any, v2: any) => boolean} = {\n    '==': (v1, v2) => v1 === v2,\n    '!=': (v1, v2) => v1 !== v2,\n    '>': (v1, v2) => v1 > v2,\n    '<': (v1, v2) => v1 < v2,\n    '>=': (v1, v2) => v1 >= v2,\n    '<=': (v1, v2) => v1 <= v2\n}\n\nexport class IfBlock extends AnchorNode {\n    args: AttributeValue[]\n    trueNode: Node\n    falseNode?: Node\n    current: Node\n\n    constructor (args: AttributeValue[], trueNode: Node, falseNode?: Node) {\n        super()\n        this.trueNode = trueNode\n        this.falseNode = falseNode\n        this.args = args\n    }\n\n    init (context: Context) {\n        this.trueNode.init(context)\n        if (this.falseNode) {\n            this.falseNode.init(context)\n        }\n    }\n\n    use (context: DataContext): boolean {\n        if (this.args.length === 1) return this.useSingle(context)\n        if (this.args.length === 3) return this.useCompare(context)\n        throw new Error('if block should have 1 or 3 arguments')\n    }\n\n    useCompare (context: DataContext): boolean {\n        const op = this.args[1][1] as string\n        if (!Compare[op]) {\n            throw Error(`${op} is not a valid compare operator, use: ==, !=, >, <, >=, <=`)\n        }\n        return Compare[op](getAttributeValue(this.args[0], context), getAttributeValue(this.args[2], context))\n    }\n\n    useSingle (context: DataContext): boolean {\n        if (this.args[0][0] === ValueType.STATIC) {\n            return !!this.args[0][1]\n        }\n        return !!getAttributeValue(this.args[0], context)\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n\n        super.render(context)\n\n        this.trueNode.parent = this.newParent\n        if (this.falseNode) {\n            this.falseNode.parent = this.newParent\n        }\n\n        this.current = this.use(context) ? this.trueNode : this.falseNode\n\n        if (this.current) {\n            this.current.render(context)\n        }\n    }\n\n    update (context: DataContext) {\n        if (!this.rendered) return\n\n        const use = this.use(context) ? this.trueNode : this.falseNode\n        if (use === this.current) {\n            if (use) use.update(context)\n            return\n        }\n\n        if (this.current) this.current.destroy(context)\n        this.current = use === this.trueNode ? this.trueNode : this.falseNode\n        if (this.current) this.current.render(context)\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        if (this.current) this.current.destroy(context)\n        super.destroy(context)\n        this.rendered = false\n    }\n\n}\n\nexport class UnlessBlock extends IfBlock {\n    use (context: any): boolean {\n        return !getAttributeValue(this.args[0], context)\n    }\n}\n","import { HelperResult, ChangeType } from './template'\nimport { AttributeValue, ValueType } from './template'\nimport { Compare } from './if-block'\nimport { getAttributeValue } from './util'\nimport { DataContext } from './context'\n\nexport abstract class Helper {\n    name: string = ''\n    args: AttributeValue[]\n    current: any\n\n    constructor (...args: AttributeValue[]) {\n        this.args = args\n        this.check()\n    }\n\n    render (context: DataContext): HelperResult {\n        if (!this.current) return [ChangeType.CHANGED, this.renderIt(context)]\n\n        const c = this.current\n        const u = this.renderIt(context)\n        if (c !== u) {\n            return [ChangeType.CHANGED, this.current]\n        }\n\n        return [ChangeType.NOT_CHANGED, this.current]\n    }\n\n    arg (idx: number, context: DataContext): any {\n        if (!this.args[idx]) return ''\n        return getAttributeValue(this.args[idx], context)\n    }\n\n    check () {}\n\n    assertCount (...numbers: number[]) {\n        if (!numbers.some(it => it === this.args.length)) {\n            throw new Error(`${name} helper should have ${numbers.join(' or ')} arguments`)\n        }\n    }\n\n    assertDynamic (...numbers: number[]) {\n        numbers.forEach(it => {\n            if (this.args[it][0] === ValueType.STATIC) {\n                throw new Error(`the ${it}th argument of ${name} helper should be dynamic`)\n            }\n        })\n    }\n\n    abstract doRender (context: DataContext): any\n\n    private renderIt (context: DataContext): any {\n        this.current = this.doRender(context)\n        return this.current\n    }\n}\n\nexport class DelayHelper extends Helper {\n    constructor(name: string, ...args: AttributeValue[]) {\n        super(...args)\n        this.name = name\n    }\n\n    doRender (context: DataContext): any {\n        const fn = context.helper(this.name)\n        if (!fn) throw new Error(`no helper found: ${this.name}`)\n        return fn.apply(null, this.args.map((it, i) => this.arg(i, context)))\n    }\n}\n\nexport class EchoHelper extends Helper {\n    doRender (context) {\n        return this.arg(0, context)\n    }\n}\n\nexport class ConcatHelper extends Helper {\n    doRender (context) {\n        return this.args.map((it, idx) => this.arg(idx, context)).join('')\n    }\n}\n\nexport class IfHelper extends Helper {\n    name = 'if'\n\n    check () {\n        this.assertCount(2, 3, 4, 5)\n        this.assertDynamic(0)\n    }\n\n    doRender (context: DataContext): any {\n        return this.arg(this.use(context), context)\n    }\n\n    use (context: DataContext): number {\n        if (this.args.length <= 3) return this.useSingle(context)\n        return this.useMultiple(context)\n    }\n\n    useSingle (context): number {\n        return this.arg(0, context) ? 1 : 2\n    }\n\n    useMultiple (context): number {\n        const op = this.args[1][1] as string\n        if (!Compare[op]) {\n            throw Error(`${op} is not a valid compare operator, use: ==, !=, >, <, >=, <=`)\n        }\n\n        return Compare[op](this.arg(0, context), this.arg(2, context)) ? 3 : 4\n    }\n}\n\nexport class UnlessHelper extends IfHelper {\n    name = 'unless'\n\n    use (context: DataContext): number {\n        return this.arg(0, context) ? 2 : 1\n    }\n}\n","import { Node } from './node'\nimport { getValue } from './util'\nimport { AnchorNode } from './anchor-node'\nimport { DataContext, Context } from './context'\n\nexport class EachBlock extends AnchorNode {\n    args: string[]\n    trueNode: () => Node\n    falseNode?: Node\n    currentSize = 0\n    nodes: Node[] = []\n\n    constructor (args: string[], trueNode: () => Node, falseNode?: Node) {\n        super()\n        this.args = args\n        this.trueNode = trueNode\n        this.falseNode = falseNode\n    }\n\n    init () {}\n\n    isEmpty (list: any): boolean {\n        return !list || (Array.isArray(list) && !list.length) || (typeof list === 'object' && !Object.keys(list))\n    }\n\n    sub (context: DataContext, i: number | string) {\n        const o = Object.assign({}, context.data)\n        if (!o._each) o._each = []\n        else o._each = o._each.slice(0)\n\n        const v = getValue(this.args[0], context)\n        o._each.push({list: v, index: i, key: this.args[2], name: this.args[0]})\n\n        o[this.args[2]] = v[i]\n        if (this.args[3]) o[this.args[3]] = i\n        return context.sub(o)\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n\n        super.render(context)\n        if (this.falseNode) this.falseNode.parent = this.newParent\n\n        const list = getValue(this.args[0], context)\n        if (this.isEmpty(list)) {\n            this.renderElse(context)\n            return\n        }\n\n        const kv = Array.isArray(list) ?\n            list.map((it, i) => [i, it]) as [number | string, any] :\n            Object.keys(list).map(it => [it, list[it]] as [number | string, any])\n\n        this.renderKeyValue(kv, context)\n    }\n\n    createTrueNode (i: number, context: DataContext) {\n        const n = this.trueNode()\n        n.parent = this.newParent\n        this.nodes[i] = n\n        n.init(context)\n        context.end().then(() => n.render(context))\n    }\n\n    renderKeyValue (arr: [number | string, any][], context: DataContext) {\n        this.currentSize = arr.length\n        arr.forEach((it, i) => {\n            const sub = this.sub(context, it[0])\n            this.createTrueNode(i, sub)\n        })\n    }\n\n    renderElse (context: DataContext) {\n        if (!this.falseNode) return\n        this.falseNode.init(context)\n        this.falseNode.render(context)\n    }\n\n    update (context: DataContext) {\n        if (!this.rendered) return\n\n        const list = getValue(this.args[0], context)\n        const empty = this.isEmpty(list)\n        if (empty && !this.currentSize) {\n            this.updateElse(context)\n            return\n        }\n\n        if (empty) {\n            this.currentSize = 0\n            this.nodes.forEach(it => it.destroy(context))\n            this.nodes = []\n\n            this.renderElse(context)\n            return\n        }\n\n        if (!this.currentSize && this.falseNode) {\n            this.falseNode.destroy(context)\n        }\n\n        const kv = Array.isArray(list) ?\n            list.map((it, i) => [i, it] as [any, any]) :\n            Object.keys(list).map(it => [it, list[it]] as [any, any])\n\n        this.updateKeyValue(kv, context)\n    }\n\n    updateElse (context: DataContext) {\n        if (this.falseNode) this.falseNode.update(context)\n    }\n\n    updateKeyValue (arr: [any, any][], context: DataContext) {\n        this.currentSize = arr.length\n        arr.forEach((it, i) => {\n            const sub = this.sub(context, it[0])\n\n            if (this.nodes[i]) {\n                this.nodes[i].update(sub)\n            } else {\n                this.createTrueNode(i, sub)\n            }\n        })\n\n        while (this.nodes.length !== this.currentSize) {\n            const node = this.nodes.pop()\n            node.destroy(context)\n        }\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        super.destroy(context)\n\n        if (!this.currentSize) {\n            if (this.falseNode) this.falseNode.destroy(context)\n            return\n        }\n\n        this.currentSize = 0\n        this.nodes.forEach(it => it.destroy(context))\n        this.nodes = []\n        this.rendered = false\n    }\n}\n","import { Application } from './application'\nimport { Module } from './module'\n\nexport class Loader {\n    protected _app: Application\n    protected _path: string\n    protected _args: any\n\n    constructor(app: Application, path: string, args: any) {\n        this._app = app\n        this._path = path\n        this._args = args\n    }\n\n    load (file, mod: Module): Promise<object> {\n        return this._app.options.getResource(`${this._app.options.scriptRoot}/${this._path}/${file}`)\n    }\n}\n","import {Application} from './application'\n\nexport interface Lifecycle {\n    stage?: string\n    init? (): any\n\n    collect? (data: object): object\n\n    beforeRender? (): any\n    rendered? (data: object): any\n\n    beforeUpdate? (): any\n    updated? (data: object): any\n\n    beforeDestroy? (): any\n    destroyed? (): any\n}\n\nconst callIt = (\n    ctx: LifecycleContainer, cycles: Lifecycle[], method: string, reverse = false, args: any[] = []\n): Promise<any> => {\n    return cycles.filter(it => it[method])[reverse ? 'reduceRight' : 'reduce']((acc, it) => {\n        return acc.then(() => it[method].apply(ctx, args))\n    }, Promise.resolve())\n}\n\nexport class LifecycleContainer {\n    app: Application\n    private _cycles: Lifecycle[] = []\n\n    constructor (app: Application, options: {cycles?: Lifecycle[]} & Lifecycle, ...args: Lifecycle[]) {\n        this.app = app\n\n        const cs = options.cycles || []\n        cs.push(options)\n        args.forEach(it => it && cs.push(it))\n        cs.forEach(it => !it.stage && (it.stage = 'default'))\n\n        app.options.stages.forEach(s => cs.forEach(c => {\n            if (c.stage === s) this._cycles.push(c)\n        }))\n    }\n\n    protected _doInit () {\n        return callIt(this, this._cycles, 'init')\n    }\n\n    protected _doCollect (data: object): object {\n        return this._cycles.filter(it => !!it.collect).reduce((acc, item) => item.collect.call(this, acc), data)\n    }\n\n    protected _doBeforeRender () {\n        return callIt(this, this._cycles, 'beforeRender')\n    }\n\n    protected _doRendered (data: object) {\n        return callIt(this, this._cycles, 'rendered', false, [data])\n    }\n\n    protected _doBeforeUpdate () {\n        return callIt(this, this._cycles, 'beforeUpdate')\n    }\n\n    protected _doUpdated (data: object) {\n        return callIt(this, this._cycles, 'updated', false, [data])\n    }\n\n    protected _doBeforeDestroy () {\n        return callIt(this, this._cycles, 'beforeDestroy', true)\n    }\n\n    protected _doDestroyed () {\n        return callIt(this, this._cycles, 'destroyed', true)\n    }\n}\n","export interface ModelOptions {\n    data: Supplier\n}\n\ntype Supplier = () => any\n\nexport class Model {\n    protected _options: ModelOptions\n    protected _data: any\n\n    constructor(options: ModelOptions | Supplier) {\n        const opt = typeof options === 'function' ? { data: options } : options\n        this._options = opt\n        this.set(opt.data())\n    }\n\n    set (data: any) {\n        this._data = data\n    }\n\n    get () {\n        // clone it or make it readonly in dev mode\n        return this._data\n    }\n}\n","import { ModelOptions, Model } from './model'\nimport { Module } from './module'\n\nexport interface StoreOptions {\n    models?: {[key: string]: ModelOptions}\n    actions?: {[key: string]: (payload: any) => void}\n}\n\nexport class Store {\n    private _options: StoreOptions\n    private _models: {[key: string]: Model} = {}\n    private _names: string[] = []\n    private _module: Module\n\n    constructor(mod: Module, options: StoreOptions, updateKey: string) {\n        this._options = options\n        this._module = mod\n        const {models} = options\n        if (models) {\n            this._names = Object.keys(models)\n            this._names.forEach(k => this._models[k] = new Model(models[k]))\n        }\n\n        if (!options.actions) options.actions = {}\n        options.actions[updateKey] = data => {\n            this.set(data)\n        }\n    }\n\n    fire (name: string, data: any) {\n        this._module.fire(name, data)\n    }\n\n    get models () {\n        return this._models\n    }\n\n    get (name?: string) {\n        if (name) return this._models[name].get()\n\n        return this._names.reduce((acc: {[key: string]: any}, item) => {\n            acc[item] = this._models[item].get()\n            return acc\n        }, {})\n    }\n\n    set (data: object) {\n        this._names.forEach(k => (k in data) && this._models[k].set(data[k]))\n    }\n\n    dispatch (name: string, payload: any): Promise<void> {\n        const {actions} = this._options\n        if (!actions || !actions[name]) return Promise.reject()\n        return Promise.resolve(actions[name].call(this, payload))\n    }\n}\n","import { RenderOptions, Renderable, ComponentState } from './renderable'\nimport { Module } from './module'\nimport { Component } from './template/context'\n\nexport interface ViewOptions extends RenderOptions {\n    helpers?: {[name: string]: (...any) => any},\n    state?: object,\n    components?: {[name: string]: Component}\n}\n\nexport class View extends Renderable<ViewOptions> {\n    _module: Module\n    _state: object = {}\n\n    constructor(mod: Module, options: ViewOptions) {\n        super(mod.app, options, options.template && options.template.createLife(), ...mod.app.options.viewLifecycles)\n        this._module = mod\n    }\n\n    get regions () {\n        return this._module.regions\n    }\n\n    _init () {\n        if (this._options.state) this.set(this._options.state, true)\n        return super._init()\n    }\n\n    get (key?: string) {\n        if (!key) return this._state\n\n        if (this._options.computed && this._options.computed[key]) {\n            return this._options.computed[key](this._state)\n        }\n\n        return this._state[key]\n    }\n\n    set (data: object, silent: boolean = false) {\n        if (silent || this._status !== ComponentState.RENDERED) {\n            Object.assign(this._state, data)\n            return Promise.resolve()\n        }\n\n        this._busy = this._busy\n            .then(() => this._doBeforeUpdate())\n            .then(() => Object.assign(this._state, data))\n            .then(() => this._doCollect(this.get()))\n            .then(d => this._doUpdated(d))\n\n        return this._busy\n    }\n\n    _dispatch (name: string, data: any) {\n        return this._module._dispatch(name, data)\n    }\n}\n","import { Disposable } from './drizzle'\n\ntype Handler = (data: any) => void\n\nexport class Events {\n    _handlers: {[name: string]: Handler[]} = {}\n\n    on (name: string, handler: (data: any) => void): Disposable {\n        if (!this._handlers[name]) this._handlers[name] = []\n        const hs = this._handlers[name]\n\n        if (hs.indexOf(handler) !== -1) return {dispose: () => {}}\n        hs.push(handler)\n\n        return {\n            dispose: () => {\n                const idx = hs.indexOf(handler)\n                if (idx !== -1) hs.splice(idx, 1)\n            }\n        }\n    }\n\n    fire (name: string, data: any) {\n        if (!this._handlers[name]) return\n        const hs = this._handlers[name].slice()\n        hs.forEach(it => it.call(this, data))\n    }\n}\n","import { RenderOptions, Renderable, ComponentState } from './renderable'\nimport { StoreOptions, Store } from './store'\nimport { Application } from './application'\nimport { Loader } from './loader'\nimport { View, ViewOptions } from './view'\nimport { Appendable } from './template/template'\nimport { Events } from './event'\nimport { Disposable } from './drizzle'\n\nexport interface ItemOptions {\n    views?: string[]\n    refs?: string[]\n    modules?: {[name: string]: string}\n}\n\nexport interface ModuleOptions extends RenderOptions {\n    store?: StoreOptions\n    items?: ItemOptions\n}\n\nconst UPDATE_ACTION = `update${+new Date()}`\n\nconst clone = (target: any) => {\n    if (Array.isArray(target)) {\n        return target.map(it => clone(it))\n    }\n    if (typeof target === 'object') {\n        return Object.keys(target).reduce((acc: any, it) => {\n            acc[it] = clone(target[it])\n            return acc\n        }, {})\n    }\n    return target\n}\n\ninterface ModuleRenference {\n    [name: string]: {\n        loader: string,\n        path: string\n        args?: any\n    }\n}\n\nexport const moduleReferences: ModuleRenference = {}\n\nexport class Module extends Renderable<ModuleOptions> implements Events {\n    _items: {[key: string]: {\n        type: 'view' | 'module'\n        options: ModuleOptions | ViewOptions\n        loader: Loader\n    }} = {}\n    _extraState: object\n    _handlers = {}\n\n    private _store: Store\n    private _loader: Loader\n\n    constructor(app: Application, loader: Loader, options: ModuleOptions, extraState: object = {}) {\n        super(app, options, options.template && options.template.createLife(), ...app.options.moduleLifecycles)\n        this._loader = loader\n        this._extraState = extraState\n        this.regions = {}\n    }\n\n    set (data: object) {\n        if (!this._options.template) return\n\n        const {exportedModels} = this._options.template\n        if (!exportedModels || !exportedModels.length) return\n\n        const d = exportedModels.reduce((acc, item) => {\n            if (data[item]) acc[item] = data[item]\n            return acc\n        }, {})\n\n        return this._status === ComponentState.CREATED ?\n            this._store.dispatch(UPDATE_ACTION, d) : this._dispatch(UPDATE_ACTION, d)\n    }\n\n    get (name?: string) {\n        const obj = this._store.get(name)\n\n        // TODO only works in dev mode\n        return clone(obj)\n    }\n\n    _createItem (name: string, state?: object) {\n        const opt = this._items[name]\n        const item = opt.type === 'view' ?\n            new View(this, opt.options) :\n            new Module(this.app, opt.loader, opt.options, state)\n        return item._init().then(() => item)\n    }\n\n    _dispatch (name: string, payload?: any) {\n        this._busy = this._busy\n            .then(() => this._doBeforeUpdate())\n            .then(() => this._store.dispatch(name, payload))\n            .then(() => this._doCollect(this.get()))\n            .then(data => this._doUpdated(data))\n\n        return this._busy\n    }\n\n    _render (target: Appendable) {\n        return super._render(target).then(() => {\n            if (this._status === ComponentState.RENDERED) {\n                const {store} = this._options\n                if (store && store.actions && store.actions.init) {\n                    return this._dispatch('init')\n                }\n            }\n        })\n    }\n\n    _init () {\n        this._store = new Store(this, this._options.store || {}, UPDATE_ACTION)\n        this.set(Object.assign({}, this._extraState))\n        const p = this._loadItems().then(() => super._init())\n        return p\n    }\n\n    on (name: string, handler: (data: any) => void): Disposable {\n        return null\n    }\n\n    fire (name: string, data: any) {\n    }\n\n    private _loadItems (): Promise<any> {\n        const {items} = this._options\n        if (!items) return Promise.resolve()\n\n        let ps: {name: string, type: string, loader: Loader}[] = []\n\n        if (items.views) {\n            ps = ps.concat(items.views.map(it => {\n                return {name: it, type: 'view', loader: this._loader}\n            }))\n        }\n\n        if (items.refs) {\n            ps = ps.concat(items.refs.map(it => {\n                const obj = moduleReferences[it]\n                const loader = this.app.createLoader(obj.path, {name: obj.loader, args: obj.args})\n                return {name: it, type: 'module', loader}\n            }))\n        }\n\n        if (items.modules) {\n            ps = ps.concat(Object.keys(items.modules).map(it => {\n                const path = items.modules[it]\n                const loader = this.app.createLoader(path)\n                return {name: it, type: 'module', loader}\n            }))\n        }\n\n        return Promise.all(ps.map((k, i) => ps[i].loader.load(ps[i].type === 'view' ? ps[i].name : 'index', this)))\n            .then(data => {\n                ps.forEach((p, i) => {\n                    this._items[p.name] = {type: p.type as ('view' | 'module'), loader: p.loader, options: data[i]}\n                })\n            })\n    }\n}\n\nObject.getOwnPropertyNames(Events.prototype).forEach(it => {\n    Module.prototype[it] = Events.prototype[it]\n})\n","import { Loader } from './loader'\nimport { Module, ModuleOptions } from './module'\nimport { createAppendable } from './template/util'\nimport { CustomEvent, CustomHelper, Component } from './template/context'\nimport { Disposable, DrizzlePlugin } from './drizzle'\nimport { Lifecycle } from './lifecycle'\nimport { Events } from './event'\n\nexport interface ApplicationOptions {\n    stages?: string[]\n    scriptRoot?: string\n    container: HTMLElement\n    entry: string | ModuleOptions\n    customEvents?: {[name: string]: CustomEvent}\n    helpers?: {[name: string]: CustomHelper}\n    components?: {[name: string]: Component}\n    moduleLifecycles?: Lifecycle[]\n    viewLifecycles?: Lifecycle[]\n    getResource? (path): Promise<object>\n}\n\ninterface LoaderConstructor {\n    new (app: Application, path: string, args?: any): Loader\n}\n\nconst customEvents: {[name: string]: CustomEvent} = {\n    enter (node: HTMLElement, cb: (any) => void): Disposable {\n        const ee = function (this: HTMLElement, e) {\n            if (e.keyCode !== 13) return\n            e.preventDefault()\n            cb.call(this, e)\n        }\n        node.addEventListener('keypress', ee, false)\n        return {\n            dispose () {\n                node.removeEventListener('keypress', ee, false)\n            }\n        }\n    }\n}\n\nexport class Application extends Events {\n    options: ApplicationOptions\n    loaders: {[name: string]: LoaderConstructor} = {}\n    private _plugins: DrizzlePlugin[] = []\n\n    constructor(options: ApplicationOptions) {\n        super()\n        this.options = Object.assign({\n            stages: ['init', 'template', 'default'],\n            scriptRoot: 'app',\n            entry: 'viewport',\n            helpers: {},\n            components: {},\n            moduleLifecycles: [],\n            viewLifecycles: []\n        }, options)\n\n        this.options.customEvents = Object.assign(customEvents, this.options.customEvents)\n        this.registerLoader(Loader)\n    }\n\n    registerLoader (loader: LoaderConstructor, name: string = 'default') {\n        this.loaders[name] = loader\n    }\n\n    createLoader (path: string, loader?: {name: string, args?: any}): Loader {\n        if (loader) {\n            return new this.loaders[loader.name](this, path, loader.args)\n        }\n        return new this.loaders.default(this, path)\n    }\n\n    use (plugin: DrizzlePlugin) {\n        plugin.init(this)\n        this.options.moduleLifecycles = this.options.moduleLifecycles.concat(plugin.moduleLifecycles)\n        this.options.viewLifecycles = this.options.viewLifecycles.concat(plugin.viewLifecycles)\n        this._plugins.push(plugin)\n    }\n\n    start (): Promise<any> {\n        return this.startViewport().then(item => {\n            this._plugins.forEach(it => it.started(item))\n        })\n    }\n\n    private startViewport () {\n        let loader: Loader\n\n        const {entry, container} = this.options\n        const create = (lo, options) => {\n            const v = new Module(this, lo, options)\n            return v._init().then(() => v._render(createAppendable(container))).then(() => v)\n        }\n        if (typeof entry === 'string') {\n            loader = this.createLoader(entry)\n        } else {\n            return create(this.createLoader(null), entry)\n        }\n\n        return loader.load('index', null).then(opt => create(loader, opt))\n    }\n}\n","const ps: [string, number | string, string[] | number][] = [\n    ['accept', 0, ['form', 'input']],\n    ['accept-charset', 'acceptCharset', ['form']],\n    ['accesskey', 'accessKey', 0],\n    ['action', 0, ['form']],\n    ['align', 0, [\n        'applet', 'caption', 'col', 'colgroup', 'hr', 'iframe',\n        'img', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr']\n    ],\n    ['allowfullscreen', 'allowFullscreen', ['iframe']],\n    ['alt', 0, ['applet', 'area', 'img', 'input']],\n    ['async', 0, ['script']],\n    ['autocomplete', 0, ['form', 'input']],\n    ['autofocus', 0, ['button', 'input', 'keygen', 'select', 'textarea']],\n    ['autoplay', 0, ['audio', 'video']],\n    ['autosave', 0, ['input']],\n    ['bgcolor', 'bgColor', ['body', 'col', 'colgroup', 'marquee', 'table', 'tbody', 'tfoot', 'td', 'th', 'tr']],\n    ['border', 0, ['img', 'object', 'table']],\n    ['buffered', 0, ['audio', 'video']],\n    ['challenge', 0, ['keygen']],\n    ['charset', 0, ['meta', 'script']],\n    ['checked', 0, ['command', 'input']],\n    ['cite', 0, ['blockquote', 'del', 'ins', 'q']],\n    ['class', 'className', 0],\n    ['code', 0, ['applet']],\n    ['codebase', 'codeBase', ['applet']],\n    ['color', 0, ['basefont', 'font', 'hr']],\n    ['cols', 0, ['textarea']],\n    ['colspan', 'colSpan', ['td', 'th']],\n    ['content', 0, ['meta']],\n    ['contenteditable', 'contentEditable', 0],\n    ['contextmenu', 0, 0],\n    ['controls', 0, ['audio', 'video']],\n    ['coords', 0, ['area']],\n    ['data', 0, ['object']],\n    ['datetime', 'dateTime', ['del', 'ins', 'time']],\n    ['default', 0, ['track']],\n    ['defer', 0, ['script']],\n    ['dir', 0, 0],\n    ['dirname', 'dirName', ['input', 'textarea']],\n    ['disabled', 0, ['button', 'command', 'fieldset', 'input', 'keygen', 'optgroup', 'option', 'select', 'textarea']],\n    ['download', 0, ['a', 'area']],\n    ['draggable', 0, 0],\n    ['dropzone', 0, 0],\n    ['enctype', 0, ['form']],\n    ['for', 'htmlFor', ['label', 'output']],\n    ['form', 0, [\n        'button', 'fieldset', 'input', 'keygen', 'label',\n        'meter', 'object', 'output', 'progress', 'select', 'textarea']\n    ],\n    ['formaction', 0, ['input', 'button']],\n    ['headers', 0, ['td', 'th']],\n    ['height', 0, ['canvas', 'embed', 'iframe', 'img', 'input', 'object', 'video']],\n    ['hidden', 0, 0],\n    ['high', 0, ['meter']],\n    ['href', 0, ['a', 'area', 'base', 'link']],\n    ['hreflang', 0, ['a', 'area', 'link']],\n    ['http-equiv', 'httpEquiv', ['meta']],\n    ['icon', 0, ['command']],\n    ['id', 0, 0],\n    ['indeterminate', 0, ['input']],\n    ['ismap', 'isMap', ['img']],\n    ['itemprop', 0, 0],\n    ['keytype', 0, ['keygen']],\n    ['kind', 0, ['track']],\n    ['label', 0, ['track']],\n    ['lang', 0, 0],\n    ['language', 0, ['script']],\n    ['loop', 0, ['audio', 'bgsound', 'marquee', 'video']],\n    ['low', 0, ['meter']],\n    ['manifest', 0, ['html']],\n    ['max', 0, ['input', 'meter', 'progress']],\n    ['maxlength', 'maxLength', ['input', 'textarea']],\n    ['media', 0, ['a', 'area', 'link', 'source', 'style']],\n    ['method', 0, ['form']],\n    ['min', 0, ['input', 'meter']],\n    ['multiple', 0, ['input', 'select']],\n    ['muted', 0, ['audio', 'video']],\n    ['name', 0, [\n        'button', 'form', 'fieldset', 'iframe', 'input', 'keygen',\n        'object', 'output', 'select', 'textarea', 'map', 'meta', 'param']\n    ],\n    ['novalidate', 'noValidate', ['form']],\n    ['open', 0, ['details']],\n    ['optimum', 0, ['meter']],\n    ['pattern', 0, ['input']],\n    ['ping', 0, ['a', 'area']],\n    ['placeholder', 0, ['input', 'textarea']],\n    ['poster', 0, ['video']],\n    ['preload', 0, ['audio', 'video']],\n    ['radiogroup', 0, ['command']],\n    ['readonly', 'readOnly', ['input', 'textarea']],\n    ['rel', 0, ['a', 'area', 'link']],\n    ['required', 0, ['input', 'select', 'textarea']],\n    ['reversed', 0, ['ol']],\n    ['rows', 0, ['textarea']],\n    ['rowspan', 'rowSpan', ['td', 'th']],\n    ['sandbox', 0, ['iframe']],\n    ['scope', 0, ['th']],\n    ['scoped', 0, ['style']],\n    ['seamless', 0, ['iframe']],\n    ['selected', 0, ['option']],\n    ['shape', 0, ['a', 'area']],\n    ['size', 0, ['input', 'select']],\n    ['sizes', 0, ['link', 'img', 'source']],\n    ['span', 0, ['col', 'colgroup']],\n    ['spellcheck', 0, 0],\n    ['src', 0, ['audio', 'embed', 'iframe', 'img', 'input', 'script', 'source', 'track', 'video']],\n    ['srcdoc', 0, ['iframe']],\n    ['srclang', 0, ['track']],\n    ['srcset', 0, ['img']],\n    ['start', 0, ['ol']],\n    ['step', 0, ['input']],\n    ['summary', 0, ['table']],\n    ['tabindex', 'tabIndex', 0],\n    ['target', 0, ['a', 'area', 'base', 'form']],\n    ['title', 0, 0],\n    ['type', 0, ['button', 'command', 'embed', 'object', 'script', 'source', 'style', 'menu']],\n    ['usemap', 'useMap', ['img', 'input', 'object']],\n    ['value', 0, ['button', 'option', 'input', 'li', 'meter', 'progress', 'param', 'select', 'textarea']],\n    ['volume', 0, ['audio', 'video']],\n    ['width', 0, ['canvas', 'embed', 'iframe', 'img', 'input', 'object', 'video']],\n    ['wrap', 0, ['textarea']]\n]\n\ninterface Attr {\n    [key: string]: {name: any, tags: {[key: string]: boolean}}\n}\n\nconst attributes: Attr = ps.reduce((acc: Attr, item) => {\n    acc[item[0]] = {\n        name: item[1],\n        tags: item[2] && (item[2] as string[]).reduce((ac, i) => {\n            ac[i] = true\n            return ac\n        }, {})\n    }\n    return acc\n}, {})\n\n// TODO set style, data set\nexport function setAttribute(el: SVGElement | HTMLElement, name: string, value: any) {\n    const n = name.toLowerCase()\n    const t = el.tagName.toLowerCase()\n    if (attributes[n] && (!attributes[n].tags || attributes[n].tags[t])) {\n        el[attributes[n].name || n] = value\n    } else {\n        el.setAttribute(name, value)\n    }\n}\n","import { Node } from './node'\nimport { setAttribute } from './attributes'\nimport { DataContext, Context } from './context'\n\nexport class StaticNode extends Node {\n    name: string\n    attributes: [string, any][] = []\n\n    constructor(name: string, id?: string) {\n        super(id)\n        this.name = name\n        if (name === 'svg') this.inSvg = true\n    }\n\n    attribute (name: string, value: any) {\n        this.attributes.push([name, value])\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n\n        super.render(context)\n        if (this.element) this.parent.append(this.element)\n        this.children.forEach(it => it.render(context))\n    }\n\n    update (context: DataContext) {\n        this.children.forEach(it => it.update(context))\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        super.destroy(context)\n\n        if (this.element) this.parent.remove(this.element)\n        this.rendered = false\n    }\n\n    create () {\n        const element = this.inSvg ?\n            document.createElementNS('http://www.w3.org/2000/svg', this.name) :\n            document.createElement(this.name)\n        this.attributes.forEach(it =>  setAttribute(element, it[0], it[1]))\n        return element\n    }\n}\n","import { Updatable } from './template'\nimport { DynamicNode } from './dynamic-node'\nimport { getValue, tokenize } from './util'\nimport { DataContext, BindingGroup } from './context'\n\nconst updateSingleKey = (context: DataContext, to: string, value: any) => {\n    const data = context.data\n    if (data._each) {\n        const each = data._each.find(it => it.key === to)\n        if (each) {\n            each.list[each.index] = value\n            context.update({[each.name]: each.list})\n            return\n        }\n    }\n\n    context.update({[to]: value})\n}\n\nexport const updateContext = (context: DataContext, to: string, value: any) => {\n    const ps = tokenize(to)\n    if (ps.length === 1) return updateSingleKey(context, to, value)\n\n    const root = ps.shift()\n    const last = ps.pop()\n    const result = {}\n    let obj\n    let isEach = false\n\n    const data = context.data\n    if (data._each) {\n        const each = data._each.find(it => it.key === root)\n        if (each) {\n            const first = data._each[0]\n            result[first.name] = first.list\n\n            obj = each.list[each.index]\n            isEach = true\n        }\n    }\n\n    if (!isEach) {\n        result[root] = context[root]\n        obj = result[root]\n    }\n\n    result[root] = context[root]\n    obj = ps.reduce((acc, it) => acc[it], obj)\n    obj[last] = value\n    context.update(result)\n}\n\nconst createBinding = <T extends HTMLElement>(\n    context: DataContext, to: string, element: T | Window,\n    event: string, get: (T) => any, set: (T, any) => void\n): Updatable => {\n    let current\n    const obj = {context}\n    const cb = function(this: T) {\n        current = get(element)\n        updateContext(obj.context, to, current)\n    }\n\n    element.addEventListener(event, cb, false)\n\n    const r = {\n        dispose () {\n            element.removeEventListener(event, cb, false)\n        },\n        update (ctx: DataContext) {\n            obj.context = ctx\n            const v = getValue(to, ctx)\n            if (v !== current) {\n                set(element, v)\n                current = v\n            }\n        }\n    }\n\n    r.update(context)\n    return r\n}\n\nconst getSelectValue = (el: HTMLSelectElement) => {\n    const opt = el.options[el.selectedIndex || 0]\n    return opt && opt.value\n}\n\nconst setSelectOption = (el: HTMLSelectElement, value) => {\n    // tslint:disable-next-line:prefer-for-of\n    for (let i = 0; i < el.options.length; i ++) {\n        const opt = el.options[i]\n        if (opt.value === (value + '')) {\n            opt.selected = true\n            return\n        }\n    }\n}\n\nconst bindGroup = (\n    context: DataContext, group: BindingGroup, to: string,\n    element: HTMLInputElement\n): Updatable => {\n    const obj = {context}\n    let current\n    const cb = function(this: HTMLInputElement) {\n        if (group.busy) return\n        current = (group.type === 'radio' ? element.value : group.items\n            .filter(it => (it.element as HTMLInputElement).checked)\n            .map(it => (it.element as HTMLInputElement).value))\n\n        updateContext(obj.context, to, current)\n    }\n\n    element.addEventListener('change', cb, false)\n\n    const r = {\n        dispose () {\n            element.removeEventListener('change', cb, false)\n        },\n        update (ctx: DataContext) {\n            obj.context = ctx\n            if (group.busy) return\n            const v = getValue(to, ctx)\n            const its = group.items.map(it => (it.element as HTMLInputElement))\n\n            let changed = false\n            if (group.type === 'radio' && v !== current) changed = true\n            if (\n                !changed && group.type === 'checkbox' &&\n                (v as any[]).some((it, i) => !current || current[i] !== it)\n            ) changed = true\n            if (!changed) return\n\n            if (group.type === 'radio') {\n                its.forEach(it => it.checked = it.value === v + '')\n                return\n            }\n\n            its.forEach(it => it.checked = (v as any[]).some(vv => vv + '' === it.value))\n        }\n    }\n\n    r.update(context)\n    return r\n}\n\nexport const bind = (node: DynamicNode, context: DataContext, from: string, to: string): Updatable => {\n    const tag = node.name.toLowerCase()\n    const element = node.element\n    if ((tag === 'input' || tag === 'textarea') && from === 'value') {\n        return createBinding(\n            context, to, element, 'input',\n            el => el.value,\n            (el, value) => el.value = value == null ? '' : value\n        )\n    }\n\n    if (tag === 'input' && from === 'checked') {\n        return createBinding(context, to, element, 'change', el => el.checked, (el, value) => el.checked = value)\n    }\n\n    if (tag === 'select' && from === 'value') {\n        return createBinding(context, to, element, 'change', getSelectValue, setSelectOption)\n    }\n\n    if (tag === 'input' && from === 'group') {\n        const type = (element as HTMLInputElement).type\n        if (type !== 'checkbox' && type !== 'radio') return null\n        return bindGroup(context, context.groups[to], to, (element as HTMLInputElement))\n    }\n\n    if (tag === 'window' && from === 'scrollX') {\n        return createBinding(\n            context, to, window, 'scroll',\n            el => el.pageXOffset,\n            (el, value) => el.scrollTo(value, el.pageYOffset)\n        )\n    }\n\n    if (tag === 'window' && from === 'scrollY') {\n        return createBinding(\n            context, to, window, 'scroll',\n            el => el.pageYOffset,\n            (el, value) => el.scrollTo(el.pageXOffset, value)\n        )\n    }\n\n    return null\n}\n","import { StaticNode } from './static-node'\nimport { Helper, DelayHelper } from './helper'\nimport { Disposable } from '../drizzle'\nimport { bind } from './binding'\nimport { Attribute, ChangeType, Updatable } from './template'\nimport { setAttribute } from './attributes'\nimport { resolveEventArgument } from './util'\nimport { ComponentHook, Context, DataContext } from './context'\n\nexport class DynamicNode extends StaticNode {\n    dynamicAttributes: {[name: string]: Helper[]} = {}\n    components: {[name: string]: Helper[]} = {}\n    events: {[event: string]: {method: string, args: Attribute[]}} = {}\n    actions: {[event: string]: {method: string, args: Attribute[]}} = {}\n    bindings: [string, string][] = []\n\n    eventHooks: Disposable[]\n    actionHooks: Disposable[]\n    bindingHooks: Updatable[]\n    componentHooks: [string, ComponentHook][]\n\n    context: DataContext\n\n    dynamicAttribute (name: string, helpers: Helper[]) {\n        this.dynamicAttributes[name] = helpers\n    }\n\n    on (event: string, method: string, args: Attribute[] = []) {\n        this.events[event] = {method, args}\n    }\n\n    action (event: string, method: string, args: Attribute[] = []) {\n        this.actions[event] = {method, args}\n    }\n\n    bind (from: string, to: string) {\n        this.bindings.push([from, to])\n    }\n\n    component (name: string, helpers: Helper[]) {\n        this.components[name] = helpers\n    }\n\n    init (context: Context) {\n        super.init(context)\n\n        this.bindings.forEach(([from, to]) => {\n            if (from !== 'group' || this.name.toLowerCase() !== 'input') return\n            const attr = this.attributes.find(it => it[0].toLowerCase() === 'type')\n            if (!attr) return\n            const type = attr[1].toLowerCase()\n            if (type !== 'checkbox' && type !== 'radio') return\n\n            const groups = context.groups\n            if (!groups[to]) groups[to] = {type, items: [], busy: false}\n            else if (groups[to].type !== type) {\n                throw Error('binding group can not mix up checkbox and radio')\n            }\n            groups[to].items.push(this) // TODO if this item is hidden by if, should it works?\n        })\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        super.render(context)\n        this.updateAttributes(context)\n\n        this.context = context\n        this.eventHooks = Object.keys(this.events).map(it =>\n            this.initEvent(it, this.events[it].method, this.events[it].args)\n        )\n        this.actionHooks = Object.keys(this.actions).map(it =>\n            this.initAction(it, this.actions[it].method, this.actions[it].args)\n        )\n        this.bindingHooks = this.bindings.map(it => bind(this, context, it[0], it[1])).filter(it => !!it)\n\n        this.componentHooks = Object.keys(this.components).map(it => {\n            const fn = context.component(it)\n            if (!fn) {\n                throw new Error(`Component ${it} is not found.`)\n            }\n            const vs = this.renderHelper(context, this.components[it])\n            const hook = fn(this.element, ...vs[1])\n            return [it, hook] as [string, ComponentHook]\n        })\n    }\n\n    initEvent (name: string, method: string, args: Attribute[]): Disposable {\n        const me = this\n        const cb = function(this: HTMLElement, event) {\n            const as = resolveEventArgument(this, me.context, args, event)\n            me.context.trigger(method, ...as)\n        }\n\n        return this.bindEvent(this.element, name, cb)\n    }\n\n    initAction (name: string, action: string, args: Attribute[]): Disposable {\n        const me = this\n        const cb = function(this: HTMLElement, event) {\n            const data = resolveEventArgument(this, me.context, args, event)\n            me.context.dispatch(action, ...data)\n        }\n\n        return this.bindEvent(this.element, name, cb)\n    }\n\n    bindEvent (el: EventTarget, name: string, cb: (event: any) => void): Disposable {\n        const ce = this.context.event(name)\n        if (ce) return ce(el, cb)\n\n        el.addEventListener(name, cb, false)\n        return {\n            dispose: () => {\n                el.removeEventListener(name, cb, false)\n            }\n        }\n    }\n\n    updateAttributes (context: DataContext) {\n        Object.keys(this.dynamicAttributes).forEach(it => {\n            const vs = this.renderHelper(context, this.dynamicAttributes[it])\n            if (vs[0] === ChangeType.CHANGED) {\n                const vvs = vs[1].filter(v => v != null)\n                if (vvs.length === 1) {\n                    setAttribute(this.element, it, vvs[0])\n                } else {\n                    const v = it === 'class' ? vvs.join(' ') : vvs.join('')\n                    setAttribute(this.element, it, v)\n                }\n            }\n        })\n    }\n\n    renderHelper (context: DataContext, helpers: Helper[]) {\n        const vs = helpers.map(it => it.render(context))\n        if (vs.some(i => i[0] === ChangeType.CHANGED)) {\n            return [ChangeType.CHANGED, vs.map(it => it[1])] as [ChangeType, any[]]\n        }\n        return [ChangeType.NOT_CHANGED, null] as [ChangeType, any[]]\n    }\n\n    update (context: DataContext) {\n        if (!this.rendered) return\n\n        this.updateAttributes(context)\n        this.context = context\n        this.bindingHooks.forEach(it => it.update(context))\n        this.children.forEach(it => it.update(context))\n        this.componentHooks.forEach(([name, hook]) => {\n            const vs = this.renderHelper(context, this.components[name])\n            if (vs[0] === ChangeType.NOT_CHANGED) return\n            hook.update(...vs[1])\n        })\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        super.destroy(context)\n\n        this.bindingHooks.forEach(it => it.dispose())\n        this.actionHooks.forEach(it => it.dispose())\n        this.eventHooks.forEach(it => it.dispose())\n        this.componentHooks.forEach(it => it[1].dispose())\n\n        this.bindingHooks = []\n        this.actionHooks = []\n        this.eventHooks = []\n        this.componentHooks = []\n    }\n\n}\n","import { ChangeType } from './template'\nimport { Helper, ConcatHelper } from './helper'\nimport { Node } from './node'\nimport { DataContext, Context } from './context'\n\nclass StaticTextNode extends Node {\n    data: string\n    node: Text\n\n    constructor (data: string = '') {\n        super()\n        this.data = data\n        this.node = document.createTextNode(this.data)\n    }\n\n    init () {}\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n        this.parent.append(this.node)\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        super.destroy(context)\n        this.parent.remove(this.node)\n        this.rendered = false\n    }\n}\n\nclass DynamicTextNode extends StaticTextNode {\n    helper: Helper\n\n    constructor(helper: Helper) {\n        super()\n        this.helper = helper\n    }\n\n    render (context: DataContext) {\n        super.render(context)\n        this.update(context)\n    }\n\n    update (context: DataContext) {\n        const r = this.helper.render(context)\n        if (r[0] === ChangeType.CHANGED) {\n            this.node.data = r[1] == null ? '' : r[1]\n        }\n    }\n\n}\n\nclass HtmlDynamicTextNode extends Node {\n    helper: Helper\n    begin: HTMLElement\n    end: HTMLElement\n\n    constructor(helper: Helper) {\n        super()\n        this.helper = new ConcatHelper(...helper.args)\n    }\n\n    init () {\n        this.begin = document.createElement('noscript')\n        this.end = document.createElement('noscript')\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n        this.parent.append(this.begin)\n        this.parent.append(this.end)\n        this.update(context)\n    }\n\n    update (context: DataContext) {\n        const r = this.helper.render(context)\n        if (r[0] === ChangeType.CHANGED) {\n            this.remove()\n            this.begin.insertAdjacentHTML('afterend', r[1])\n        }\n    }\n\n    remove () {\n        while (this.begin.nextSibling && this.begin.nextSibling !== this.end) {\n            this.begin.parentNode.removeChild(this.begin.nextSibling)\n        }\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        this.rendered = false\n\n        this.remove()\n        this.parent.remove(this.end)\n        this.parent.remove(this.begin)\n    }\n}\n\nexport class TextNode extends Node {\n    nodes: Node[]\n\n    constructor (...args: (string | Helper)[]) {\n        super()\n        this.nodes = args.map(it => {\n            if (typeof it === 'string') return new StaticTextNode(it)\n            if (it.name === 'html') return new HtmlDynamicTextNode(it)\n            return new DynamicTextNode(it)\n        })\n    }\n\n    init (context: Context) {\n        this.nodes.forEach(it => {\n            it.parent = this.parent\n            it.init(context)\n        })\n    }\n\n    render (context: DataContext) {\n        this.nodes.forEach(it => {\n            if (!it.parent) it.parent = this.parent\n            it.render(context)\n        })\n    }\n\n    update (context: DataContext) {\n        this.nodes.forEach(it => it.update(context))\n    }\n\n    destroy (context: Context) {\n        this.nodes.forEach(it => it.destroy(context))\n    }\n\n}\n","import { Node } from './node'\nimport { Attribute } from './template'\nimport { Module } from '../module'\nimport { View } from '../view'\nimport { StaticNode } from './static-node'\nimport { Disposable } from '../drizzle'\nimport { AnchorNode } from './anchor-node'\nimport { getValue, resolveEventArgument } from './util'\nimport { Context, DataContext } from './context'\n\ninterface BindResult {\n    fn: (any) => void\n    event: string\n}\n\nexport class ReferenceNode extends AnchorNode {\n    name: string\n    item: Module | View\n    events: {[event: string]: {method: string, args: Attribute[]}} = {}\n    actions: {[event: string]: {method: string, args: Attribute[]}} = {}\n    mappings: [string, string][] = []\n    grouped: {[name: string]: Node[]} = {}\n    statics: {[name: string]: any} = {}\n\n    hooks: Disposable[] = []\n    context: DataContext\n\n    constructor(name: string, id?: string) {\n        super(id)\n        this.name = name\n    }\n\n    attribute (name: string, value: any) {\n        this.statics[name] = value\n    }\n\n    map (from: string, to?: string) {\n        this.mappings.push([from, to || from])\n    }\n\n    on (event: string, method: string, args: Attribute[]) {\n        this.events[event] = {method, args}\n    }\n\n    action (event: string, method: string, args: Attribute[]) {\n        this.actions[event] = {method, args}\n    }\n\n    init (context: Context) {\n        const fn = (i: Module | View) => {\n            this.item = i\n            if (this.id) context.ref(this.id, i)\n        }\n\n        context.create(this.name, this.statics).then(fn)\n\n        this.children.forEach(it => {\n            let name = 'default'\n            if (it instanceof StaticNode) {\n                const attr = (it.attributes as [string, string][]).find(n => n[0] === 'region')\n                if (attr) name = attr[1]\n            }\n\n            it.init(context)\n            if (!this.grouped[name]) this.grouped[name] = []\n            this.grouped[name].push(it)\n        })\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n\n        super.render(context)\n        context.delay(this.item.set(this.mappings.reduce((acc, item) => {\n            acc[item[1]] = getValue(item[0], context)\n            return acc\n        }, {})))\n\n        // TODO why blocks?\n        this.item._render(this.newParent).then(() => {\n            return Promise.all(Object.keys(this.grouped).map(k => {\n                if (!this.item.regions[k]) return\n                return this.item.regions[k]._showNode(this.grouped[k], context)\n            }).concat(Object.keys(this.item.regions).map(it => {\n                if (!this.grouped[it] || !this.grouped[it].length) return this.item.regions[it]._showChildren()\n            })))\n        })\n\n        this.context = context\n        let cbs = []\n        if (this.item instanceof Module) {\n            const m = this.item\n            cbs = cbs.concat(this.bindEvents(context))\n            cbs = cbs.concat(this.bindActions(context))\n\n            this.hooks = cbs.map(it => m.on(it.event, it.fn))\n        }\n    }\n\n    bindEvents (context: DataContext): BindResult[] {\n        const me = this\n\n        return Object.keys(this.events).map(it => {\n            const cb = function (this: Module, event: any) {\n                const data = resolveEventArgument(this, me.context, me.events[it].args, event)\n                context.trigger(me.events[it].method, ...data)\n            }\n            return {fn: cb, event: it}\n        })\n    }\n\n    bindActions (context: DataContext): BindResult[] {\n        const me = this\n\n        return Object.keys(this.actions).map(it => {\n            const cb = function(this: Module, event: any) {\n                const data = resolveEventArgument(this, me.context, me.actions[it].args, event)\n                context.dispatch(me.actions[it].method, ...data)\n            }\n            return {fn: cb, event: it}\n        })\n    }\n\n    update (context: DataContext) {\n        const p = this.item.set(this.mappings.reduce((acc, item) => {\n            acc[item[1]] = getValue(item[0], context)\n            return acc\n        }, {}))\n        context.delay(p)\n\n        this.context = context\n        this.children.forEach(it => it.update(context))\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        super.destroy(context)\n\n        context.delay(this.item.destroy())\n        this.hooks.forEach(it => it.dispose())\n        this.hooks = []\n        context.delay(Promise.all(Object.keys(this.grouped).map(it => {\n            if (!this.item.regions[it]) return\n            return this.item.regions[it].close()\n        })))\n        this.rendered = false\n    }\n\n}\n","import { Node } from './node'\nimport { Renderable, Region } from '../renderable'\nimport { Context, DataContext } from './context'\nimport { AnchorNode } from './anchor-node'\n\nexport class RegionNode extends AnchorNode {\n    nodes: Node[]\n    item: Renderable<any>\n    context: DataContext\n\n    constructor(id: string = 'default') {\n        super()\n        this.id = id\n    }\n\n    init (context: Context) {\n        context.region(this.id, this.createRegion())\n    }\n\n    render (context: DataContext) {\n        if (this.rendered) return\n        this.rendered = true\n\n        super.render(context)\n        this.context = context\n\n        this.children.forEach(it => {\n            it.parent = this.newParent\n            it.init(context)\n        })\n    }\n\n    update (context: DataContext) {\n        if (!this.rendered) return\n        this.context = context\n\n        if (this.nodes === this.children) this.nodes.forEach(it => it.update(context))\n    }\n\n    destroy (context: Context) {\n        if (!this.rendered) return\n        super.destroy(context)\n        if (this.nodes) this.nodes.forEach(it => it.destroy(context))\n        if (this.item) context.delay(this.item.destroy())\n        this.rendered = false\n    }\n\n    showNode (nodes: Node[], context: DataContext): Promise<any> {\n        if (!this.rendered) return\n        this.context = context\n        return context.end().then(() => this.close().then(() => {\n            this.nodes = nodes\n            this.nodes.forEach(it => {\n                it.parent = this.newParent\n                it.render(context)\n            })\n            return context.end()\n        }))\n    }\n\n    show (name: string, state: object) {\n        if (!this.rendered) return\n        return this.context.end().then(() => this.close().then(() => this.context.create(name, state)).then(item => {\n            this.item = item\n            return item._render(this.newParent).then(() => {\n                return item\n            })\n        }))\n    }\n\n    close (): Promise<any> {\n        if (!this.nodes && !this.item) return Promise.resolve()\n        return Promise.resolve().then(() => {\n            if (this.nodes) {\n                this.nodes.forEach(it => it.destroy(this.context))\n                return this.context.end()\n            }\n        }).then(() => {\n            if (this.item) return this.item.destroy()\n        }).then(() => {\n            this.nodes = null\n            this.item = null\n        })\n    }\n\n    protected createRegion (): Region {\n        const me = this\n        return {\n            get item () {\n                return me.item\n            },\n            show (name: string, state: object): Promise<any> {\n                return me.show(name, state)\n            },\n            _showNode (nodes: Node[], ctx: DataContext): Promise<any> {\n                return me.showNode(nodes, ctx)\n            },\n            _showChildren () {\n                if (!me.context) return Promise.resolve()\n                return me.showNode(me.children, me.context)\n            },\n            close () {\n                return me.close()\n            }\n        }\n    }\n}\n","import { NormalValue } from './template'\nimport { DataContext } from './context'\nimport { getValue, getAttributeValue } from './util'\n\nexport class Transformer {\n    value: string\n    end: NormalValue\n    items: TransformerItem[]\n\n    constructor (value: string, items: TransformerItem[], end?: NormalValue) {\n        this.value = value\n        this.items = items || []\n        this.end = end\n    }\n\n    render (context: DataContext): any {\n        let v = getValue(this.value, context)\n        v = this.items.reduce((acc, item) => item.render(context, acc), v)\n        if (v == null && this.end) {\n            return getAttributeValue(this.end, context)\n        }\n        return v\n    }\n}\n\nexport class TransformerItem {\n    name: string\n    args: NormalValue[]\n\n    constructor(name: string, args: NormalValue[]) {\n        this.name = name\n        this.args = args || []\n    }\n\n    render (context: DataContext, v: any): any {\n        const fn = context.helper(this.name)\n        if (!fn) {\n            throw new Error(`no helper found: ${this.name}`)\n        }\n        const args = this.args.map(it => getAttributeValue(it, context)).concat(v)\n        return fn.apply(null, args)\n    }\n}\n","import { Module } from './module'\nimport { Lifecycle } from './lifecycle'\nimport { View } from './view'\nimport { DrizzlePlugin, Application } from './drizzle'\n\ninterface ActionHandler {\n    action: string\n}\n\ninterface EventHandler {\n    event: string\n}\n\ninterface ModuleHandler {\n    ref: string\n    region?: string\n    model?: string\n}\n\ntype Handler = DefaultHandler | ActionHandler | EventHandler | ModuleHandler | string\n\ninterface RouteOptions {\n    [route: string]: Handler\n}\n\ndeclare module './module' {\n    interface Module {\n        _router?: Router\n    }\n\n    interface ModuleOptions {\n        routes?: RouteOptions\n    }\n}\n\ninterface DefaultHandler {\n    enter (args: object): Promise<Router>\n    update? (args: object): Promise<any>\n    leave? (): Promise<any>\n}\n\ninterface MatchResult {\n    remain: string[]\n    consumed: string\n    args?: object\n}\n\n// /name\nclass Token {\n    protected key: string\n    protected next: Token\n    protected v = 9\n\n    constructor(key: string, next: Token) {\n        this.key = key\n        this.next = next\n    }\n\n    match (keys: string[]): MatchResult | false {\n        const c = keys[0]\n        return this.doMatch(c, keys.slice(1))\n    }\n\n    value (v: number = 0): number {\n        const vv = v + this.v\n        return this.next ? this.next.value(vv * 10) : vv\n    }\n\n    protected doMatch (key: string, keys: string[]): MatchResult | false {\n        if (key !== this.key) return false\n        if (this.next) {\n            const o = this.next.match(keys)\n            if (!o) return false\n            o.consumed = o.consumed ? `${key}/${o.consumed}` : key\n            return o\n        }\n        return {remain: keys, consumed: key}\n    }\n}\n\n// /:name\nclass ArgToken extends Token {\n    v = 8\n    doMatch (key: string, keys: string[]): MatchResult | false {\n        const oo = {[this.key]: key}\n        if (!this.next) return {remain: keys, args: oo, consumed: key}\n\n        const o = this.next.match(keys)\n        if (o === false) return false\n\n        o.args ? Object.assign(o.args, oo) : (o.args = oo)\n        if (key && o.consumed) o.consumed = `${key}/${o.consumed}`\n        else if (key) o.consumed = key\n        return o\n    }\n}\n\n// /*name\nclass AllToken extends Token {\n    v = 7\n    match (keys: string[]): MatchResult | false {\n        if (!keys.length) return false\n        return { args: {[this.key]: keys}, remain: [], consumed: keys.join('/')}\n    }\n}\n\nconst create = (path) => {\n    const ts = path.trim().split('/').filter(it => !!it)\n    return ts.reduceRight((acc, item) => {\n        if (item.charAt(0) === '*') return new AllToken(item.slice(1), acc)\n        if (item.charAt(0) === ':') return new ArgToken(item.slice(1), acc)\n        return new Token(item, acc)\n    }, null)\n}\n\nclass Router {\n    _prefix: string\n\n    private _module: Module\n    private _keys: Token[] = []\n    private _defs: DefaultHandler[] = []\n    private _currentKey: number = -1\n    private _next: Router\n    private _previous: string[]\n\n    constructor (module: Module, routes: RouteOptions, prefix: string = '#/') {\n        this._module = module\n        this._prefix = prefix\n        this.initRoutes(routes)\n    }\n\n    route (keys: string[]) {\n        for (let i = 0; i < this._keys.length; i ++) {\n            const re = this._keys[i].match(keys)\n            if (re) {\n                return this.doRoute(i, re).then(d => {\n                    this._previous = keys\n                    return d\n                })\n            }\n        }\n        return Promise.resolve(false)\n    }\n\n    private leave (): Promise<any> {\n        this._previous = undefined\n        return Promise.resolve().then(() => {\n            if (this._next) return this._next.leave()\n        }).then(() => {\n            const h = this._defs[this._currentKey]\n            if (h && h.leave) return h.leave()\n        })\n    }\n\n    private enter (idx: number, result: MatchResult) {\n        this._currentKey = idx\n        const o = Object.assign({_router_prefix: `${this._prefix}${result.consumed}/`}, result.args)\n        return this._defs[idx].enter(o).then(it => {\n            this._next = it\n            if (it) return it.route(result.remain)\n        })\n    }\n\n    private doRoute (idx: number, result: MatchResult): Promise<any> {\n        const h = this._defs[idx]\n        if (this._currentKey === -1) {\n            return this.enter(idx, result)\n        }\n        if (idx === this._currentKey) {\n            return Promise.resolve().then(() => {\n                if (h.update) return h.update(result.args)\n            }).then(() => {\n                if (this._next) return this._next.route(result.remain)\n            })\n        }\n\n        return this.leave().then(() => {\n            return this.enter(idx, result)\n        })\n    }\n\n    private initRoutes (routes: RouteOptions) {\n        Object.keys(routes).map(key => {\n            return { key, token: create(key) }\n        }).sort((a, b) => b.token.value() - a.token.value()).forEach(it => {\n            this._keys.push(it.token)\n            this._defs.push(this.createHandler(routes[it.key]))\n        })\n    }\n\n    private createHandler (h: Handler): DefaultHandler {\n        if (typeof h === 'string') return this.createModuleHandler({ref: h})\n        if ('enter' in h) return h as DefaultHandler\n        if ('action' in h) return this.createActionHandler(h as ActionHandler)\n        if ('event' in h) return this.createEventHandler(h as EventHandler)\n        if ('ref' in h) return this.createModuleHandler(h as ModuleHandler)\n        throw new Error('unsupported router handler')\n    }\n\n    private createActionHandler (h: ActionHandler) {\n        return {\n            enter: (args: object) => {\n                return this._module._dispatch(h.action, args).then(() => null)\n            },\n            update: (args: object) => {\n                return this._module._dispatch(h.action, args)\n            }\n        }\n    }\n\n    private createEventHandler (h: EventHandler) {\n        return {\n            enter: (args: object) => {\n                this._module._event(h.event, args, this._previous)\n                return Promise.resolve(null)\n            },\n            update: (args: object) => {\n                this._module._event(h.event, args, this._previous)\n                return Promise.resolve()\n            }\n        }\n    }\n\n    private createModuleHandler (h: ModuleHandler) {\n        let item\n        return {\n            enter: (args: object) => {\n                const o = h.model ? {[h.model]: args} : args\n                return this._module.regions[h.region || 'default'].show(h.ref, o).then(it => {\n                    item = it\n                    if (it instanceof Module) return it._router\n                    return null\n                })\n            },\n\n            update: (args: object) => {\n                if (!args) return Promise.resolve()\n                const o = h.model ? {[h.model]: args} : args\n                if (item && (item instanceof Module)) return item.set(o)\n                return Promise.resolve()\n            }\n        }\n    }\n}\n\nconst RouterModuleLifecycle: Lifecycle = {\n    stage: 'init',\n    init (this: Module) {\n        const {routes} = this._options\n        if (!routes) return\n        const prefix = (this._extraState as any)._router_prefix\n        this._router = new Router(this, routes, prefix)\n    },\n\n    collect (this: Module, data: object): object {\n        const r = this._router\n        if (r) data['@router'] = r._prefix\n        return data\n    }\n}\n\nconst RouterViewLifecycle: Lifecycle = {\n    collect (this: View, data: object): object {\n        const r = this._module._router\n        if (r) data['@router'] = r._prefix\n        return data\n    }\n}\n\nexport const RouterPlugin: DrizzlePlugin = {\n    moduleLifecycles: [RouterModuleLifecycle],\n    viewLifecycles: [RouterViewLifecycle],\n\n    init (app: Application) {\n\n    },\n\n    started (item: Module) {\n        const router = item._router\n        if (!router) return\n        const doIt = () => {\n            const hash = window.location.hash\n            if (hash.slice(0, 2) !== '#/') return\n            const hs = hash.slice(2).split('/').filter(it => !!it)\n            if (!hs.length) return\n            router.route(hs).then(it => {\n                console.log(it)\n            })\n        }\n\n        window.addEventListener('popstate', doIt)\n        doIt()\n    }\n}\n","import { DynamicNode } from './dynamic-node'\nimport { Disposable } from '../drizzle'\nimport { AbstractDataContext } from './context'\n\nexport class WindowNode extends DynamicNode {\n    constructor (id?: string) {\n        super('window', id)\n        this.children = []\n    }\n\n    init () {}\n    dynamicAttribute () {}\n    component () {}\n\n    bind (from: string, to: string) {\n        if (from !== 'scrollX' && from !== 'scrollY') {\n            throw new Error('Can only bind scrollX and scrollY on window object')\n        }\n        super.bind(from, to)\n    }\n\n    bindEvent (el: EventTarget, name: string, cb: (event: any) => void): Disposable {\n        return super.bindEvent(window, name, cb)\n    }\n}\n\nexport class ApplicationNode extends DynamicNode {\n    constructor (id?: string) {\n        super('app', id)\n        this.children = []\n    }\n\n    init () {}\n    dynamicAttribute () {}\n    component () {}\n    bind () {}\n\n    bindEvent (el: EventTarget, name: string, cb: (event: any) => void): Disposable {\n        return (this.context as AbstractDataContext).root.app.on(name, cb)\n    }\n}\n","import {\n    IfHelper, UnlessHelper, Helper, DelayHelper, EchoHelper\n} from './template/helper'\nimport { IfBlock, UnlessBlock } from './template/if-block'\nimport { EachBlock } from './template/each-block'\nimport { Loader } from './loader'\nimport {\n    Attribute, AttributeValue, ModuleTemplate,\n    ViewTemplate, NormalValue, ValueType,\n} from './template/template'\nimport { Application } from './application'\nimport { StaticNode } from './template/static-node'\nimport { DynamicNode } from './template/dynamic-node'\nimport { TextNode } from './template/text-node'\nimport { ReferenceNode } from './template/reference-node'\nimport { RegionNode } from './template/region-node'\nimport { Node } from './template/node'\nimport { TransformerItem, Transformer } from './template/transformer'\nimport { Lifecycle } from './lifecycle'\nimport { Module } from './module'\nimport { RouterPlugin } from './route'\nimport { WindowNode, ApplicationNode } from './template/special-nodes'\n\nexport interface Disposable {\n    dispose (): void\n}\n\nconst innerHelpers = {\n    if: IfHelper, unless: UnlessHelper\n}\n\ninterface NodeConstructor {\n    new (id?: string): DynamicNode\n}\n\nconst nodes: {[name: string]: NodeConstructor} = {\n    window: WindowNode,\n    app: ApplicationNode\n}\n\nfunction createNode(name: string, id?: string): DynamicNode | undefined {\n    if (nodes[name]) return new nodes[name](id)\n}\n\ninterface RegionConstructor {\n    new (id: string): RegionNode\n}\n\nconst regions: {[name: string]: RegionConstructor} = {\n}\n\nfunction createRegion(name: string, id: string): RegionNode | undefined {\n    if (regions[name]) return new regions[name](id)\n}\n\n// nodes\nconst SN = (name: string, id?: string) => {\n    const node = createNode(name, id)\n    return node ? node : new StaticNode(name, id)\n}\nconst DN = (name: string, id?: string) => {\n    const node = createNode(name, id)\n    return node ? node : new DynamicNode(name, id)\n}\nconst REF = (name: string, id?: string) => new ReferenceNode(name, id)\nconst TX = (...ss: (string | Helper)[]) => new TextNode(...ss)\nconst RG = (name: string, id: string = 'default') => {\n    const region = createRegion(name, id)\n    return region ? region : new RegionNode(id)\n}\n\n// node attribute\nconst SA = (d: StaticNode | DynamicNode | ReferenceNode, name: string, value: any) => {\n    d.attribute(name, value)\n}\nconst DA = (d: DynamicNode, name: string, ...hs: Helper[]) => d.dynamicAttribute(name, hs)\nconst BD = (d: DynamicNode, from: string, to: string) => d.bind(from, to)\nconst MP = (d: ReferenceNode, from: string, to?: string) => d.map(from, to)\nconst EV = (d: DynamicNode | ReferenceNode, event: string, method: string, ...attrs: Attribute[]) => {\n    d.on(event, method, attrs)\n}\nconst AC = (d: DynamicNode | ReferenceNode, event: string, method: string, ...attrs: Attribute[]) => {\n    d.action(event, method, attrs)\n}\nconst CO = (d: DynamicNode, name: string, ...hs: Helper[]) => d.component(name, hs)\nconst C = (parent: Node, ...children: Node[]) => parent.setChildren(children)\n\n// attributes\nconst TI = (name: string, ...args: NormalValue[]) => new TransformerItem(name, args)\n\nconst TV = (value: string, end?: NormalValue, ...items: TransformerItem[]) =>\n    [ValueType.TRANSFORMER, new Transformer(value, items, end)] as AttributeValue\nconst SV = (v: string) => [ValueType.STATIC, v] as NormalValue\nconst DV = (v: string) => [ValueType.DYNAMIC, v] as NormalValue\nconst AT = (n: string, v: AttributeValue) => [n, v] as Attribute\n\n// helpers\nconst H = (n: string | AttributeValue) => Array.isArray(n) ? new EchoHelper(n) : new EchoHelper(DV(n))\nconst HH = (n: string, ...args: AttributeValue[]) => {\n    if (innerHelpers[n]) return new innerHelpers[n](...args)\n    return new DelayHelper(n, ...args)\n}\n\n// block\nconst EACH = (args: string[], trueNode: () => Node, falseNode?: Node) => new EachBlock(args, trueNode, falseNode)\nconst IF = (args: AttributeValue[], trueNode: Node, falseNode?: Node) => new IfBlock(args, trueNode, falseNode)\nconst UN = (n: string, trueNode: Node, falseNode?: Node) => new UnlessBlock([DV(n)], trueNode, falseNode)\n\nexport const factory = {\n    SN, DN, TX, RG, REF, SV, DV, AT, H, HH,\n    EACH, IF, UN, C, SA, DA, BD, EV, AC, CO, TI, TV, MP\n}\n\nexport {\n    ModuleTemplate, ViewTemplate, Application, Loader, RouterPlugin\n}\n\nexport function registerNode(name: string, type: NodeConstructor) {\n    nodes[name] = type\n}\n\nexport function registerRegion(name: string, type: RegionConstructor) {\n    regions[name] = type\n}\n\nexport interface DrizzlePlugin {\n    moduleLifecycles: Lifecycle[]\n    viewLifecycles: Lifecycle[]\n    init (app: Application): void\n    started (item: Module): void\n}\n"],"names":["ValueType","ChangeType","AbstractDataContext","root","data","groups","busy","this","_options","_file","set","name","args","_event","_action","id","node","ids","region","regions","p","push","slice","Promise","all","ce","customEvents","app","options","c","computed","ViewDataContext","state","_module","_createItem","delay","h","helpers","components","ModuleDataContext","i","Template","me","o","nodes","creator","context","create","forEach","it","idx","nextSibling","init","end","parent","_this","_target","render","update","destroy","ViewTemplate","ModuleTemplate","exportedModels","tokenize","input","token","result","inString","length","t","getValue","key","ks","first","shift","ctx","reduce","acc","item","getAttributeValue","attr","STATIC","DYNAMIC","resolveEventArgument","event","Object","assign","sub","obj","keys","value","createAppendable","target","remove","el","removeChild","append","appendChild","before","anchor","insertBefore","ComponentState","Node","element","a","children","ref","inSvg","setToSvg","AnchorNode","MNode","newParent","document","createComment","getPrototypeOf","constructor","Compare","v1","v2","IfBlock","trueNode","falseNode","useSingle","useCompare","Error","op","rendered","current","use","UnlessBlock","Helper","check","renderIt","CHANGED","NOT_CHANGED","numbers","some","join","_this2","doRender","DelayHelper","fn","helper","apply","map","_this4","arg","EchoHelper","ConcatHelper","_this7","IfHelper","assertCount","assertDynamic","useMultiple","UnlessHelper","EachBlock","list","Array","isArray","_each","v","index","isEmpty","renderElse","kv","renderKeyValue","n","then","arr","currentSize","createTrueNode","empty","updateKeyValue","updateElse","_this3","pop","Loader","path","_app","_path","_args","file","mod","getResource","scriptRoot","callIt","cycles","method","reverse","filter","resolve","LifecycleContainer","cs","stage","stages","s","_cycles","collect","call","Renderable","CREATED","_status","INITED","_busy","_doBeforeRender","_doCollect","get","_doRendered","RENDERED","_doBeforeDestroy","_doDestroyed","_doInit","events","actions","d","_this5","_dispatch","Model","opt","_data","Store","updateKey","models","_names","_models","k","fire","payload","reject","View","template","createLife","viewLifecycles","_state","_doBeforeUpdate","_doUpdated","Events","handler","_handlers","hs","indexOf","dispose","splice","UPDATE_ACTION","Date","moduleReferences","Module","loader","extraState","moduleLifecycles","_loader","_extraState","_store","dispatch","clone","_items","type","_init","babelHelpers.get","store","_loadItems","items","ps","views","concat","refs","createLoader","modules","load","getOwnPropertyNames","prototype","cb","ee","e","keyCode","preventDefault","addEventListener","removeEventListener","Application","registerLoader","loaders","default","plugin","_plugins","startViewport","started","entry","container","lo","_render","attributes","ac","setAttribute","toLowerCase","tagName","tags","StaticNode","createElementNS","createElement","updateContext","to","each","find","updateSingleKey","last","isEach","createBinding","r","getSelectValue","selectedIndex","setSelectOption","selected","bind","from","tag","checked","window","pageXOffset","scrollTo","pageYOffset","group","its","changed","vv","bindGroup","DynamicNode","dynamicAttributes","bindings","updateAttributes","eventHooks","initEvent","actionHooks","initAction","bindingHooks","componentHooks","component","vs","renderHelper","bindEvent","as","trigger","action","vvs","hook","StaticTextNode","createTextNode","DynamicTextNode","HtmlDynamicTextNode","begin","insertAdjacentHTML","parentNode","TextNode","_this6","ReferenceNode","statics","mappings","grouped","_showNode","_showChildren","cbs","m","bindEvents","bindActions","hooks","on","close","RegionNode","createRegion","show","showNode","Transformer","TransformerItem","Token","next","doMatch","match","consumed","remain","ArgToken","oo","AllToken","Router","module","routes","prefix","_prefix","initRoutes","_keys","re","doRoute","_previous","undefined","_next","leave","_defs","_currentKey","_router_prefix","enter","route","trim","split","reduceRight","charAt","sort","b","createHandler","createModuleHandler","createActionHandler","createEventHandler","_this8","_this9","model","_this10","_router","RouterPlugin","router","doIt","hash","location","log","WindowNode","ApplicationNode","innerHelpers","unless","createNode","DV","factory","DN","TX","ss","RG","REF","SV","AT","H","HH","IF","UN","C","setChildren","SA","attribute","DA","dynamicAttribute","BD","EV","attrs","AC","CO","TI","TV","TRANSFORMER","MP"],"mappings":"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"}