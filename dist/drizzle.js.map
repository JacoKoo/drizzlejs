{"version":3,"file":"drizzle.js","sources":["../src/template/node.ts","../src/template/template.ts","../src/template/helper.ts","../src/template/if-block.ts","../src/template/each-block.ts","../src/template/static-node.ts","../src/lifecycle.ts","../src/renderable.ts","../src/view.ts","../src/template/binding.ts","../src/template/dynamic-node.ts","../src/model.ts","../src/store.ts","../src/module.ts","../src/template/reference-node.ts","../src/template/region-node.ts","../src/loader.ts","../src/template/module-template.ts","../src/template/view-template.ts","../src/application.ts","../src/drizzle.ts"],"sourcesContent":["import { Renderable, RenderOptions } from '../renderable'\nimport { Delay } from './template'\n\nexport abstract class Node {\n    root: Renderable<RenderOptions>\n    id: string\n    element: HTMLElement\n    parent: Node\n    children: Node[] = []\n    nextSibling: Node\n    rendered: boolean = false\n\n    constructor(id?: string) {\n        this.id = id\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        this.element = this.create()\n        if (this.id) root.ids[this.id] = this.element\n        this.children.forEach(it => it.init(root, delay))\n    }\n\n    render (context: object, delay: Delay) {\n    }\n\n    update (context: object, delay: Delay) {\n    }\n\n    destroy (delay: Delay) {\n        if (this.id) delete this.root.ids[this.id]\n        this.children.forEach(it => it.destroy(delay))\n    }\n\n    setChildren (children: Node[]) {\n        this.children = children\n        children.forEach((it, i) => {\n            it.nextSibling = children[i + 1]\n            it.parent = this\n        })\n    }\n\n    abstract create (): HTMLElement\n}\n\nexport class FakeNode extends Node {\n    constructor(el: HTMLElement) {\n        super()\n        this.element = el\n    }\n\n    init () {\n    }\n\n    create () {\n        return this.element\n    }\n}\n","import { Disposable } from '../drizzle'\nimport { Node, FakeNode } from './node'\nimport { Renderable } from '../renderable'\nimport { Lifecycle } from '../lifecycle'\n\ntype StaticValue = string | number | boolean\ntype DynamicValue = string\n\nexport enum ValueType { STATIC, DYNAMIC }\nexport enum ChangeType { CHANGED, NOT_CHANGED }\n\nexport type AttributeValue = [ValueType.STATIC, StaticValue] | [ValueType.DYNAMIC, DynamicValue]\nexport type Attribute = [string, AttributeValue]\n\nexport type HelperResult = [ChangeType, any]\n\nexport interface Updatable extends Disposable {\n    update (context: object): void\n}\n\nexport class Delay {\n    static also (fn: (Delay) => void) {\n        const d = new Delay()\n        fn(d)\n        return d.execute()\n    }\n\n    delays: Promise<any>[] = []\n\n    add (p: Promise<any>) {\n        this.delays.push(p)\n    }\n\n    execute () {\n        return Promise.all(this.delays)\n    }\n}\n\nexport function getValue (key: string, context: object): any {\n    return key.split('.').reduce((acc, item) => {\n        if (acc == null) return null\n        return acc[item]\n    }, context)\n}\n\nexport function resolveEventArgument (me: any, context: object, args: Attribute[], event: any): any[] {\n    const values = args.map(([name, v]) => {\n        if (v[0] === ValueType.STATIC) return v[1]\n        const it = v[1] as string\n        if (it === 'event') return event\n        if (it === 'this') return me\n        if (it.slice(0, 6) === 'event.') return event[it.slice(6)]\n        if (it.slice(0, 5) === 'this.') return me[it.slice(5)]\n        return getValue(it, context)\n    })\n\n    const obj = {}\n    const result = [obj]\n\n    args.forEach(([name, v], i) => {\n        if (name) {\n            obj[name] = values[i]\n            return\n        }\n\n        if (v[0] === ValueType.STATIC) {\n            result.push(values[i])\n            return\n        }\n\n        const ns = (v[1] as string).split('.')\n        obj[ns[ns.length - 1]] = values[i]\n    })\n\n    return result\n}\n\nexport const customEvents = {\n    enter (node: HTMLElement, cb: (any) => void): Disposable {\n        const ee = e => {\n            if (e.keyCode !== 13) return\n            e.preventDefault()\n            cb(e)\n        }\n\n        node.addEventListener('keypress', ee, false)\n\n        return {\n            dispose () {\n                node.removeEventListener('keypress', ee, false)\n            }\n        }\n    }\n}\n\nexport abstract class Template<T extends Renderable<any>> {\n    life: Lifecycle\n    nodes: Node[]\n    root: T\n\n    init (root: T, delay: Delay) {\n        this.root = root\n        this.nodes.forEach(it => it.init(root, delay))\n    }\n\n    render (context: object, delay: Delay) {\n        const container = new FakeNode(this.root._element)\n        const next = this.root._nextSibling && new FakeNode(this.root._nextSibling)\n        this.nodes.forEach(it => {\n            it.parent = container\n            it.nextSibling = next\n            it.render(context, delay)\n        })\n    }\n\n    update (context: object, delay: Delay) {\n        this.nodes.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        this.nodes.forEach(it => {\n            it.destroy(delay)\n            it.nextSibling = null\n            it.parent = null\n        })\n    }\n}\n","import { HelperResult, ChangeType } from './template'\nimport { getValue, AttributeValue, ValueType } from './template'\n\nexport abstract class Helper {\n    name: string = ''\n    args: AttributeValue[]\n    dynamicKeys: string[]\n    currentKeys: string[]\n    currentValues: string[]\n\n    constructor (...args: AttributeValue[]) {\n        this.args = args\n        this.dynamicKeys = args.filter(it => it[0] === ValueType.DYNAMIC).map(it => it[1] as string)\n        this.check()\n    }\n\n    render (context: object): HelperResult {\n        if (!this.currentValues) return [ChangeType.CHANGED, this.renderIt(context)]\n\n        const vs = this.currentKeys.map(it => getValue(it, context))\n        if (vs.some((it, i) => it !== this.currentValues[i])) {\n            return [ChangeType.CHANGED, this.renderIt(context)]\n        }\n\n        return [ChangeType.NOT_CHANGED, undefined]\n    }\n\n    arg (idx: number, context: object): any {\n        const arg = this.args[idx]\n        if (!arg) return ''\n        if (arg[0] === ValueType.STATIC) return arg[1]\n        return this.key(arg[1] as string, context)\n    }\n\n    key (key: string, context: object): any {\n        this.currentKeys.push(key)\n        const v = getValue(key, context)\n        this.currentValues.push(v)\n        return v\n    }\n\n    check () {}\n\n    assertCount (...numbers: number[]) {\n        if (!numbers.some(it => it === this.args.length)) {\n            throw new Error(`${name} helper should have ${numbers.join(' or ')} arguments`)\n        }\n    }\n\n    assertDynamic (...numbers: number[]) {\n        numbers.forEach(it => {\n            if (this.args[it][0] !== ValueType.DYNAMIC) {\n                throw new Error(`the ${it}th argument of ${name} helper should be dynamic`)\n            }\n        })\n    }\n\n    abstract doRender (context: object): any\n\n    private renderIt (context: object): any {\n        this.currentKeys = []\n        this.currentValues = []\n        return this.doRender(context)\n    }\n}\n\nexport class Transfromer extends Helper {\n    fn: (...args: any[]) => any\n\n    constructor(fn: (...args: any[]) => any, ...args: AttributeValue[]) {\n        super(...args)\n        this.fn = fn\n    }\n\n    doRender (context: object): any {\n        return this.fn.apply(null, this.args.map((it, i) => this.arg(i, context)))\n    }\n}\n\nexport class ConcatHelper extends Helper {\n    name = 'concat'\n\n    check () {\n        this.currentKeys = this.dynamicKeys\n    }\n\n    doRender (context: object): any {\n        return this.args.map((it, i) => this.arg(i, context)).join(' ')\n    }\n}\n\nexport class IfHelper extends Helper {\n    name = 'if'\n\n    check () {\n        this.assertCount(2, 3)\n        this.assertDynamic(0)\n    }\n\n    doRender (context: object): any {\n        return this.arg(this.use(context), context)\n    }\n\n    use (context: object): number {\n        return this.key(this.dynamicKeys[0], context) ? 1 : 2\n    }\n}\n\nexport class UnlessHelper extends IfHelper {\n    name = 'unless'\n\n    use (context: object): number {\n        return this.key(this.dynamicKeys[0], context) ? 2 : 1\n    }\n}\n\nexport class EqHelper extends Helper {\n    name: 'eq'\n\n    check () {\n        this.assertCount(3, 4)\n    }\n\n    doRender (context: object): any {\n        return this.arg(this.use(this.arg(0, context), this.arg(1, context)) ? 2 : 3, context)\n    }\n\n    use (v1: any, v2: any): boolean {\n        return v1 === v2\n    }\n}\n\nexport class GtHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 > v2\n    }\n}\n\nexport class GteHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 >= v2\n    }\n}\n\nexport class LtHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 < v2\n    }\n}\n\nexport class LteHelper extends EqHelper {\n    use (v1: any, v2: any): boolean {\n        return v1 <= v2\n    }\n}\n","import { Node } from './node'\nimport { Renderable } from '../renderable'\nimport { Delay, getValue, AttributeValue, ValueType } from './template'\n\nexport class IfBlock extends Node {\n    args: string[]\n    trueNode: Node\n    falseNode?: Node\n    current: Node\n\n    constructor (args: string[], trueNode: Node, falseNode?: Node) {\n        super()\n        this.trueNode = trueNode\n        this.falseNode = falseNode\n        this.args = args\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        this.trueNode.nextSibling = this.nextSibling\n        this.trueNode.init(root, delay)\n        if (this.falseNode) {\n            this.falseNode.nextSibling = this.nextSibling\n            this.falseNode.init(root, delay)\n        }\n    }\n\n    use (context: object): boolean {\n        return !!getValue(this.args[0], context)\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        this.rendered = true\n        this.current = this.use(context) ? this.trueNode : this.falseNode\n\n        if (this.current) {\n            this.current.render(context, delay)\n        }\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n\n        const use = this.use(context) ? this.trueNode : this.falseNode\n        if (use === this.current) {\n            if (use) use.update(context, delay)\n            return\n        }\n\n        this.current = use === this.trueNode ? this.trueNode : this.falseNode\n        use.destroy(delay)\n        if (this.current) this.current.render(context, delay)\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        if (this.current) this.current.destroy(delay)\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n\nexport class UnlessBlock extends IfBlock {\n    use (context: any): boolean {\n        return !getValue(this.args[0], context)\n    }\n}\n\nexport class EqBlock extends IfBlock {\n    args2: AttributeValue[]\n\n    constructor (args: AttributeValue[], trueNode: Node, falseNode?: Node) {\n        super([], trueNode, falseNode)\n        this.args2 = args\n    }\n\n    getValue2 (arg: AttributeValue, context) {\n        if (arg[0] === ValueType.STATIC) return arg[1]\n        return getValue(arg[1] as string, context)\n    }\n\n    use (context: object): boolean {\n        return this.use2(this.getValue2(this.args2[0], context), this.getValue2(this.args2[1], context))\n    }\n\n    use2 (v1: any, v2: any): boolean {\n        return v1 === v2\n    }\n}\n\nexport class GtBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 > v2\n    }\n}\n\nexport class GteBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 >= v2\n    }\n}\n\nexport class LtBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 < v2\n    }\n}\n\nexport class LteBlock extends EqBlock {\n    use2 (v1: any, v2: any): boolean {\n        return v1 <= v2\n    }\n}\n","import { Node } from './node'\nimport { Renderable } from '../renderable'\nimport { getValue, Delay } from './template'\n\nexport class EachBlock extends Node {\n    args: string[]\n    trueNode: () => Node\n    falseNode?: Node\n    currentSize = 0\n    nodes: Node[]\n\n    constructor (args: string[], trueNode: () => Node, falseNode?: Node) {\n        super()\n        this.trueNode = trueNode\n        this.falseNode = falseNode\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        if (this.falseNode) this.falseNode.nextSibling = this.nextSibling\n    }\n\n    isEmpty (list: any): boolean {\n        return !list || (Array.isArray(list) && !list.length) || (typeof list === 'object' && !Object.keys(list))\n    }\n\n    sub (context: {[key: string]: any}, i: number | string) {\n        const o = Object.assign({}, context)\n        if (!o._each) o._each = []\n        o._each.push({list: context[this.args[0]], index: i, key: this.args[2]})\n\n        o[this.args[2]] = context[this.args[0]][i]\n        if (this.args[3]) o[this.args[3]] = i\n        return o\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n\n        this.rendered = true\n        const list = getValue(this.args[0], context)\n        if (this.isEmpty(list)) {\n            this.renderElse(context, delay)\n            return\n        }\n\n        const kv = Array.isArray(list) ?\n            list.map((it, i) => [i, it]) as [any, any] :\n            Object.keys(list).map(it => [it, list[it]] as [any, any])\n\n        this.renderKeyValue(kv, context, delay)\n    }\n\n    renderKeyValue (arr: [any, any][], context: object, delay: Delay) {\n        this.currentSize = arr.length\n        arr.forEach((it, i) => {\n            const sub = this.sub(context, i)\n            this.nodes[i] = this.trueNode()\n            this.nodes[i].nextSibling = this.nextSibling\n            this.nodes[i].init(this.root, delay)\n            this.nodes[i].render(sub, delay)\n        })\n    }\n\n    renderElse (context: object, delay: Delay) {\n        if (!this.falseNode) return\n        this.falseNode.init(this.root, delay)\n        this.falseNode.render(context, delay)\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n\n        const list = getValue(this.args[0], context)\n        const empty = this.isEmpty(list)\n        if (empty && !this.currentSize) {\n            this.updateElse(context, delay)\n            return\n        }\n\n        if (empty) {\n            this.currentSize = 0\n            this.nodes.forEach(it => it.destroy(delay))\n            this.nodes = []\n\n            this.renderElse(context, delay)\n            return\n        }\n\n        const kv = Array.isArray(list) ?\n            list.map((it, i) => [i, it] as [any, any]) :\n            Object.keys(list).map(it => [it, list[it]] as [any, any])\n\n        this.updateKeyValue(kv, context, delay)\n    }\n\n    updateElse (context: object, delay: Delay) {\n        if (this.falseNode) this.falseNode.update(context, delay)\n    }\n\n    updateKeyValue (arr: [any, any][], context: object, delay: Delay) {\n        this.currentSize = arr.length\n        arr.forEach((it, i) => {\n            const sub = this.sub(context, i)\n\n            if (this.nodes[i]) this.nodes[i].update(sub, delay)\n            else {\n                this.nodes[i] = this.trueNode()\n                this.nodes[i].nextSibling = this.nextSibling\n                this.nodes[i].init(this.root, delay)\n                this.nodes[i].render(sub, delay)\n            }\n        })\n\n        while (this.nodes.length !== this.currentSize) {\n            const node = this.nodes.pop()\n            node.destroy(delay)\n        }\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n\n        if (!this.currentSize) {\n            if (this.falseNode) this.falseNode.destroy(delay)\n            return\n        }\n\n        this.currentSize = 0\n        this.nodes.forEach(it => it.destroy(delay))\n        this.nodes = []\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Node } from './node'\nimport { Delay } from './template'\n\nexport class StaticNode extends Node {\n    name: string\n    attributes: [string, string][]\n\n    constructor(name: string, attributes: [string, string][] = [], id?: string) {\n        super(id)\n        this.name = name\n        this.attributes = attributes\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        this.rendered = true\n        if (this.nextSibling && this.nextSibling.element) {\n            this.parent.element.insertBefore(this.element, this.nextSibling.element)\n        } else {\n            this.parent.element.appendChild(this.element)\n        }\n        this.children.forEach(it => it.render(context, delay))\n    }\n\n    update (context: object, delay: Delay) {\n    }\n\n    destroy (delay: Delay) {\n        if (this.rendered) return\n        super.destroy(delay)\n\n        this.parent.element.removeChild(this.element)\n        this.rendered = false\n    }\n\n    create () {\n        const element = document.createElement(this.name)\n        this.attributes.forEach(it => element.setAttribute(it[0], it[1]))\n        return element\n    }\n}\n","import {Application} from './application'\n\nexport interface Lifecycle {\n    stage?: string\n    init? (): any\n\n    beforeRender? (): any\n    rendered? (): any\n\n    beforeUpdate? (): any\n    updated? (): any\n\n    beforeDestroy? (): any\n    destroyed? (): any\n}\n\nconst callIt = (ctx: LifecycleContainer, cycles: Lifecycle[], method: string, reverse = false): Promise<any> => {\n    return cycles.filter(it => it[method])[reverse ? 'reduceRight' : 'reduce']((acc, it) => {\n        return acc.then(() => it[method].apply(ctx))\n    }, Promise.resolve())\n}\n\nexport class LifecycleContainer {\n    app: Application\n    private _cycles: Lifecycle[] = []\n\n    constructor (app: Application, options: {cycles?: Lifecycle[]} & Lifecycle, ...args: Lifecycle[]) {\n        this.app = app\n\n        const cs = options.cycles || []\n        cs.push(options)\n        args.forEach(it => it && cs.push(it))\n        cs.forEach(it => !it.stage && (it.stage = 'default'))\n\n        app.options.stages.forEach(s => cs.forEach(c => {\n            if (c.stage === s) this._cycles.push(c)\n        }))\n    }\n\n    protected _doInit () {\n        return callIt(this, this._cycles, 'init')\n    }\n\n    protected _doBeforeRender () {\n        return callIt(this, this._cycles, 'beforeRender')\n    }\n\n    protected _doRendered () {\n        return callIt(this, this._cycles, 'rendered')\n    }\n\n    protected _doBeforeUpdate () {\n        return callIt(this, this._cycles, 'beforeUpdate')\n    }\n\n    protected _doUpdated () {\n        return callIt(this, this._cycles, 'updated')\n    }\n\n    protected _doBeforeDestroy () {\n        return callIt(this, this._cycles, 'beforeDestroy', true)\n    }\n\n    protected _doDestroyed () {\n        return callIt(this, this._cycles, 'destroyed', true)\n    }\n}\n","import { Lifecycle, LifecycleContainer } from './lifecycle'\nimport { Application } from './application'\nimport { Disposable } from './drizzle'\nimport { Node } from './template/node'\nimport { ModuleTemplate } from './template/module-template'\n\nexport interface RenderOptions extends Lifecycle {\n    cycles?: Lifecycle[]\n    customEvents?: {[name: string]: (HTMLElement, callback: (any) => void) => Disposable}\n    events?: {[name: string]: (...args) => void}\n    template?: ModuleTemplate\n}\n\nexport enum ComponentState {\n    CREATED, INITED, RENDERED\n}\n\ninterface Region {\n    show (item: Renderable<any>): Promise<any>\n    _showNode (nodes: Node[], context: object): Promise<any>\n    close (): Promise<any>\n}\n\nexport class Renderable<T extends RenderOptions> extends LifecycleContainer {\n    _element: HTMLElement\n    _nextSibling: HTMLElement\n    _options: T\n    ids: {[key: string]: HTMLElement | Renderable<T>} = {}\n    regions: {[key: string]: Region}\n\n    protected _busy: Promise<any> = Promise.resolve()\n    protected _status = ComponentState.CREATED\n\n    constructor(app: Application, options: T, ...args: Lifecycle[]) {\n        super(app, options, ...args)\n        this._options = options\n    }\n\n    _render (el: HTMLElement, nextSibling?: HTMLElement) {\n        if (this._status !== ComponentState.INITED) return Promise.resolve()\n        this._status = ComponentState.RENDERED\n\n        this._element = el\n        this._nextSibling = nextSibling\n        this._busy = this._busy\n            .then(() => this._doBeforeRender())\n            .then(() => this._doRendered())\n\n        return this._busy\n    }\n\n    destroy () {\n        if (this._status !== ComponentState.RENDERED) return Promise.resolve()\n\n        this._busy = this._busy\n            .then(() => this._doBeforeDestroy())\n            .then(() => this._doDestroyed())\n            .then(() => this._status = ComponentState.INITED)\n\n        return this._busy\n    }\n\n    _init () {\n        return this._busy = this._busy\n            .then(() => this._doInit())\n            .then(() => this._status = ComponentState.INITED)\n    }\n\n    _event (name, ...args: any[]) {\n        const {events} = this._options\n        if (events && events[name]) events[name].apply(this, args)\n    }\n\n}\n","import { RenderOptions, Renderable } from './renderable'\nimport { Module } from './module'\nimport { DynamicNode } from './template/dynamic-node'\n\nexport interface ViewOptions extends RenderOptions {\n    actions?: {[name: string]: (cb: (data: any) => Promise<any>, data: object) => void}\n}\n\nexport interface BindingGroup {\n    type: 'checkbox' | 'radio'\n    busy: boolean\n    items: DynamicNode[]\n}\n\nexport class View extends Renderable<ViewOptions> {\n    _module: Module\n    _groups: {[name: string]: BindingGroup} = {}\n    _state: object = {}\n\n    constructor(mod: Module, options: ViewOptions) {\n        super(mod.app, options)\n        this._module = mod\n    }\n\n    set (data: object, silent: boolean = false) {\n        if (silent) {\n            Object.assign(this._state, data)\n            return Promise.resolve()\n        }\n\n        this._busy = this._busy\n            .then(() => this._doBeforeUpdate())\n            .then(() => Object.assign(this._state, data))\n            .then(() => this._doUpdated())\n\n        return this._busy\n    }\n\n    _action (name: string, ...data: any[]) {\n        const {actions} = this._options\n        if (actions && actions[name]) {\n            actions[name].call(this, (d: any) => {\n                return this._module.dispatch(name, d)\n            }, ...data)\n            return\n        }\n\n        this._module.dispatch(name, data[0])\n    }\n}\n","import { View, BindingGroup } from '../view'\nimport { getValue, Updatable } from './template'\nimport { DynamicNode } from './dynamic-node'\n\nconst distruct = (obj: object, key: string) => {\n    const ks = key.split('.')\n    const name = ks.pop()\n\n    const target = ks.reduce((acc, it) => acc[it], obj)\n    return {name, target}\n}\n\nconst bindIt = <T extends HTMLElement>(\n    context: {[name: string]: any}, view: View, to: string, element: T,\n    event: string, get: (T) => any, set: (T, any) => void\n): Updatable => {\n    let busy = false  // necessary?\n    let current\n    const obj = {context}\n    const cb = function(this: T) {\n        const {name, target} = distruct(obj.context, to)\n        current = get(element)\n\n        // bind each key\n        if (name === to && context._each && context._each.some(it => it.key === name)) {\n            const each = context._each.find(it => it.key === name)\n            each.list[each.index] = current\n        } else {\n            target[name] = current\n        }\n        busy = true\n        view.set({})\n        busy = false\n    }\n\n    element.addEventListener(event, cb, false)\n\n    return {\n        dispose () {\n            element.removeEventListener(event, cb, false)\n        },\n        update (ctx: object) {\n            obj.context = ctx\n            if (!busy) {\n                const v = getValue(to, ctx)\n                if (v !== current) {\n                    set(element, v)\n                    current = v\n                }\n            }\n        }\n    }\n}\n\nconst getSelectValue = (el: HTMLSelectElement) => {\n    const opt = el.options[el.selectedIndex || 0]\n    return opt && opt.value\n}\n\nconst setSelectOption = (el: HTMLSelectElement, value) => {\n    // tslint:disable-next-line:prefer-for-of\n    for (let i = 0; i < el.options.length; i ++) {\n        const opt = el.options[i]\n        if (opt.value === (value + '')) {\n            opt.selected = true\n            return\n        }\n    }\n}\n\nconst bindGroup = (\n    context: {[name: string]: any}, view: View, group: BindingGroup, to: string,\n    element: HTMLInputElement\n): Updatable => {\n    const obj = {context}\n    let current\n    const cb = function(this: HTMLInputElement) {\n        if (group.busy) return\n        const {name, target} = distruct(obj.context, to)\n        current = (group.type === 'radio' ? element.value : group.items\n            .filter(it => (it.element as HTMLInputElement).checked)\n            .map(it => (it.element as HTMLInputElement).value))\n\n        if (name === to && context._each && context._each.some(it => it.key === name)) {\n            const each = context._each.find(it => it.key === name)\n            each.list[each.index] = current\n        } else {\n            target[name] = current\n        }\n        group.busy = true\n        view.set({})\n        group.busy = false\n    }\n    element.addEventListener('change', cb, false)\n\n    return {\n        dispose () {\n            element.removeEventListener('change', cb, false)\n        },\n        update (ctx: object) {\n            obj.context = ctx\n            if (group.busy) return\n            const v = getValue(to, ctx)\n            const its = group.items.map(it => (it.element as HTMLInputElement))\n\n            let changed = false\n            if (group.type === 'radio' && v !== current) changed = true\n            if (!changed && group.type === 'checkbox' && (v as any[]).some((it, i) => current[i] !== it)) changed = true\n            if (!changed) return\n\n            if (group.type === 'radio') {\n                its.forEach(it => it.checked = it.value === v + '')\n                return\n            }\n\n            its.forEach(it => it.checked = (v as any[]).some(vv => vv + '' === it.value))\n        }\n    }\n}\n\nexport const bind = (node: DynamicNode, context: object, from: string, to: string): Updatable => {\n    const tag = node.name.toLowerCase()\n    const element = node.element\n    const view = node.root as View\n    if ((tag === 'input' || tag === 'textarea') && from === 'value') {\n        return bindIt(context, view, to, element, 'input', el => el.value, (el, value) => el.value = value)\n    }\n\n    if (tag === 'input' && from === 'checked') {\n        return bindIt(context, view, to, element, 'change', el => el.checked, (el, value) => el.checked = value)\n    }\n\n    if (tag === 'select' && from === 'value') {\n        return bindIt(context, view, to, element, 'change', getSelectValue, setSelectOption)\n    }\n\n    if (tag === 'input' && from === 'group') {\n        const type = (element as HTMLInputElement).type\n        if (type !== 'checkbox' && type !== 'radio') return null\n        return bindGroup(context, view, view._groups[to], to, (element as HTMLInputElement))\n    }\n\n    return null\n}\n","import { StaticNode } from './static-node'\nimport { Helper } from './helper'\nimport { Disposable } from '../drizzle'\nimport { View } from '../view'\nimport { bind } from './binding'\nimport { Delay, Attribute, ChangeType, resolveEventArgument, Updatable, customEvents } from './template'\n\nexport class DynamicNode extends StaticNode {\n    dynamicAttributes: {[name: string]: Helper[]} = {}\n    events: {[method: string]: {event: string, args: Attribute[]}} = {}\n    actions: {[method: string]: {event: string, args: Attribute[]}} = {}\n    bindings: [string, string][] = []\n\n    eventHooks: Disposable[]\n    actionHooks: Disposable[]\n    bindingHooks: Updatable[]\n\n    context: object\n\n    attribute (name: string, ...helpers: Helper[]) {\n        this.dynamicAttributes[name] = helpers\n    }\n\n    on (event: string, method: string, args: Attribute[]) {\n        this.events[method] = {event, args}\n    }\n\n    action (event: string, method: string, args: Attribute[]) {\n        this.actions[method] = {event, args}\n    }\n\n    bind (from: string, to: string) {\n        if (!(this.root instanceof View)) return\n\n        this.bindings.push([from, to])\n        if (from !== 'group' || this.name.toLowerCase() !== 'input') return\n        const attr = this.attributes.find(it => it[0].toLowerCase() === 'type')\n        if (!attr) return\n        const type = attr[1].toLowerCase()\n        if (type !== 'checkbox' && type !== 'radio') return\n\n        const groups = this.root._groups\n        if (!groups[to]) groups[to] = {type, items: [], busy: false}\n        else if (groups[to].type !== type) {\n            throw Error('binding group can not mix up checkbox and radio')\n        }\n        groups[to].items.push(this) // TODO if this item is hidden by if, should it works?\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n        super.render(context, delay)\n        this.updateAttributes(context)\n\n        this.context = context\n        this.eventHooks = Object.keys(this.events).map(it =>\n            this.initEvent(this.events[it].event, it, this.events[it].args)\n        )\n        this.actionHooks = Object.keys(this.actions).map(it =>\n            this.initAction(this.actions[it].event, it, this.actions[it].args)\n        )\n        this.bindingHooks = this.bindings.map(it => bind(this, this, it[0], it[1])).filter(it => !!it)\n    }\n\n    initEvent (name: string, method: string, args: Attribute[]): Disposable {\n        const me = this\n        const cb = function(this: HTMLElement, event) {\n            const as = resolveEventArgument(this, me.context, args, event)\n            me.root._event(method, ...as)\n        }\n\n        return this.bindEvent(name, cb)\n    }\n\n    initAction (name: string, action: string, args: Attribute[]): Disposable {\n        if (!(this.root instanceof View)) return\n        const me = this\n\n        const cb = function(this: HTMLElement, event) {\n            const data = resolveEventArgument(this, me.context, args, event)\n            const root = (me.root as View)\n            root._action(action, ...data)\n        }\n\n        return this.bindEvent(name, cb)\n    }\n\n    bindEvent (name: string, cb: (event: any) => void): Disposable {\n        let ce = this.root._options.customEvents\n        if (!ce || !ce[name]) ce = this.root.app.options.customEvents\n        if (!ce || !ce[name]) ce = customEvents\n        if (ce && ce[name]) {\n            return ce[name](this.element, cb)\n        }\n\n        this.element.addEventListener(name, cb, false)\n        return {\n            dispose: () => {\n                this.element.removeEventListener(name, cb, false)\n            }\n        }\n    }\n\n    updateAttributes (context: object) {\n        Object.keys(this.dynamicAttributes).forEach(it => {\n            const vs = this.dynamicAttributes[it].map(i => i.render(context))\n            if (vs.some(i => i[0] === ChangeType.CHANGED)) {\n                const vvs = vs.map(i => i[1])\n                const v = it === 'class' ? vvs.join(' ') : vvs.join('') // TODO boolean attribute can be set to string?\n                this.element.setAttribute(it, v)\n            }\n        })\n    }\n\n    update (context: object) {\n        if (!this.rendered) return\n\n        this.updateAttributes(context)\n        this.context = context\n        this.bindingHooks.forEach(it => it.update(context))\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        super.destroy(delay)\n\n        this.bindingHooks.forEach(it => it.dispose())\n        this.actionHooks.forEach(it => it.dispose())\n        this.eventHooks.forEach(it => it.dispose())\n\n        this.bindingHooks = []\n        this.actionHooks = []\n        this.eventHooks = []\n    }\n}\n","export interface ModelOptions {\n    url?: string\n    root?: string\n    data: () => any\n    parser?: (data: any) => any\n}\n\nexport class Model {\n    private _options: ModelOptions\n    private _data: any\n\n    constructor(options: ModelOptions) {\n        this._options = options\n        this.set(options.data())\n    }\n\n    set (data: any) {\n        let d = data\n        const {parser, root} = this._options\n        if (parser) d = parser(d)\n        if (root && d) d = d[root]\n\n        this._data = d\n    }\n\n    get () {\n        // clone it or make it readonly in dev mode\n        return this._data\n    }\n}\n","import { ModelOptions, Model } from './model'\n\nexport interface StoreOptions {\n    models?: {[key: string]: ModelOptions}\n    actions?: {[key: string]: (payload: any) => void}\n}\n\nexport class Store {\n    private _options: StoreOptions\n    private _models: {[key: string]: Model} = {}\n    private _names: string[] = []\n\n    constructor(options: StoreOptions, updateKey: string) {\n        this._options = options\n        const {models} = options\n        if (models) {\n            this._names = Object.keys(models)\n            this._names.forEach(k => this._models[k] = new Model(models[k]))\n        }\n\n        if (!options.actions) options.actions = {}\n        options.actions[updateKey] = data => {\n            this.set(data)\n        }\n    }\n\n    get models () {\n        return this._models\n    }\n\n    get (name?: string) {\n        if (name) return this._models[name].get()\n\n        return this._names.reduce((acc: {[key: string]: any}, item) => {\n            acc[item] = this._models[item].get()\n            return acc\n        }, {})\n    }\n\n    set (data: object) {\n        this._names.forEach(k => data[k] && this._models[k].set(data[k]))\n    }\n\n    dispatch (name: string, payload: any): Promise<void> {\n        const {actions} = this._options\n        if (!actions || !actions[name]) return Promise.reject()\n        return Promise.resolve(actions[name].call(this, payload))\n    }\n}\n","import { RenderOptions, Renderable, ComponentState } from './renderable'\nimport { StoreOptions, Store } from './store'\nimport { Application } from './application'\nimport { Loader } from './loader'\nimport { View, ViewOptions } from './view'\nimport { Disposable} from './drizzle'\n\nexport interface ItemOptions {\n    view?: string\n    module?: {\n        path: string,\n        loader?: {name: string, args?: string[]}\n    }\n}\n\ninterface ModuleOptions extends RenderOptions {\n    store?: StoreOptions\n    exportedModels?: string[]\n    state?: object,\n}\n\nconst UPDATE_ACTION = `update${+new Date()}`\n\nexport class Module extends Renderable<ModuleOptions> {\n    items: {[key: string]: {\n        type: 'view' | 'module'\n        options: ModuleOptions | ViewOptions\n        loader: Loader\n    }} = {}\n\n    private _store: Store\n    private _handlers: {[name: string]: ((data: any) => void)[]} = {}\n    private _loader: Loader\n\n    constructor(app: Application, loader: Loader, options: ModuleOptions) {\n        super(app, options, options.template && options.template.life)\n        this._loader = loader\n    }\n\n    set (data: object) {\n        const {exportedModels} = this._options\n        if (!exportedModels || !exportedModels.length) return\n\n        const d = exportedModels.reduce((acc, item) => {\n            if (data[item]) acc[item] = data[item]\n            return acc\n        }, {})\n\n        return (this._status === ComponentState.CREATED ? this._store : this).dispatch(UPDATE_ACTION, d)\n    }\n\n    get (name?: string) {\n        return this._store.get(name)\n    }\n\n    dispatch (name: string, payload?: any) {\n        this._busy = this._busy\n            .then(() => this._doBeforeUpdate())\n            .then(() => this._store.dispatch(name, payload))\n            .then(() => this._doUpdated())\n\n        return this._busy\n    }\n\n    on (name: string, handler: (data: any) => void): Disposable {\n        if (!this._handlers[name]) this._handlers[name] = []\n        const hs = this._handlers[name]\n\n        if (hs.indexOf(handler) !== -1) return {dispose: () => {}}\n        hs.push(handler)\n\n        return {\n            dispose: () => {\n                const idx = hs.indexOf(handler)\n                if (idx !== -1) hs.splice(idx, 1)\n            }\n        }\n    }\n\n    fire (name: string, data: any) {\n        if (!this._handlers[name]) return\n        const hs = this._handlers[name].slice()\n        hs.forEach(it => it.call(this, data))\n    }\n\n    createItem (name: string) {\n        const opt = this.items[name]\n        const item = opt.type === 'view' ? new View(this, opt.options) : new Module(this.app, opt.loader, opt.options)\n        return item._init().then(() => item)\n    }\n\n    _render (el: HTMLElement, nextSibling?: HTMLElement) {\n        const busy = super._render(el, nextSibling)\n\n        if (busy === this._busy) {\n            this._busy = this._busy.then(() => {\n                const {store} = this._options\n                if (store && store.actions && store.actions.init) {\n                    return this.dispatch('init')\n                }\n            })\n            return this._busy\n        }\n\n        return busy\n    }\n\n    _init () {\n        this._store = new Store(this._options.store || {}, UPDATE_ACTION)\n        this.set(this._options.state || {})\n        return this._loadItems().then(() => super._init())\n    }\n\n    private _loadItems (): Promise<any> {\n        const {template} = this._options\n        if (!template || !template.options) return Promise.resolve()\n        const {items} = template.options\n        if (!items) return Promise.resolve()\n\n        const ks = Object.keys(items)\n        const loaders = ks.map(k => {\n            return items[k].view ? this._loader : this.app.createLoader(items[k].module.path, items[k].module.loader)\n        })\n        return Promise.all(ks.map((k, i) => loaders[i].load(items[k].view ? items[k].view : 'index')))\n            .then(data => Promise.all(ks.map((k, i) => {\n                this.items[k] = {\n                    type: items[k].view ? 'view' : 'module',\n                    options: data[i],\n                    loader: loaders[i]\n                }\n            })))\n    }\n}\n","import { Node } from './node'\nimport { Renderable } from '../renderable'\nimport { Delay, Attribute, resolveEventArgument } from './template'\nimport { Module } from '../module'\nimport { View } from '../view'\nimport { StaticNode } from './static-node'\nimport { Disposable } from '../drizzle'\n\ninterface BindResult {\n    fn: (any) => void\n    event: string\n}\n\nexport class ReferenceNode extends Node {\n    name: string\n    item: Module | View\n    events: {[method: string]: {event: string, args: Attribute[]}} = {}\n    actions: {[method: string]: {event: string, args: Attribute[]}} = {}\n    bindings: [string, string][] = []\n    grouped: {[name: string]: Node[]} = {}\n\n    hooks: Disposable[] = []\n    context: object\n\n    constructor(name: string, id?: string) {\n        super(id)\n        this.name = name\n    }\n\n    bind (from: string, to?: string) {\n        this.bindings.push([from, to || from])\n    }\n\n    on (event: string, method: string, args: Attribute[]) {\n        this.events[method] = {event, args}\n    }\n\n    action (event: string, method: string, args: Attribute[]) {\n        this.actions[method] = {event, args}\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        const fn = (i: Module | View) => {\n            this.item = i\n            if (this.id) root.ids[this.id] = i\n        }\n        if (root instanceof View) {\n            delay.add(root._module.createItem(this.name).then(fn))\n        } else {\n            delay.add((root as Module).createItem(this.name).then(fn))\n        }\n\n        this.children.forEach(it => {\n            let name = 'default'\n            if (it instanceof StaticNode) {\n                const attr = (it.attributes as [string, string][]).find(n => n[0] === 'region')\n                if (attr) name = attr[1]\n            }\n\n            if (!this.grouped[name]) this.grouped[name] = []\n            this.grouped[name].push(it)\n        })\n    }\n\n    render (context: object, delay: Delay) {\n        delay.add(this.item.set(this.bindings.reduce((acc, item) => {\n            acc[item[1]] = context[item[0]]\n            return acc\n        }, {})))\n        delay.add(this.item._render(this.parent.element, this.nextSibling && this.nextSibling.element).then(() => {\n            return Promise.all(Object.keys(this.grouped).map(k => {\n                return this.item.regions[k]._showNode(this.grouped[k], context)\n            }))\n        }))\n\n        this.context = context\n        let cbs = []\n        if (this.item instanceof Module) {\n            const m = this.item\n            cbs = cbs.concat(this.bindEvents(this.root, m, context))\n\n            if (this.root instanceof View) {\n                cbs = cbs.concat(this.bindActions(this.root, m, context))\n            }\n\n            this.hooks = cbs.map(it => m.on(it.event, it.fn))\n        }\n    }\n\n    bindEvents (root: Renderable<any>, target: Module, context: object): BindResult[] {\n        const me = this\n        const obj = {context}\n\n        return Object.keys(this.events).map(it => {\n            const cb = function (this: Module, event: any) {\n                const data = resolveEventArgument(this, obj.context, me.events[it].args, event)\n                root._event(it, ...data)\n            }\n            return {fn: cb, event: me.events[it].event, update: (ctx) => obj.context = ctx}\n        })\n    }\n\n    bindActions (root: View, target: Module, context: object): BindResult[] {\n        const me = this\n\n        return Object.keys(this.actions).map(it => {\n            const cb = function(this: Module, event: any) {\n                const data = resolveEventArgument(this, me.context, me.actions[it].args, event)\n                root._action(it, ...data)\n            }\n            return {fn: cb, event: me.actions[it].event}\n        })\n    }\n\n    update (context: object, delay: Delay) {\n        delay.add(this.item.set(this.bindings.reduce((acc, item) => {\n            acc[item[1]] = context[item[0]]\n            return acc\n        }, {})))\n\n        this.context = context\n        this.children.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        delay.add(this.item.destroy())\n        this.hooks.forEach(it => it.dispose())\n        this.hooks = []\n        delay.add(Promise.all(Object.keys(this.grouped).map(it => {\n            return this.item.regions[it].close()\n        })))\n        this.rendered = false\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Node } from './node'\nimport { Delay } from './template'\nimport { Renderable } from '../renderable'\n\nexport class RegionNode extends Node {\n    nodes: Node[]\n    item: Renderable<any>\n    context: object\n\n    constructor(id: string = 'default') {\n        super()\n        this.id = id\n    }\n\n    init (root: Renderable<any>, delay: Delay) {\n        this.root = root\n        this.children.forEach(it => {\n            it.parent = this.parent\n            it.nextSibling = this.nextSibling\n            it.init(root, delay)\n        })\n\n        const me = this\n        root.regions[this.id] = {\n            show (item: Renderable<any>): Promise<any> {\n                return me.show(item)\n            },\n            _showNode (nodes: Node[], context: object): Promise<any> {\n                return me.showNode(nodes, context)\n            },\n            close () {\n                return me.close()\n            }\n        }\n    }\n\n    render (context: object, delay: Delay) {\n        if (this.rendered) return\n\n        this.rendered = true\n        this.context = context\n        this.children.forEach(it => it.render(context, delay))\n    }\n\n    update (context: object, delay: Delay) {\n        if (!this.rendered) return\n        this.context = context\n        this.children.forEach(it => it.update(context, delay))\n    }\n\n    destroy (delay: Delay) {\n        if (!this.rendered) return\n        if (this.nodes) this.nodes.forEach(it => it.destroy(delay))\n        if (this.item) delay.add(this.item.destroy())\n        this.children.forEach(it => it.destroy(delay))\n        this.rendered = false\n    }\n\n    showNode (nodes: Node[], context: object): Promise<any> {\n        if (!this.rendered) return\n        this.nodes = nodes\n        return this.close().then(() => {\n            return Delay.also(d => this.nodes.forEach(it => it.render(context, d)))\n        })\n    }\n\n    show (item: Renderable<any>) {\n        if (!this.rendered) return\n        this.item = item\n        return this.close().then(() => {\n            return item._render(this.parent.element, this.nextSibling && this.nextSibling.element) // TODO\n        })\n    }\n\n    close (): Promise<any> {\n        if (!this.nodes && !this.item) return Promise.resolve()\n        return Promise.resolve().then(() => {\n            if (this.nodes) return Delay.also(d => this.nodes.forEach(it => it.destroy(d)))\n        }).then(() => {\n            if (this.item) return this.item.destroy()\n        }).then(() => {\n            this.nodes = null\n            this.item = null\n            return Delay.also(d => this.children.forEach(it => it.render(this.context, d)))\n        })\n    }\n\n    create () {\n        return null\n    }\n}\n","import { Application } from './application'\n\nexport class Loader {\n    protected _app: Application\n    protected _path: string\n    protected _args: string[]\n\n    constructor(app: Application, path: string, args: string[]) {\n        this._app = app\n        this._path = path\n        this._args = args\n    }\n\n    load (file): Promise<object> {\n        return this._app.options.getResource(`${this._app.options.scriptRoot}/${this._path}/${file}`)\n    }\n}\n","import {ItemOptions, Module} from '../module'\nimport { Delay, Template } from './template'\n\nexport class ModuleTemplate extends Template<Module> {\n    options: {\n        exportedModels: string[]\n        items: ItemOptions\n    }\n\n    constructor(exportedModels: string[]) {\n        super()\n        this.options = {exportedModels, items: {}}\n        const me = this\n        this.life = {\n            stage: 'template',\n            init (this: Module) { Delay.also(d => me.init(this, d)) },\n            beforeRender (this: Module) { Delay.also(d => me.render(this.get(), d)) },\n            updated (this: Module) { Delay.also(d => me.update(this.get(), d)) },\n            beforeDestroy () { Delay.also(d => me.destroy(d)) }\n        }\n    }\n\n    views (...views: string[]) {\n        views.forEach(it => this.options.items[it] = {view: it})\n    }\n\n    modules (name: string, path: string, loader?: string, args?: string[]) {\n        this.options.items[name] = loader ? {path, loader: {name: loader, args}} : {path}\n    }\n}\n","import { Lifecycle } from '../lifecycle'\nimport { Delay, Template } from './template'\nimport { View } from '../view'\n\nexport class ViewTemplate extends Template<View> {\n    constructor () {\n        super()\n        const me = this\n        this.life = {\n            stage: 'template',\n            init (this: View) { Delay.also(d => me.init(this, d)) },\n            beforeRender (this: View) { Delay.also(d => me.render(this._state, d)) },\n            updated (this: View) { Delay.also(d => me.update(this._state, d)) },\n            beforeDestroy () { Delay.also(d => me.destroy(d)) }\n        }\n    }\n}\n","import { Loader } from './loader'\nimport { Disposable } from './drizzle'\nimport { Module } from './module'\n\ninterface ApplicationOptions {\n    stages?: string[],\n    scriptRoot?: string\n    container: HTMLElement,\n    entry: string | {path: string, loader?: {name: string, args?: string[]}},\n    customEvents?: {[name: string]: (HTMLElement, callback: (any) => void) => Disposable}\n    getResource? (path): Promise<object>\n}\n\nexport class Application {\n    options: ApplicationOptions\n\n    constructor(options: ApplicationOptions) {\n        this.options = Object.assign({\n            stages: ['init', 'template', 'default'],\n            scriptRoot: 'app',\n            entry: 'viewport'\n        }, options)\n    }\n\n    createLoader (path: string, loader?: {name: string, args?: string[]}): Loader {\n        return new Loader(this, path, [])\n    }\n\n    start (): Promise<any> {\n        let loader: Loader\n        const {entry, container} = this.options\n        if (typeof entry === 'string') {\n            loader = this.createLoader(entry)\n        } else {\n            loader = this.createLoader(entry.path, entry.loader)\n        }\n\n        return loader.load('index').then(opt => {\n            const v = new Module(this, loader, opt)\n            return v._init().then(() => v._render(container))\n        })\n    }\n}\n","import { IfHelper, EqHelper, UnlessHelper, GtHelper, LtHelper, GteHelper, LteHelper } from './template/helper'\nimport { IfBlock, UnlessBlock, GtBlock, LtBlock, GteBlock, LteBlock, EqBlock } from './template/if-block'\nimport { EachBlock } from './template/each-block'\nimport { DynamicNode } from './template/dynamic-node'\nimport { StaticNode } from './template/static-node'\nimport { ReferenceNode } from './template/reference-node'\nimport { RegionNode } from './template/region-node'\nimport { Loader } from './loader'\nimport { ModuleTemplate } from './template/module-template'\nimport { ViewTemplate } from './template/view-template'\nimport { customEvents } from './template/template'\nimport { Application } from './application'\n\nexport interface Disposable {\n    dispose (): void\n}\n\nconst helpers = {\n    if: IfHelper, unless: UnlessHelper, eq: EqHelper, gt: GtHelper,\n    lt: LtHelper, gte: GteHelper, lte: LteHelper\n}\n\nconst blocks = {\n    if: IfBlock, unless: UnlessBlock, each: EachBlock, gt: GtBlock,\n    lt: LtBlock, gte: GteBlock, lte: LteBlock, eq: EqBlock\n}\n\nconst loaders = {\n    default: Loader\n}\n\nexport default {\n    helpers, blocks, loaders, customEvents,\n    lifecycles: {module: [], view: []},\n    ModuleTemplate, ViewTemplate,\n    DynamicNode, StaticNode, ReferenceNode, RegionNode,\n    Application\n}\n"],"names":["Node","id","root","delay","element","create","ids","children","forEach","it","init","context","destroy","i","nextSibling","parent","FakeNode","el","ValueType","ChangeType","Delay","p","delays","push","Promise","all","fn","d","execute","getValue","key","split","reduce","acc","item","resolveEventArgument","me","args","event","values","map","name","v","STATIC","slice","obj","result","ns","length","customEvents","enter","node","cb","ee","e","keyCode","preventDefault","addEventListener","dispose","removeEventListener","Template","nodes","container","_element","next","_nextSibling","render","update","Helper","dynamicKeys","filter","DYNAMIC","check","currentValues","CHANGED","renderIt","vs","currentKeys","some","NOT_CHANGED","undefined","idx","arg","numbers","Error","join","doRender","Transfromer","apply","ConcatHelper","IfHelper","assertCount","assertDynamic","use","UnlessHelper","EqHelper","v1","v2","GtHelper","GteHelper","LtHelper","LteHelper","IfBlock","trueNode","falseNode","rendered","current","UnlessBlock","EqBlock","args2","use2","getValue2","GtBlock","GteBlock","LtBlock","LteBlock","EachBlock","list","Array","isArray","Object","keys","o","assign","_each","index","isEmpty","renderElse","kv","renderKeyValue","arr","currentSize","sub","empty","updateElse","updateKeyValue","pop","StaticNode","attributes","insertBefore","appendChild","removeChild","document","createElement","setAttribute","callIt","ctx","cycles","method","reverse","then","resolve","LifecycleContainer","app","options","cs","stage","stages","c","s","_cycles","ComponentState","Renderable","CREATED","_options","_status","INITED","RENDERED","_busy","_doBeforeRender","_doRendered","_doBeforeDestroy","_doDestroyed","_doInit","events","View","mod","_module","data","silent","_state","_doBeforeUpdate","_doUpdated","actions","call","dispatch","distruct","ks","target","bindIt","view","to","get","set","busy","each","find","getSelectValue","opt","selectedIndex","value","setSelectOption","selected","bindGroup","group","type","items","checked","its","changed","vv","bind","from","tag","toLowerCase","_groups","DynamicNode","helpers","dynamicAttributes","bindings","attr","groups","updateAttributes","eventHooks","initEvent","actionHooks","initAction","bindingHooks","as","_event","bindEvent","action","_action","ce","vvs","Model","parser","_data","Store","updateKey","models","_names","_models","k","payload","reject","UPDATE_ACTION","Date","Module","loader","template","life","_loader","exportedModels","_store","handler","_handlers","hs","indexOf","splice","_init","store","state","_loadItems","loaders","createLoader","module","path","load","ReferenceNode","add","createItem","n","grouped","_render","regions","_showNode","cbs","m","concat","bindEvents","bindActions","hooks","on","close","RegionNode","show","showNode","also","Loader","_app","_path","_args","file","getResource","scriptRoot","ModuleTemplate","beforeRender","updated","beforeDestroy","views","ViewTemplate","Application","entry","if","unless","eq","gt","lt","gte","lte","blocks","default","lifecycles"],"mappings":"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"}